<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Quantum Exact Simulation Toolkit: QuEST_cpu.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>QuEST_cpu.c File Reference</h1>
<p>The core of the CPU backend functionality.  
<a href="#_details">More...</a></p>
<code>#include &quot;../QuEST.h&quot;</code><br/>
<code>#include &quot;../QuEST_internal.h&quot;</code><br/>
<code>#include &quot;../QuEST_precision.h&quot;</code><br/>
<code>#include &quot;../mt19937ar.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="QuEST__cpu__internal_8h_source.html">QuEST_cpu_internal.h</a>&quot;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>

<p><a href="QuEST__cpu_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, qreal norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7c14b7f97aac42f390383893e703841f">densmatr_addDensityMatrix</a> (<a class="el" href="structQureg.html">Qureg</a> combineQureg, qreal otherProb, <a class="el" href="structQureg.html">Qureg</a> otherQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">densmatr_calcFidelityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">computes a few dens-columns-worth of (vec^*T) dens * vec  <a href="#a7772f97cb4d92a9825bf3b7c82c3230c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a891358c784d97101f9fcdffbb5ebe00e">densmatr_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, qreal totalStateProb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.  <a href="#a891358c784d97101f9fcdffbb5ebe00e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a101e7ef38c5d654a697dafe14562dcee">densmatr_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a20a155f53efc45c16803d7539c2c199d">densmatr_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad5b2ac0b00afa495f385520b2c5fa839">densmatr_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a56b32228c24a7c4e1894d991ef4b6b99">densmatr_oneQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal dephase)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a48e0715ee615f2ce44477521ab760627">densmatr_oneQubitDepolariseDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal depolLevel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a5a0dd013940cf2ea20c397a551d9b781">densmatr_oneQubitDepolariseLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal depolLevel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int qubit1, const int qubit2, qreal dephase)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a63a1b6169f59e86988aa519b71c496fb">densmatr_twoQubitDepolariseLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, qreal delta, qreal gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7f8192d6f93ea1565a27a8556d48878b">densmatr_twoQubitDepolariseLocalPart1</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, qreal delta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae6946456e9b7814fc565f20622b9d2e5">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (const int locationOfBitFromRight, const long long int theEncodedNumber)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the value of the bit at a particular index in a number.  <a href="#a100463f6ec212c76a5fad99579000505"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, qreal norm, long long int startInd, long long int numAmps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a> (<a class="el" href="structQureg.html">Qureg</a> bra, <a class="el" href="structQureg.html">Qureg</a> ket)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8">statevec_collapseToKnownProbOutcomeDistributedRenorm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, const qreal totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="#acd82c94cfac89eacb901348ff0d06af8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">statevec_collapseToKnownProbOutcomeLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, int outcome, qreal totalProbability)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="#ab02bce0ebbb8f624e8ced8b09b99cdef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set all amplitudes in one chunk to 0.  <a href="#a7ea68e9132ed9db9c242353a33dba2f0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7">statevec_compactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="#aede1ba1fc2d189001745ee6f76f8caa7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa5865e66a6e0993ae17d400c9ee0eb43">statevec_compactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae6cecbad32a03416138b321cdc1a2c33">statevec_compareStates</a> (<a class="el" href="structQureg.html">Qureg</a> mq1, <a class="el" href="structQureg.html">Qureg</a> mq2, qreal precision)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130">statevec_controlledCompactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a5837db2f736dce21fb28dad168a23130"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0e5527c6e144fab8062ea5296e8bdf2a">statevec_controlledCompactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc">statevec_controlledNotDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#afa036cb8b502ef9a0977885ea74e41bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a11c9685e4ad1f44cfd6243e0c4435893">statevec_controlledNotLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, const int conjFac)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, const int conjFac)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7c0067cb9f243ead20de7392aea328bc">statevec_controlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#adeb715f3f2c167f9bfbe92b75f5988ce">statevec_controlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035">statevec_controlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="#a4f77ef0be5137ed64321c2d6d14d8035"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac0c120ac374b402c576c4b38bcda9992">statevec_controlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa2e838d65b214d266cd51ad0091ad827">statevec_findProbabilityOfZeroDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="#aa2e838d65b214d266cd51ad0091ad827"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa06d0143cea46f1e425c61ac6f6f9a2">statevec_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="#afa06d0143cea46f1e425c61ac6f6f9a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6870e335f2a78b724f603cd9f820b9ab">statevec_getEnvironmentString</a> (<a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, <a class="el" href="structQureg.html">Qureg</a> qureg, char str[200])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab">statevec_hadamardDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="#a4271beeba4f1bec3556779aab318cdab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a24f9ade18290c82bbb2c4a706b3d5999">statevec_hadamardLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a288dc4b46bdacd69cbf4a6fd070d26a7">statevec_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a482fc361fd5f08075404c72e536316a0">statevec_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a38445cdb2a18671a7c73112ce3337acb">statevec_initStateDebug</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a38445cdb2a18671a7c73112ce3337acb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a05756b45f10135bb2eeb07380f806c20">statevec_initStateFromSingleFile</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a923906770cac0da9e3459bae58de9e64">statevec_initStateOfSingleQubit</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int qubitId, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a923906770cac0da9e3459bae58de9e64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2ca0c6ba07ab2b4b437321bf17efc966">statevec_initZeroState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac4ee5979d475e8c729294b8ef7e0270d">statevec_multiControlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa662796ea6e0f471143c53becae8c12c">statevec_multiControlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c">statevec_multiControlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, long long int mask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a2e6d75b454747741b2b805bf6b23194c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae183f44166ccfd908609c4e2207cc14b">statevec_multiControlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, long long int mask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac4f8a0ab089bc002fd85cd87f8c451e9">statevec_pauliXDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="#ac4f8a0ab089bc002fd85cd87f8c451e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a842aaecd6d6cdc194c0b7c84623d2111">statevec_pauliXLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26">statevec_pauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, const int conjFac)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotate a single qubit by +-{{0,-i},{i,0}.  <a href="#a04cdf71c5862ab2bf3a98cd0b3ea0c26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, const int conjFac)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> term)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1e57230c7995447039e62a84c0a36524">statevec_reportStateToScreen</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa121d55f2ca09c06a96ddcd433c60b0f">statevec_setAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, qreal *reals, qreal *imags, long long int numAmps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea">statevec_unitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="#a62c5d85e323f2c3eea2b7fa6d8c193ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a9f62ff38deae8ef012024d416d749c00">statevec_unitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, long long int numAmps)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The core of the CPU backend functionality. </p>
<p>The CPU/MPI implementations of the pure state functions in ../QuEST_ops_pure.h are in <a class="el" href="QuEST__cpu__local_8c.html" title="An implementation of the pure backend in .">QuEST_cpu_local.c</a> and <a class="el" href="QuEST__cpu__distributed_8c.html" title="An implementation of the backend in .">QuEST_cpu_distributed.c</a> which mostly wrap the core functions defined here. Some additional hardware-agnostic functions are defined here </p>

<p>Definition in file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0abdff5f6065f9d57065345e6d90fc94"></a><!-- doxytag: member="QuEST_cpu.c::alternateNormZeroingSomeAmpBlocks" ref="a0abdff5f6065f9d57065345e6d90fc94" args="(Qureg qureg, qreal norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alternateNormZeroingSomeAmpBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>normFirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>startAmpInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>numAmps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>blockSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00603">603</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST__cpu_8c_source.html#l00593">normaliseSomeAmps()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00583">zeroSomeAmps()</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00606"></a>00606   {     
<a name="l00607"></a>00607     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDubBlocks = numAmps / (2*blockSize);
<a name="l00608"></a>00608     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> blockStartInd;
<a name="l00609"></a>00609     
<a name="l00610"></a>00610     <span class="keywordflow">if</span> (normFirst) {
<a name="l00611"></a>00611         
<a name="l00612"></a>00612 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00613"></a>00613 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span>
<a name="l00614"></a>00614 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00615"></a>00615 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {
<a name="l00616"></a>00616             blockStartInd = startAmpInd + dubBlockInd*2*blockSize;
<a name="l00617"></a>00617             <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd,             blockSize); <span class="comment">// |0&gt;&lt;0|</span>
<a name="l00618"></a>00618             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd + blockSize, blockSize);
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620     } <span class="keywordflow">else</span> {
<a name="l00621"></a>00621         
<a name="l00622"></a>00622 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00623"></a>00623 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span>
<a name="l00624"></a>00624 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00625"></a>00625 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {
<a name="l00626"></a>00626             blockStartInd = startAmpInd + dubBlockInd*2*blockSize;
<a name="l00627"></a>00627             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd,             blockSize);
<a name="l00628"></a>00628             <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd + blockSize, blockSize); <span class="comment">// |1&gt;&lt;1|</span>
<a name="l00629"></a>00629         }
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c14b7f97aac42f390383893e703841f"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_addDensityMatrix" ref="a7c14b7f97aac42f390383893e703841f" args="(Qureg combineQureg, qreal otherProb, Qureg otherQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_addDensityMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>combineQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>otherProb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>otherQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00739">739</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00739"></a>00739                                                                                       {
<a name="l00740"></a>00740     
<a name="l00741"></a>00741     <span class="comment">/* corresponding amplitudes live on the same node (same dimensions) */</span>
<a name="l00742"></a>00742     
<a name="l00743"></a>00743     <span class="comment">// unpack vars for OpenMP</span>
<a name="l00744"></a>00744     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* combineVecRe = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00745"></a>00745     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* combineVecIm = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00746"></a>00746     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* otherVecRe = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00747"></a>00747     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* otherVecIm = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00748"></a>00748     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = combineQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00749"></a>00749     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00750"></a>00750     
<a name="l00751"></a>00751 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00752"></a>00752 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00753"></a>00753 <span class="preprocessor">    default (none) \</span>
<a name="l00754"></a>00754 <span class="preprocessor">    shared  (combineVecRe,combineVecIm,otherVecRe,otherVecIm, otherProb, numAmps) \</span>
<a name="l00755"></a>00755 <span class="preprocessor">    private (index)</span>
<a name="l00756"></a>00756 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00757"></a>00757 <span class="preprocessor"></span>    {
<a name="l00758"></a>00758 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00759"></a>00759 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l00760"></a>00760 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00761"></a>00761 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {
<a name="l00762"></a>00762             combineVecRe[index] *= 1-otherProb;
<a name="l00763"></a>00763             combineVecIm[index] *= 1-otherProb;
<a name="l00764"></a>00764             
<a name="l00765"></a>00765             combineVecRe[index] += otherProb * otherVecRe[index];
<a name="l00766"></a>00766             combineVecIm[index] += otherProb * otherVecIm[index];
<a name="l00767"></a>00767         }
<a name="l00768"></a>00768     }
<a name="l00769"></a>00769 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7772f97cb4d92a9825bf3b7c82c3230c"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_calcFidelityLocal" ref="a7772f97cb4d92a9825bf3b7c82c3230c" args="(Qureg qureg, Qureg pureState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcFidelityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>pureState</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>computes a few dens-columns-worth of (vec^*T) dens * vec </p>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00772">772</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00093">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00413">densmatr_calcFidelity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00772"></a>00772                                                                {
<a name="l00773"></a>00773         
<a name="l00774"></a>00774     <span class="comment">/* Here, elements of pureState are not accessed (instead grabbed from qureg.pair).</span>
<a name="l00775"></a>00775 <span class="comment">     * We only consult the attributes.</span>
<a name="l00776"></a>00776 <span class="comment">     *</span>
<a name="l00777"></a>00777 <span class="comment">     * qureg is a density matrix, and pureState is a statevector.</span>
<a name="l00778"></a>00778 <span class="comment">     * Every node contains as many columns of qureg as amps by pureState.</span>
<a name="l00779"></a>00779 <span class="comment">     * Ergo, this node contains columns:</span>
<a name="l00780"></a>00780 <span class="comment">     * qureg.chunkID * pureState.numAmpsPerChunk  to</span>
<a name="l00781"></a>00781 <span class="comment">     * (qureg.chunkID + 1) * pureState.numAmpsPerChunk</span>
<a name="l00782"></a>00782 <span class="comment">     *</span>
<a name="l00783"></a>00783 <span class="comment">     * The first pureState.numAmpsTotal elements of qureg.pairStateVec are the</span>
<a name="l00784"></a>00784 <span class="comment">     * full pure state-vector</span>
<a name="l00785"></a>00785 <span class="comment">     */</span>
<a name="l00786"></a>00786     
<a name="l00787"></a>00787     <span class="comment">// unpack everything for OPENMP</span>
<a name="l00788"></a>00788     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecRe  = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real;
<a name="l00789"></a>00789     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecIm  = qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag;
<a name="l00790"></a>00790     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* densRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00791"></a>00791     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* densIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00792"></a>00792     
<a name="l00793"></a>00793     <span class="keywordtype">int</span> row, col;
<a name="l00794"></a>00794     <span class="keywordtype">int</span> dim = pureState.<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4" title="Total number of amplitudes, which are possibly distributed among machines.">numAmpsTotal</a>;
<a name="l00795"></a>00795     <span class="keywordtype">int</span> colsPerNode = pureState.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00796"></a>00796     
<a name="l00797"></a>00797     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> densElemRe, densElemIm;
<a name="l00798"></a>00798     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> prefacRe, prefacIm;
<a name="l00799"></a>00799     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rowSumRe, rowSumIm;
<a name="l00800"></a>00800     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> vecElemRe, vecElemIm;
<a name="l00801"></a>00801     
<a name="l00802"></a>00802     <span class="comment">// starting GLOBAL column index of the qureg columns on this node</span>
<a name="l00803"></a>00803     <span class="keywordtype">int</span> startCol = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> * pureState.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00804"></a>00804     
<a name="l00805"></a>00805     <span class="comment">// quantity computed by this node</span>
<a name="l00806"></a>00806     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> globalSumRe = 0;   <span class="comment">// imag-component is assumed zero</span>
<a name="l00807"></a>00807     
<a name="l00808"></a>00808 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00809"></a>00809 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00810"></a>00810 <span class="preprocessor">    shared    (vecRe,vecIm,densRe,densIm, dim,colsPerNode,startCol) \</span>
<a name="l00811"></a>00811 <span class="preprocessor">    private   (row,col, prefacRe,prefacIm, rowSumRe,rowSumIm, densElemRe,densElemIm, vecElemRe,vecElemIm) \</span>
<a name="l00812"></a>00812 <span class="preprocessor">    reduction ( +:globalSumRe )</span>
<a name="l00813"></a>00813 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00814"></a>00814 <span class="preprocessor"></span>    {
<a name="l00815"></a>00815 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00816"></a>00816 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l00817"></a>00817 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00818"></a>00818 <span class="preprocessor"></span>        <span class="comment">// indices of my GLOBAL row</span>
<a name="l00819"></a>00819         <span class="keywordflow">for</span> (row=0; row &lt; dim; row++) {
<a name="l00820"></a>00820             
<a name="l00821"></a>00821             <span class="comment">// single element of conj(pureState)</span>
<a name="l00822"></a>00822             prefacRe =   vecRe[row];
<a name="l00823"></a>00823             prefacIm = - vecIm[row];
<a name="l00824"></a>00824                     
<a name="l00825"></a>00825             rowSumRe = 0;
<a name="l00826"></a>00826             rowSumIm = 0;
<a name="l00827"></a>00827             
<a name="l00828"></a>00828             <span class="comment">// indices of my LOCAL column</span>
<a name="l00829"></a>00829             <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {
<a name="l00830"></a>00830             
<a name="l00831"></a>00831                 <span class="comment">// my local density element</span>
<a name="l00832"></a>00832                 densElemRe = densRe[row + dim*col];
<a name="l00833"></a>00833                 densElemIm = densIm[row + dim*col];
<a name="l00834"></a>00834             
<a name="l00835"></a>00835                 <span class="comment">// state-vector element</span>
<a name="l00836"></a>00836                 vecElemRe = vecRe[startCol + col];
<a name="l00837"></a>00837                 vecElemIm = vecIm[startCol + col];
<a name="l00838"></a>00838             
<a name="l00839"></a>00839                 rowSumRe += densElemRe*vecElemRe - densElemIm*vecElemIm;
<a name="l00840"></a>00840                 rowSumIm += densElemRe*vecElemIm + densElemIm*vecElemRe;
<a name="l00841"></a>00841             }
<a name="l00842"></a>00842         
<a name="l00843"></a>00843             globalSumRe += rowSumRe*prefacRe + rowSumIm*prefacIm;   
<a name="l00844"></a>00844         }
<a name="l00845"></a>00845     }
<a name="l00846"></a>00846     
<a name="l00847"></a>00847     <span class="keywordflow">return</span> globalSumRe;
<a name="l00848"></a>00848 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af910c7cf2b85bdc2c399cfe8dbfb8b9c"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_calcPurityLocal" ref="af910c7cf2b85bdc2c399cfe8dbfb8b9c" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcPurityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00710">710</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01243">densmatr_calcPurity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00710"></a>00710                                             {
<a name="l00711"></a>00711     
<a name="l00712"></a>00712     <span class="comment">/* sum of qureg^2, which is sum_i |qureg[i]|^2 */</span>
<a name="l00713"></a>00713     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00714"></a>00714     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00715"></a>00715         
<a name="l00716"></a>00716     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> trace = 0;
<a name="l00717"></a>00717     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00718"></a>00718     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00719"></a>00719     
<a name="l00720"></a>00720 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00721"></a>00721 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00722"></a>00722 <span class="preprocessor">    shared    (vecRe, vecIm, numAmps) \</span>
<a name="l00723"></a>00723 <span class="preprocessor">    private   (index) \</span>
<a name="l00724"></a>00724 <span class="preprocessor">    reduction ( +:trace )</span>
<a name="l00725"></a>00725 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00726"></a>00726 <span class="preprocessor"></span>    {
<a name="l00727"></a>00727 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00728"></a>00728 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l00729"></a>00729 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00730"></a>00730 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {
<a name="l00731"></a>00731                         
<a name="l00732"></a>00732             trace += vecRe[index]*vecRe[index] + vecIm[index]*vecIm[index];
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734     }
<a name="l00735"></a>00735     
<a name="l00736"></a>00736     <span class="keywordflow">return</span> trace;
<a name="l00737"></a>00737 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a891358c784d97101f9fcdffbb5ebe00e"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_collapseToKnownProbOutcome" ref="a891358c784d97101f9fcdffbb5ebe00e" args="(Qureg qureg, const int measureQubit, int outcome, qreal totalStateProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>totalStateProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00634">634</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST__cpu_8c_source.html#l00603">alternateNormZeroingSomeAmpBlocks()</a>, <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00593">normaliseSomeAmps()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00583">zeroSomeAmps()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00634"></a>00634                                                                                                                  {
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <span class="comment">// only (global) indices (as bit sequence): &apos;* outcome *(n+q) outcome *q are spared</span>
<a name="l00637"></a>00637     <span class="comment">// where n = measureQubit, q = qureg.numQubitsRepresented.</span>
<a name="l00638"></a>00638     <span class="comment">// We can thus step in blocks of 2^q+n, killing every second, and inside the others,</span>
<a name="l00639"></a>00639     <span class="comment">//  stepping in sub-blocks of 2^q, killing every second.</span>
<a name="l00640"></a>00640     <span class="comment">// When outcome=1, we offset the start of these blocks by their size.</span>
<a name="l00641"></a>00641     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerBlockSize = (1LL &lt;&lt; measureQubit);
<a name="l00642"></a>00642     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerBlockSize = (1LL &lt;&lt; (measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00643"></a>00643     
<a name="l00644"></a>00644     <span class="comment">// Because there are 2^a number of nodes(/chunks), each node will contain 2^b number of blocks,</span>
<a name="l00645"></a>00645     <span class="comment">// or each block will span 2^c number of nodes. Similarly for the innerblocks.</span>
<a name="l00646"></a>00646     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> locNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00647"></a>00647     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> * locNumAmps;
<a name="l00648"></a>00648     <span class="keywordtype">int</span> innerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(measureQubit, globalStartInd);
<a name="l00649"></a>00649     <span class="keywordtype">int</span> outerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>, globalStartInd);
<a name="l00650"></a>00650     
<a name="l00651"></a>00651     <span class="comment">// If this chunk&apos;s amps are entirely inside an outer block</span>
<a name="l00652"></a>00652     <span class="keywordflow">if</span> (locNumAmps &lt;= outerBlockSize) {
<a name="l00653"></a>00653         
<a name="l00654"></a>00654         <span class="comment">// if this is an undesired outer block, kill all elems</span>
<a name="l00655"></a>00655         <span class="keywordflow">if</span> (outerBit != outcome)
<a name="l00656"></a>00656             <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00657"></a>00657         
<a name="l00658"></a>00658         <span class="comment">// othwerwise, if this is a desired outer block, and also entirely an inner block</span>
<a name="l00659"></a>00659         <span class="keywordflow">if</span> (locNumAmps &lt;= innerBlockSize) {
<a name="l00660"></a>00660             
<a name="l00661"></a>00661             <span class="comment">// and that inner block is undesired, kill all elems</span>
<a name="l00662"></a>00662             <span class="keywordflow">if</span> (innerBit != outcome)
<a name="l00663"></a>00663                 <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00664"></a>00664             <span class="comment">// otherwise normalise all elems</span>
<a name="l00665"></a>00665             <span class="keywordflow">else</span>
<a name="l00666"></a>00666                 <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, totalStateProb, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00667"></a>00667         }
<a name="l00668"></a>00668                 
<a name="l00669"></a>00669         <span class="comment">// otherwise this is a desired outer block which contains 2^a inner blocks; kill/renorm every second inner block</span>
<a name="l00670"></a>00670         <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00671"></a>00671             qureg, totalStateProb, innerBit==outcome, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, innerBlockSize);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673     
<a name="l00674"></a>00674     <span class="comment">// Otherwise, this chunk&apos;s amps contain multiple outer blocks (and hence multiple inner blocks)</span>
<a name="l00675"></a>00675     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOuterDoubleBlocks = locNumAmps / (2*outerBlockSize);
<a name="l00676"></a>00676     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> firstBlockInd;
<a name="l00677"></a>00677     
<a name="l00678"></a>00678     <span class="comment">// alternate norming* and zeroing the outer blocks (with order based on the desired outcome)</span>
<a name="l00679"></a>00679     <span class="comment">// These loops aren&apos;t parallelised, since they could have 1 or 2 iterations and will prevent</span>
<a name="l00680"></a>00680     <span class="comment">// inner parallelisation</span>
<a name="l00681"></a>00681     <span class="keywordflow">if</span> (outerBit == outcome) {
<a name="l00682"></a>00682 
<a name="l00683"></a>00683         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {
<a name="l00684"></a>00684             firstBlockInd = outerDubBlockInd*2*outerBlockSize;
<a name="l00685"></a>00685             
<a name="l00686"></a>00686             <span class="comment">// *norm only the desired inner blocks in the desired outer block</span>
<a name="l00687"></a>00687             <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00688"></a>00688                 qureg, totalStateProb, innerBit==outcome, 
<a name="l00689"></a>00689                 firstBlockInd, outerBlockSize, innerBlockSize);
<a name="l00690"></a>00690             
<a name="l00691"></a>00691             <span class="comment">// zero the undesired outer block</span>
<a name="l00692"></a>00692             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd + outerBlockSize, outerBlockSize);
<a name="l00693"></a>00693         }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695     } <span class="keywordflow">else</span> {
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {
<a name="l00698"></a>00698             firstBlockInd = outerDubBlockInd*2*outerBlockSize;
<a name="l00699"></a>00699             
<a name="l00700"></a>00700             <span class="comment">// same thing but undesired outer blocks come first</span>
<a name="l00701"></a>00701             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd, outerBlockSize);
<a name="l00702"></a>00702             <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00703"></a>00703                 qureg, totalStateProb, innerBit==outcome, 
<a name="l00704"></a>00704                 firstBlockInd + outerBlockSize, outerBlockSize, innerBlockSize);
<a name="l00705"></a>00705         }
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707     
<a name="l00708"></a>00708 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a101e7ef38c5d654a697dafe14562dcee"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_findProbabilityOfZeroLocal" ref="a101e7ef38c5d654a697dafe14562dcee" args="(Qureg qureg, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02637">2637</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01231">densmatr_calcProbOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02637"></a>02637                                                                                {
<a name="l02638"></a>02638     
<a name="l02639"></a>02639     <span class="comment">// computes first local index containing a diagonal element</span>
<a name="l02640"></a>02640     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02641"></a>02641     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l02642"></a>02642     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + densityDim;
<a name="l02643"></a>02643     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxNumDiagsPerChunk = 1 + localNumAmps / diagSpacing;
<a name="l02644"></a>02644     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>&gt;0)? 1+(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*localNumAmps)/diagSpacing : 0;
<a name="l02645"></a>02645     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;
<a name="l02646"></a>02646     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % localNumAmps;
<a name="l02647"></a>02647     
<a name="l02648"></a>02648     <span class="comment">// computes how many diagonals are contained in this chunk</span>
<a name="l02649"></a>02649     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDiagsInThisChunk = maxNumDiagsPerChunk;
<a name="l02650"></a>02650     <span class="keywordflow">if</span> (localIndNextDiag + (numDiagsInThisChunk-1)*diagSpacing &gt;= localNumAmps)
<a name="l02651"></a>02651         numDiagsInThisChunk -= 1;
<a name="l02652"></a>02652     
<a name="l02653"></a>02653     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> visitedDiags;     <span class="comment">// number of visited diagonals in this chunk so far</span>
<a name="l02654"></a>02654     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> basisStateInd;    <span class="comment">// current diagonal index being considered</span>
<a name="l02655"></a>02655     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;            <span class="comment">// index in the local chunk</span>
<a name="l02656"></a>02656     
<a name="l02657"></a>02657     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> zeroProb = 0;
<a name="l02658"></a>02658     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02659"></a>02659     
<a name="l02660"></a>02660 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02661"></a>02661 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02662"></a>02662 <span class="preprocessor">    shared    (localIndNextDiag, numPrevDiags, diagSpacing, stateVecReal, numDiagsInThisChunk) \</span>
<a name="l02663"></a>02663 <span class="preprocessor">    private   (visitedDiags, basisStateInd, index) \</span>
<a name="l02664"></a>02664 <span class="preprocessor">    reduction ( +:zeroProb )</span>
<a name="l02665"></a>02665 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l02666"></a>02666 <span class="preprocessor"></span>    {
<a name="l02667"></a>02667 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02668"></a>02668 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02669"></a>02669 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02670"></a>02670 <span class="preprocessor"></span>        <span class="comment">// sums the diagonal elems of the density matrix where measureQubit=0</span>
<a name="l02671"></a>02671         <span class="keywordflow">for</span> (visitedDiags = 0; visitedDiags &lt; numDiagsInThisChunk; visitedDiags++) {
<a name="l02672"></a>02672             
<a name="l02673"></a>02673             basisStateInd = numPrevDiags + visitedDiags;
<a name="l02674"></a>02674             index = localIndNextDiag + diagSpacing * visitedDiags;
<a name="l02675"></a>02675     
<a name="l02676"></a>02676             <span class="keywordflow">if</span> (<a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(measureQubit, basisStateInd) == 0)
<a name="l02677"></a>02677                 zeroProb += stateVecReal[index]; <span class="comment">// assume imag[diagonls] ~ 0</span>
<a name="l02678"></a>02678 
<a name="l02679"></a>02679         }
<a name="l02680"></a>02680     }
<a name="l02681"></a>02681     
<a name="l02682"></a>02682     <span class="keywordflow">return</span> zeroProb;
<a name="l02683"></a>02683 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20a155f53efc45c16803d7539c2c199d"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_initClassicalState" ref="a20a155f53efc45c16803d7539c2c199d" args="(Qureg qureg, long long int stateInd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>stateInd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00894">894</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00895"></a>00895 {
<a name="l00896"></a>00896     <span class="comment">// dimension of the state vector</span>
<a name="l00897"></a>00897     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityNumElems = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l00900"></a>00900     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00901"></a>00901     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <span class="comment">// initialise the state to all zeros</span>
<a name="l00904"></a>00904     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00905"></a>00905 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00906"></a>00906 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00907"></a>00907 <span class="preprocessor">    default  (none) \</span>
<a name="l00908"></a>00908 <span class="preprocessor">    shared   (densityNumElems, densityReal, densityImag) \</span>
<a name="l00909"></a>00909 <span class="preprocessor">    private  (index) </span>
<a name="l00910"></a>00910 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00911"></a>00911 <span class="preprocessor"></span>    {
<a name="l00912"></a>00912 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00913"></a>00913 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00914"></a>00914 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00915"></a>00915 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;densityNumElems; index++) {
<a name="l00916"></a>00916             densityReal[index] = 0.0;
<a name="l00917"></a>00917             densityImag[index] = 0.0;
<a name="l00918"></a>00918         }
<a name="l00919"></a>00919     }
<a name="l00920"></a>00920     
<a name="l00921"></a>00921     <span class="comment">// index of the single density matrix elem to set non-zero</span>
<a name="l00922"></a>00922     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>;
<a name="l00923"></a>00923     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityInd = (densityDim + 1)*stateInd;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="comment">// give the specified classical state prob 1</span>
<a name="l00926"></a>00926     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> == densityInd / densityNumElems){
<a name="l00927"></a>00927         densityReal[densityInd % densityNumElems] = 1.0;
<a name="l00928"></a>00928         densityImag[densityInd % densityNumElems] = 0.0;
<a name="l00929"></a>00929     }
<a name="l00930"></a>00930 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad5b2ac0b00afa495f385520b2c5fa839"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_initPlusState" ref="ad5b2ac0b00afa495f385520b2c5fa839" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00933">933</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00934"></a>00934 {
<a name="l00935"></a>00935     <span class="comment">// |+&gt;&lt;+| = sum_i 1/sqrt(2^N) |i&gt; 1/sqrt(2^N) &lt;j| = sum_ij 1/2^N |i&gt;&lt;j|</span>
<a name="l00936"></a>00936     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dim = (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00937"></a>00937     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> probFactor = 1.0/((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>) dim);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l00940"></a>00940     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00941"></a>00941     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00944"></a>00944     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00945"></a>00945     <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span>
<a name="l00946"></a>00946 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00947"></a>00947 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00948"></a>00948 <span class="preprocessor">    default  (none) \</span>
<a name="l00949"></a>00949 <span class="preprocessor">    shared   (chunkSize, densityReal, densityImag, probFactor) \</span>
<a name="l00950"></a>00950 <span class="preprocessor">    private  (index) </span>
<a name="l00951"></a>00951 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>    {
<a name="l00953"></a>00953 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00954"></a>00954 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00955"></a>00955 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00956"></a>00956 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00957"></a>00957             densityReal[index] = probFactor;
<a name="l00958"></a>00958             densityImag[index] = 0.0;
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1b36518c8fbbc3a5084bb4ad1fb05ea5"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_initPureStateLocal" ref="a1b36518c8fbbc3a5084bb4ad1fb05ea5" args="(Qureg targetQureg, Qureg copyQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPureStateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>copyQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00963">963</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00093">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00428">densmatr_initPureState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00963"></a>00963                                                                      {
<a name="l00964"></a>00964     
<a name="l00965"></a>00965     <span class="comment">/* copyQureg amps aren&apos;t explicitly used - they&apos;re accessed through targetQureg.pair,</span>
<a name="l00966"></a>00966 <span class="comment">     * which contains the full pure statevector.</span>
<a name="l00967"></a>00967 <span class="comment">     * targetQureg has as many columns on node as copyQureg has amps</span>
<a name="l00968"></a>00968 <span class="comment">     */</span>
<a name="l00969"></a>00969     
<a name="l00970"></a>00970     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colOffset = targetQureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> * copyQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00971"></a>00971     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colsPerNode = copyQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00972"></a>00972     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> rowsPerNode = copyQureg.<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4" title="Total number of amplitudes, which are possibly distributed among machines.">numAmpsTotal</a>;
<a name="l00973"></a>00973     
<a name="l00974"></a>00974     <span class="comment">// unpack vars for OpenMP</span>
<a name="l00975"></a>00975     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecRe = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real;
<a name="l00976"></a>00976     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecIm = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag;
<a name="l00977"></a>00977     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* densRe = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00978"></a>00978     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* densIm = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00979"></a>00979     
<a name="l00980"></a>00980     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> col, row, index;
<a name="l00981"></a>00981     
<a name="l00982"></a>00982     <span class="comment">// a_i conj(a_j) |i&gt;&lt;j|</span>
<a name="l00983"></a>00983     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> ketRe, ketIm, braRe, braIm;
<a name="l00984"></a>00984     
<a name="l00985"></a>00985 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00986"></a>00986 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00987"></a>00987 <span class="preprocessor">    default  (none) \</span>
<a name="l00988"></a>00988 <span class="preprocessor">    shared   (colOffset, colsPerNode,rowsPerNode, vecRe,vecIm,densRe,densIm) \</span>
<a name="l00989"></a>00989 <span class="preprocessor">    private  (col,row, ketRe,ketIm,braRe,braIm, index) </span>
<a name="l00990"></a>00990 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00991"></a>00991 <span class="preprocessor"></span>    {
<a name="l00992"></a>00992 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00993"></a>00993 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00994"></a>00994 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00995"></a>00995 <span class="preprocessor"></span>        <span class="comment">// local column</span>
<a name="l00996"></a>00996         <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {
<a name="l00997"></a>00997         
<a name="l00998"></a>00998             <span class="comment">// global row</span>
<a name="l00999"></a>00999             <span class="keywordflow">for</span> (row=0; row &lt; rowsPerNode; row++) {
<a name="l01000"></a>01000             
<a name="l01001"></a>01001                 <span class="comment">// get pure state amps</span>
<a name="l01002"></a>01002                 ketRe = vecRe[row];
<a name="l01003"></a>01003                 ketIm = vecIm[row];
<a name="l01004"></a>01004                 braRe = vecRe[col + colOffset];
<a name="l01005"></a>01005                 braIm = vecIm[col + colOffset];
<a name="l01006"></a>01006             
<a name="l01007"></a>01007                 <span class="comment">// update density matrix</span>
<a name="l01008"></a>01008                 index = row + col*rowsPerNode; <span class="comment">// local ind</span>
<a name="l01009"></a>01009                 densRe[index] = ketRe*braRe - ketIm*braIm;
<a name="l01010"></a>01010                 densIm[index] = ketRe*braIm - ketIm*braRe;
<a name="l01011"></a>01011             }
<a name="l01012"></a>01012         }
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56b32228c24a7c4e1894d991ef4b6b99"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_oneQubitDephase" ref="a56b32228c24a7c4e1894d991ef4b6b99" args="(Qureg qureg, const int targetQubit, qreal dephase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>dephase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00036">36</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00036"></a>00036                                                                                  {
<a name="l00037"></a>00037         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> retain=1-dephase;
<a name="l00038"></a>00038     
<a name="l00039"></a>00039         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00040"></a>00040         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;
<a name="l00041"></a>00041         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00042"></a>00042     
<a name="l00043"></a>00043         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00044"></a>00044         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;
<a name="l00045"></a>00045         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor"> # ifdef _OPENMP</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00049"></a>00049 <span class="preprocessor">    default  (none) \</span>
<a name="l00050"></a>00050 <span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain) \</span>
<a name="l00051"></a>00051 <span class="preprocessor">    private  (thisTask,thisPattern) </span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>    {
<a name="l00054"></a>00054 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){
<a name="l00058"></a>00058             thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMask;
<a name="l00059"></a>00059             <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){
<a name="l00060"></a>00060                 <span class="comment">// do dephase</span>
<a name="l00061"></a>00061                 <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span>
<a name="l00062"></a>00062                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask]; 
<a name="l00063"></a>00063                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask]; 
<a name="l00064"></a>00064             } 
<a name="l00065"></a>00065         }  
<a name="l00066"></a>00066     }
<a name="l00067"></a>00067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a48e0715ee615f2ce44477521ab760627"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_oneQubitDepolariseDistributed" ref="a48e0715ee615f2ce44477521ab760627" args="(Qureg qureg, const int targetQubit, qreal depolLevel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDepolariseDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>depolLevel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00159">159</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00036">densmatr_oneQubitDephase()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00676">densmatr_oneQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00159"></a>00159                                                                                                   {
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// first do dephase part. </span>
<a name="l00162"></a>00162     <span class="comment">// TODO -- this might be more efficient to do at the same time as the depolarise if we move to</span>
<a name="l00163"></a>00163     <span class="comment">// iterating over all elements in the state vector for the purpose of vectorisation</span>
<a name="l00164"></a>00164     <span class="comment">// TODO -- if we keep this split, move this function to densmatr_oneQubitDepolarise()</span>
<a name="l00165"></a>00165     <a class="code" href="QuEST__internal_8h.html#a56b32228c24a7c4e1894d991ef4b6b99">densmatr_oneQubitDephase</a>(qureg, targetQubit, depolLevel);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlock, sizeInnerHalfBlock;
<a name="l00168"></a>00168     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterHalfColumn;
<a name="l00169"></a>00169     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlock, <span class="comment">// current block</span>
<a name="l00170"></a>00170          thisOuterColumn, <span class="comment">// current column in density matrix</span>
<a name="l00171"></a>00171          thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span>
<a name="l00172"></a>00172          thisIndexInOuterColumn,
<a name="l00173"></a>00173          thisIndexInInnerBlock; 
<a name="l00174"></a>00174     <span class="keywordtype">int</span> outerBit; 
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00177"></a>00177     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="comment">// set dimensions</span>
<a name="l00180"></a>00180     sizeInnerHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l00181"></a>00181     sizeInnerBlock = 2LL * sizeInnerHalfBlock; 
<a name="l00182"></a>00182     sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>;
<a name="l00183"></a>00183     sizeOuterHalfColumn = sizeOuterColumn &gt;&gt; 1;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00187"></a>00187 <span class="preprocessor">    default  (none) \</span>
<a name="l00188"></a>00188 <span class="preprocessor">    shared   (sizeInnerBlock,sizeInnerHalfBlock,sizeOuterColumn,sizeOuterHalfColumn,qureg,depolLevel) \</span>
<a name="l00189"></a>00189 <span class="preprocessor">    private  (thisTask,thisInnerBlock,thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span>
<a name="l00190"></a>00190 <span class="preprocessor">                thisIndexInInnerBlock,outerBit) </span>
<a name="l00191"></a>00191 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>    {
<a name="l00193"></a>00193 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00194"></a>00194 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>        <span class="comment">// thisTask iterates over half the elements in this process&apos; chunk of the density matrix</span>
<a name="l00197"></a>00197         <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span>
<a name="l00198"></a>00198         <span class="comment">// within one column.</span>
<a name="l00199"></a>00199         <span class="comment">// If this function has been called, this process&apos; chunk contains half an </span>
<a name="l00200"></a>00200         <span class="comment">// outer block or less</span>
<a name="l00201"></a>00201         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00202"></a>00202             <span class="comment">// we want to process all columns in the density matrix,</span>
<a name="l00203"></a>00203             <span class="comment">// updating the values for half of each column (one half of each inner block)</span>
<a name="l00204"></a>00204             thisOuterColumn = thisTask / sizeOuterHalfColumn;
<a name="l00205"></a>00205             thisIndexInOuterColumn = thisTask&amp;(sizeOuterHalfColumn-1); <span class="comment">// thisTask % sizeOuterHalfColumn</span>
<a name="l00206"></a>00206             thisInnerBlock = thisIndexInOuterColumn/sizeInnerHalfBlock;
<a name="l00207"></a>00207             <span class="comment">// get index in state vector corresponding to upper inner block</span>
<a name="l00208"></a>00208             thisIndexInInnerBlock = thisTask&amp;(sizeInnerHalfBlock-1); <span class="comment">// thisTask % sizeInnerHalfBlock</span>
<a name="l00209"></a>00209             thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlock*sizeInnerBlock 
<a name="l00210"></a>00210                 + thisIndexInInnerBlock;
<a name="l00211"></a>00211             <span class="comment">// check if we are in the upper or lower half of an outer block</span>
<a name="l00212"></a>00212             outerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00213"></a>00213             <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span>
<a name="l00214"></a>00214             <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span>
<a name="l00215"></a>00215             thisIndex += outerBit*(sizeInnerHalfBlock);
<a name="l00216"></a>00216 
<a name="l00217"></a>00217             <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span>
<a name="l00218"></a>00218             <span class="comment">// dephase in the chunk of the state vector on this process, in the </span>
<a name="l00219"></a>00219             <span class="comment">// density matrix representation. </span>
<a name="l00220"></a>00220             <span class="comment">// thisTask is the index of the pair element in pairStateVec</span>
<a name="l00221"></a>00221 
<a name="l00222"></a>00222            
<a name="l00223"></a>00223             <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span>
<a name="l00224"></a>00224             <span class="comment">//      + pair[thisTask])/2</span>
<a name="l00225"></a>00225             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] = (1-depolLevel)*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] +
<a name="l00226"></a>00226                     depolLevel*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] + qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real[thisTask])/2;
<a name="l00227"></a>00227             
<a name="l00228"></a>00228             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] = (1-depolLevel)*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] +
<a name="l00229"></a>00229                     depolLevel*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] + qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag[thisTask])/2;
<a name="l00230"></a>00230         } 
<a name="l00231"></a>00231     }    
<a name="l00232"></a>00232 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5a0dd013940cf2ea20c397a551d9b781"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_oneQubitDepolariseLocal" ref="a5a0dd013940cf2ea20c397a551d9b781" args="(Qureg qureg, const int targetQubit, qreal depolLevel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDepolariseLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>depolLevel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00110">110</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00676">densmatr_oneQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00110"></a>00110                                                                                             {
<a name="l00111"></a>00111     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> retain=1-depolLevel;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00114"></a>00114     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;
<a name="l00115"></a>00115     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00116"></a>00116     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00119"></a>00119     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;
<a name="l00120"></a>00120     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> realAv, imagAv;
<a name="l00123"></a>00123         
<a name="l00124"></a>00124 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00126"></a>00126 <span class="preprocessor">    default  (none) \</span>
<a name="l00127"></a>00127 <span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,depolLevel) \</span>
<a name="l00128"></a>00128 <span class="preprocessor">    private  (thisTask,partner,thisPattern,realAv,imagAv) </span>
<a name="l00129"></a>00129 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00130"></a>00130 <span class="preprocessor"></span>    {
<a name="l00131"></a>00131 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00133"></a>00133 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){
<a name="l00135"></a>00135             thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMask;
<a name="l00136"></a>00136             <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){
<a name="l00137"></a>00137                 <span class="comment">// do dephase</span>
<a name="l00138"></a>00138                 <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span>
<a name="l00139"></a>00139                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask]; 
<a name="l00140"></a>00140                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask]; 
<a name="l00141"></a>00141             } <span class="keywordflow">else</span> {
<a name="l00142"></a>00142                 <span class="keywordflow">if</span> ((thisTask&amp;totMask)==0){ <span class="comment">//this element relates to targetQubit in state 0</span>
<a name="l00143"></a>00143                     <span class="comment">// do depolarise</span>
<a name="l00144"></a>00144                     partner = thisTask | totMask;
<a name="l00145"></a>00145                     realAv =  (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] + qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner]) /2 ;
<a name="l00146"></a>00146                     imagAv =  (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] + qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner]) /2 ;
<a name="l00147"></a>00147                     
<a name="l00148"></a>00148                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] + depolLevel*realAv;
<a name="l00149"></a>00149                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] + depolLevel*imagAv;
<a name="l00150"></a>00150                     
<a name="l00151"></a>00151                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] + depolLevel*realAv;
<a name="l00152"></a>00152                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] + depolLevel*imagAv;
<a name="l00153"></a>00153                 }
<a name="l00154"></a>00154             }
<a name="l00155"></a>00155         }  
<a name="l00156"></a>00156     }
<a name="l00157"></a>00157 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8fde996ce8ba014fce542549406813f9"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_twoQubitDephase" ref="a8fde996ce8ba014fce542549406813f9" args="(Qureg qureg, const int qubit1, const int qubit2, qreal dephase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>dephase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00069">69</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00069"></a>00069                                                                                               {
<a name="l00070"></a>00070     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> retain=1-dephase;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00073"></a>00073     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;
<a name="l00074"></a>00074     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1 = 1LL &lt;&lt; (qubit1 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00075"></a>00075     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;
<a name="l00076"></a>00076     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00077"></a>00077     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1|outerMaskQubit1;
<a name="l00078"></a>00078     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2|outerMaskQubit2;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00081"></a>00081     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00085"></a>00085 <span class="preprocessor">    default  (none) \</span>
<a name="l00086"></a>00086 <span class="preprocessor">    shared   (innerMaskQubit1,outerMaskQubit1,totMaskQubit1,innerMaskQubit2,outerMaskQubit2, \</span>
<a name="l00087"></a>00087 <span class="preprocessor">                totMaskQubit2,qureg,retain) \</span>
<a name="l00088"></a>00088 <span class="preprocessor">    private  (thisTask,thisPatternQubit1,thisPatternQubit2) </span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>    {
<a name="l00091"></a>00091 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){
<a name="l00095"></a>00095             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00096"></a>00096             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00097"></a>00097             
<a name="l00098"></a>00098             <span class="comment">// any mismatch |...0...&gt;&lt;...1...| etc</span>
<a name="l00099"></a>00099             <span class="keywordflow">if</span> ( (thisPatternQubit1==innerMaskQubit1) || (thisPatternQubit1==outerMaskQubit1) || 
<a name="l00100"></a>00100                     (thisPatternQubit2==innerMaskQubit2) || (thisPatternQubit2==outerMaskQubit2) ){ 
<a name="l00101"></a>00101                 <span class="comment">// do dephase</span>
<a name="l00102"></a>00102                 <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span>
<a name="l00103"></a>00103                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask]; 
<a name="l00104"></a>00104                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask]; 
<a name="l00105"></a>00105             } 
<a name="l00106"></a>00106         }  
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a51a641ea15f95481375ff76791e023"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_twoQubitDepolariseDistributed" ref="a4a51a641ea15f95481375ff76791e023" args="(Qureg qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolariseDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00390">390</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00391"></a>00391                                                     {
<a name="l00392"></a>00392 
<a name="l00393"></a>00393     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;
<a name="l00394"></a>00394     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;
<a name="l00395"></a>00395     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;
<a name="l00396"></a>00396     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,
<a name="l00397"></a>00397          thisOuterColumn, <span class="comment">// current column in density matrix</span>
<a name="l00398"></a>00398          thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span>
<a name="l00399"></a>00399          thisIndexInOuterColumn,
<a name="l00400"></a>00400          thisIndexInInnerBlockQ1, 
<a name="l00401"></a>00401          thisIndexInInnerBlockQ2, 
<a name="l00402"></a>00402          thisInnerBlockQ1InInnerBlockQ2;
<a name="l00403"></a>00403     <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; 
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00406"></a>00406     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;2;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="comment">// set dimensions</span>
<a name="l00409"></a>00409     sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  
<a name="l00410"></a>00410     sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  
<a name="l00411"></a>00411     sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  
<a name="l00412"></a>00412     sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  
<a name="l00413"></a>00413     sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; 
<a name="l00414"></a>00414     sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>;
<a name="l00415"></a>00415     sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00418"></a>00418 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00419"></a>00419 <span class="preprocessor">    default  (none) \</span>
<a name="l00420"></a>00420 <span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span>
<a name="l00421"></a>00421 <span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma) \</span>
<a name="l00422"></a>00422 <span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span>
<a name="l00423"></a>00423 <span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span>
<a name="l00424"></a>00424 <span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2) </span>
<a name="l00425"></a>00425 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span>    {
<a name="l00427"></a>00427 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00428"></a>00428 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00429"></a>00429 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00430"></a>00430 <span class="preprocessor"></span>        <span class="comment">// thisTask iterates over half the elements in this process&apos; chunk of the density matrix</span>
<a name="l00431"></a>00431         <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span>
<a name="l00432"></a>00432         <span class="comment">// within one column.</span>
<a name="l00433"></a>00433         <span class="comment">// If this function has been called, this process&apos; chunk contains half an </span>
<a name="l00434"></a>00434         <span class="comment">// outer block or less</span>
<a name="l00435"></a>00435         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00436"></a>00436             <span class="comment">// we want to process all columns in the density matrix,</span>
<a name="l00437"></a>00437             <span class="comment">// updating the values for half of each column (one half of each inner block)</span>
<a name="l00438"></a>00438             thisOuterColumn = thisTask / sizeOuterQuarterColumn;
<a name="l00439"></a>00439             <span class="comment">// thisTask % sizeOuterQuarterColumn</span>
<a name="l00440"></a>00440             thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); 
<a name="l00441"></a>00441             thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;
<a name="l00442"></a>00442             <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span>
<a name="l00443"></a>00443             thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);
<a name="l00444"></a>00444             thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;
<a name="l00445"></a>00445             <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span>
<a name="l00446"></a>00446             thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448             <span class="comment">// get index in state vector corresponding to upper inner block</span>
<a name="l00449"></a>00449             thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 
<a name="l00450"></a>00450                 + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452             <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span>
<a name="l00453"></a>00453             outerBitQ1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00454"></a>00454             <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span>
<a name="l00455"></a>00455             <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span>
<a name="l00456"></a>00456             thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458             <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span>
<a name="l00459"></a>00459             outerBitQ2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00460"></a>00460             <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span>
<a name="l00461"></a>00461             <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span>
<a name="l00462"></a>00462             thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464             <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span>
<a name="l00465"></a>00465             <span class="comment">// dephase in the chunk of the state vector on this process, in the </span>
<a name="l00466"></a>00466             <span class="comment">// density matrix representation. </span>
<a name="l00467"></a>00467             <span class="comment">// thisTask is the index of the pair element in pairStateVec</span>
<a name="l00468"></a>00468 
<a name="l00469"></a>00469            
<a name="l00470"></a>00470             <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span>
<a name="l00471"></a>00471             <span class="comment">//      + pair[thisTask])/2</span>
<a name="l00472"></a>00472             <span class="comment">// NOTE: must set gamma=1 if using this function for steps 1 or 2</span>
<a name="l00473"></a>00473             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] +
<a name="l00474"></a>00474                     delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real[thisTask]);
<a name="l00475"></a>00475             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] +
<a name="l00476"></a>00476                     delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag[thisTask]);
<a name="l00477"></a>00477         } 
<a name="l00478"></a>00478     }    
<a name="l00479"></a>00479 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a63a1b6169f59e86988aa519b71c496fb"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_twoQubitDepolariseLocal" ref="a63a1b6169f59e86988aa519b71c496fb" args="(Qureg qureg, int qubit1, int qubit2, qreal delta, qreal gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolariseLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00235">235</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00235"></a>00235                                                                                                      {
<a name="l00236"></a>00236     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00237"></a>00237     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;
<a name="l00238"></a>00238     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00239"></a>00239     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;
<a name="l00240"></a>00240     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;
<a name="l00241"></a>00241     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00242"></a>00242     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00245"></a>00245     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;
<a name="l00246"></a>00246     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> real00, imag00;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00251"></a>00251 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00252"></a>00252 <span class="preprocessor">    default  (none) \</span>
<a name="l00253"></a>00253 <span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta,gamma) \</span>
<a name="l00254"></a>00254 <span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00) </span>
<a name="l00255"></a>00255 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>    {
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span>
<a name="l00262"></a>00262         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ 
<a name="l00263"></a>00263             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00264"></a>00264             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00265"></a>00265             <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) 
<a name="l00266"></a>00266                         || (thisPatternQubit2==totMaskQubit2))){ 
<a name="l00267"></a>00267                 <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span>
<a name="l00268"></a>00268                 partner = thisTask | totMaskQubit1;
<a name="l00269"></a>00269                 real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask];
<a name="l00270"></a>00270                 imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask];
<a name="l00271"></a>00271                     
<a name="l00272"></a>00272                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] 
<a name="l00273"></a>00273                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner];
<a name="l00274"></a>00274                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] 
<a name="l00275"></a>00275                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner];
<a name="l00276"></a>00276                     
<a name="l00277"></a>00277                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] + delta*real00;
<a name="l00278"></a>00278                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] + delta*imag00;
<a name="l00279"></a>00279                                 
<a name="l00280"></a>00280             }
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span>        <span class="comment">//--------------------------------------- STEP TWO ---------------------</span>
<a name="l00286"></a>00286         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ 
<a name="l00287"></a>00287             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00288"></a>00288             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00289"></a>00289             <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) 
<a name="l00290"></a>00290                         || (thisPatternQubit1==totMaskQubit1))){ 
<a name="l00291"></a>00291                 <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span>
<a name="l00292"></a>00292                 partner = thisTask | totMaskQubit2;
<a name="l00293"></a>00293                 real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask];
<a name="l00294"></a>00294                 imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask];
<a name="l00295"></a>00295                     
<a name="l00296"></a>00296                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] 
<a name="l00297"></a>00297                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner];
<a name="l00298"></a>00298                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] 
<a name="l00299"></a>00299                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner];
<a name="l00300"></a>00300                     
<a name="l00301"></a>00301                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] + delta*real00;
<a name="l00302"></a>00302                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] + delta*imag00;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304             }
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00309"></a>00309 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span>        <span class="comment">//--------------------------------------- STEP THREE ---------------------</span>
<a name="l00311"></a>00311         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ 
<a name="l00312"></a>00312             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00313"></a>00313             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00314"></a>00314             <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) 
<a name="l00315"></a>00315                         || (thisPatternQubit1==totMaskQubit1))){ 
<a name="l00316"></a>00316                 <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span>
<a name="l00317"></a>00317                 partner = thisTask | totMaskQubit2;
<a name="l00318"></a>00318                 partner = partner ^ totMaskQubit1;
<a name="l00319"></a>00319                 real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask];
<a name="l00320"></a>00320                 imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask];
<a name="l00321"></a>00321 
<a name="l00322"></a>00322                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] 
<a name="l00323"></a>00323                         + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner]);
<a name="l00324"></a>00324                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] 
<a name="l00325"></a>00325                         + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner]);
<a name="l00326"></a>00326                     
<a name="l00327"></a>00327                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] 
<a name="l00328"></a>00328                         + delta*real00);
<a name="l00329"></a>00329                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] = gamma * (qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] 
<a name="l00330"></a>00330                         + delta*imag00);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332             }
<a name="l00333"></a>00333         }
<a name="l00334"></a>00334     }
<a name="l00335"></a>00335 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f8192d6f93ea1565a27a8556d48878b"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_twoQubitDepolariseLocalPart1" ref="a7f8192d6f93ea1565a27a8556d48878b" args="(Qureg qureg, int qubit1, int qubit2, qreal delta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolariseLocalPart1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>delta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00337">337</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00337"></a>00337                                                                                              {
<a name="l00338"></a>00338     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00339"></a>00339     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;
<a name="l00340"></a>00340     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00341"></a>00341     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;
<a name="l00342"></a>00342     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;
<a name="l00343"></a>00343     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00344"></a>00344     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;
<a name="l00345"></a>00345     <span class="comment">// correct for being in a particular chunk</span>
<a name="l00346"></a>00346     <span class="comment">//totMaskQubit2 = totMaskQubit2&amp;(qureg.numAmpsPerChunk-1); // totMaskQubit2 % numAmpsPerChunk</span>
<a name="l00347"></a>00347     
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00350"></a>00350     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;
<a name="l00351"></a>00351     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> real00, imag00;
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00357"></a>00357 <span class="preprocessor">    default  (none) \</span>
<a name="l00358"></a>00358 <span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta) \</span>
<a name="l00359"></a>00359 <span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00) </span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span>    {
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00365"></a>00365 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span>
<a name="l00367"></a>00367         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask ++){ 
<a name="l00368"></a>00368             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00369"></a>00369             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00370"></a>00370             <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) 
<a name="l00371"></a>00371                         || (thisPatternQubit2==totMaskQubit2))){ 
<a name="l00372"></a>00372                 <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span>
<a name="l00373"></a>00373                 partner = thisTask | totMaskQubit1;
<a name="l00374"></a>00374                 real00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask];
<a name="l00375"></a>00375                 imag00 =  qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask];
<a name="l00376"></a>00376                     
<a name="l00377"></a>00377                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] 
<a name="l00378"></a>00378                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner];
<a name="l00379"></a>00379                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] 
<a name="l00380"></a>00380                     + delta*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner];
<a name="l00381"></a>00381                     
<a name="l00382"></a>00382                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[partner] + delta*real00;
<a name="l00383"></a>00383                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[partner] + delta*imag00;
<a name="l00384"></a>00384                                 
<a name="l00385"></a>00385             }
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6946456e9b7814fc565f20622b9d2e5"></a><!-- doxytag: member="QuEST_cpu.c::densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3" ref="ae6946456e9b7814fc565f20622b9d2e5" args="(Qureg qureg, const int targetQubit, const int qubit2, qreal delta, qreal gamma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>gamma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00481">481</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00482"></a>00482                                                     {
<a name="l00483"></a>00483 
<a name="l00484"></a>00484     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;
<a name="l00485"></a>00485     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;
<a name="l00486"></a>00486     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;
<a name="l00487"></a>00487     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,
<a name="l00488"></a>00488          thisOuterColumn, <span class="comment">// current column in density matrix</span>
<a name="l00489"></a>00489          thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span>
<a name="l00490"></a>00490          thisIndexInPairVector,
<a name="l00491"></a>00491          thisIndexInOuterColumn,
<a name="l00492"></a>00492          thisIndexInInnerBlockQ1, 
<a name="l00493"></a>00493          thisIndexInInnerBlockQ2, 
<a name="l00494"></a>00494          thisInnerBlockQ1InInnerBlockQ2;
<a name="l00495"></a>00495     <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; 
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l00498"></a>00498     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;2;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="comment">// set dimensions</span>
<a name="l00501"></a>00501     sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  
<a name="l00502"></a>00502     sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  
<a name="l00503"></a>00503     sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  
<a name="l00504"></a>00504     sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  
<a name="l00505"></a>00505     sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; 
<a name="l00506"></a>00506     sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>;
<a name="l00507"></a>00507     sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="comment">//# if 0</span>
<a name="l00510"></a>00510 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00511"></a>00511 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00512"></a>00512 <span class="preprocessor">    default  (none) \</span>
<a name="l00513"></a>00513 <span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span>
<a name="l00514"></a>00514 <span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma) \</span>
<a name="l00515"></a>00515 <span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span>
<a name="l00516"></a>00516 <span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInPairVector,thisIndexInOuterColumn, \</span>
<a name="l00517"></a>00517 <span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2) </span>
<a name="l00518"></a>00518 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00519"></a>00519 <span class="preprocessor"></span>    {
<a name="l00520"></a>00520 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00521"></a>00521 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00522"></a>00522 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00523"></a>00523 <span class="preprocessor"></span><span class="comment">//# endif</span>
<a name="l00524"></a>00524         <span class="comment">// thisTask iterates over half the elements in this process&apos; chunk of the density matrix</span>
<a name="l00525"></a>00525         <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span>
<a name="l00526"></a>00526         <span class="comment">// within one column.</span>
<a name="l00527"></a>00527         <span class="comment">// If this function has been called, this process&apos; chunk contains half an </span>
<a name="l00528"></a>00528         <span class="comment">// outer block or less</span>
<a name="l00529"></a>00529         <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l00530"></a>00530             <span class="comment">// we want to process all columns in the density matrix,</span>
<a name="l00531"></a>00531             <span class="comment">// updating the values for half of each column (one half of each inner block)</span>
<a name="l00532"></a>00532             thisOuterColumn = thisTask / sizeOuterQuarterColumn;
<a name="l00533"></a>00533             <span class="comment">// thisTask % sizeOuterQuarterColumn</span>
<a name="l00534"></a>00534             thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); 
<a name="l00535"></a>00535             thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;
<a name="l00536"></a>00536             <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span>
<a name="l00537"></a>00537             thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);
<a name="l00538"></a>00538             thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;
<a name="l00539"></a>00539             <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span>
<a name="l00540"></a>00540             thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);
<a name="l00541"></a>00541 
<a name="l00542"></a>00542             <span class="comment">// get index in state vector corresponding to upper inner block</span>
<a name="l00543"></a>00543             thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 
<a name="l00544"></a>00544                 + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546             <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span>
<a name="l00547"></a>00547             outerBitQ1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00548"></a>00548             <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span>
<a name="l00549"></a>00549             <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span>
<a name="l00550"></a>00550             thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);
<a name="l00551"></a>00551             
<a name="l00552"></a>00552             <span class="comment">// For part 3 we need to match elements such that (my Q1 != pair Q1) AND (my Q2 != pair Q2)</span>
<a name="l00553"></a>00553             <span class="comment">// Find correct index in pairStateVector</span>
<a name="l00554"></a>00554             thisIndexInPairVector = thisTask + (1-outerBitQ1)*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn -
<a name="l00555"></a>00555                 outerBitQ1*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn;
<a name="l00556"></a>00556             
<a name="l00557"></a>00557             <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span>
<a name="l00558"></a>00558             outerBitQ2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&gt;&gt;qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00559"></a>00559             <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span>
<a name="l00560"></a>00560             <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span>
<a name="l00561"></a>00561             thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);
<a name="l00562"></a>00562             
<a name="l00563"></a>00563             
<a name="l00564"></a>00564             <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span>
<a name="l00565"></a>00565             <span class="comment">// dephase in the chunk of the state vector on this process, in the </span>
<a name="l00566"></a>00566             <span class="comment">// density matrix representation. </span>
<a name="l00567"></a>00567 
<a name="l00568"></a>00568            
<a name="l00569"></a>00569             <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span>
<a name="l00570"></a>00570             <span class="comment">//      + pair[thisIndexInPairVector])/2</span>
<a name="l00571"></a>00571             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisIndex] +
<a name="l00572"></a>00572                     delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real[thisIndexInPairVector]);
<a name="l00573"></a>00573             
<a name="l00574"></a>00574             qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisIndex] +
<a name="l00575"></a>00575                     delta*qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag[thisIndexInPairVector]);
<a name="l00576"></a>00576         } 
<a name="l00577"></a>00577     }    
<a name="l00578"></a>00578 
<a name="l00579"></a>00579 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a100463f6ec212c76a5fad99579000505"></a><!-- doxytag: member="QuEST_cpu.c::extractBit" ref="a100463f6ec212c76a5fad99579000505" args="(const int locationOfBitFromRight, const long long int theEncodedNumber)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int extractBit </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>locationOfBitFromRight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&nbsp;</td>
          <td class="paramname"> <em>theEncodedNumber</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the value of the bit at a particular index in a number. </p>
<p>SCB edit: new definition of extractBit is much faster *** </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>locationOfBitFromRight</em>&nbsp;</td><td>location of bit in theEncodedNumber </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>theEncodedNumber</em>&nbsp;</td><td>number to search </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the value of the bit in theEncodedNumber </dd></dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00031">31</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02637">densmatr_findProbabilityOfZeroLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00159">densmatr_oneQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00390">densmatr_twoQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00481">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01857">statevec_controlledCompactUnitaryDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01648">statevec_controlledCompactUnitaryLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02184">statevec_controlledNotDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02121">statevec_controlledNotLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02366">statevec_controlledPauliYDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02313">statevec_controlledPauliYLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02789">statevec_controlledPhaseFlip()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02554">statevec_controlledPhaseShift()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01920">statevec_controlledUnitaryDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01778">statevec_controlledUnitaryLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01275">statevec_initStateOfSingleQubit()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00032"></a>00032 {
<a name="l00033"></a>00033     <span class="keywordflow">return</span> (theEncodedNumber &amp; ( 1LL &lt;&lt; locationOfBitFromRight )) &gt;&gt; locationOfBitFromRight;
<a name="l00034"></a>00034 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a031a99b7e97779f3dc782feffe86e779"></a><!-- doxytag: member="QuEST_cpu.c::normaliseSomeAmps" ref="a031a99b7e97779f3dc782feffe86e779" args="(Qureg qureg, qreal norm, long long int startInd, long long int numAmps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normaliseSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>numAmps</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00593">593</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00603">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00593"></a>00593                                                                                                {
<a name="l00594"></a>00594     
<a name="l00595"></a>00595 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00596"></a>00596 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for schedule (static)</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00598"></a>00598 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=startInd; i &lt; startInd+numAmps; i++) {
<a name="l00599"></a>00599         qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i] /= norm;
<a name="l00600"></a>00600         qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i] /= norm;
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6fbb3b693f25dde1e9e3dc87dc1984f7"></a><!-- doxytag: member="QuEST_cpu.c::statevec_calcInnerProductLocal" ref="a6fbb3b693f25dde1e9e3dc87dc1984f7" args="(Qureg bra, Qureg ket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcInnerProductLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>bra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>ket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00850">850</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00041">statevec_calcInnerProduct()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00850"></a>00850                                                              {
<a name="l00851"></a>00851     
<a name="l00852"></a>00852     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> innerProdReal = 0;
<a name="l00853"></a>00853     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> innerProdImag = 0;
<a name="l00854"></a>00854     
<a name="l00855"></a>00855     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00856"></a>00856     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = bra.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00857"></a>00857     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *braVecReal = bra.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00858"></a>00858     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *braVecImag = bra.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00859"></a>00859     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *ketVecReal = ket.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00860"></a>00860     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *ketVecImag = ket.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00861"></a>00861     
<a name="l00862"></a>00862     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> braRe, braIm, ketRe, ketIm;
<a name="l00863"></a>00863     
<a name="l00864"></a>00864 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00865"></a>00865 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00866"></a>00866 <span class="preprocessor">    shared    (braVecReal, braVecImag, ketVecReal, ketVecImag, numAmps) \</span>
<a name="l00867"></a>00867 <span class="preprocessor">    private   (index, braRe, braIm, ketRe, ketIm) \</span>
<a name="l00868"></a>00868 <span class="preprocessor">    reduction ( +:innerProdReal, innerProdImag )</span>
<a name="l00869"></a>00869 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00870"></a>00870 <span class="preprocessor"></span>    {
<a name="l00871"></a>00871 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00872"></a>00872 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l00873"></a>00873 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00874"></a>00874 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {
<a name="l00875"></a>00875             braRe = braVecReal[index];
<a name="l00876"></a>00876             braIm = braVecImag[index];
<a name="l00877"></a>00877             ketRe = ketVecReal[index];
<a name="l00878"></a>00878             ketIm = ketVecImag[index];
<a name="l00879"></a>00879             
<a name="l00880"></a>00880             <span class="comment">// conj(bra_i) * ket_i</span>
<a name="l00881"></a>00881             innerProdReal += braRe*ketRe + braIm*ketIm;
<a name="l00882"></a>00882             innerProdImag += braRe*ketIm - braIm*ketRe;
<a name="l00883"></a>00883         }
<a name="l00884"></a>00884     }
<a name="l00885"></a>00885     
<a name="l00886"></a>00886     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> innerProd;
<a name="l00887"></a>00887     innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = innerProdReal;
<a name="l00888"></a>00888     innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = innerProdImag;
<a name="l00889"></a>00889     <span class="keywordflow">return</span> innerProd;
<a name="l00890"></a>00890 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa4b77089145184d990848cd66993aa8b"></a><!-- doxytag: member="QuEST_cpu.c::statevec_cloneQureg" ref="aa4b77089145184d990848cd66993aa8b" args="(Qureg targetQureg, Qureg copyQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_cloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>copyQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01236">1236</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01236"></a>01236                                                              {
<a name="l01237"></a>01237     
<a name="l01238"></a>01238     <span class="comment">// registers are equal sized, so nodes hold the same state-vector partitions</span>
<a name="l01239"></a>01239     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01240"></a>01240     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242     <span class="comment">// dimension of the state vector</span>
<a name="l01243"></a>01243     stateVecSize = targetQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01246"></a>01246     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *targetStateVecReal = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01247"></a>01247     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *targetStateVecImag = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01248"></a>01248     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *copyStateVecReal = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01249"></a>01249     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *copyStateVecImag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01250"></a>01250 
<a name="l01251"></a>01251     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01252"></a>01252 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01253"></a>01253 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01254"></a>01254 <span class="preprocessor">    default  (none) \</span>
<a name="l01255"></a>01255 <span class="preprocessor">    shared   (stateVecSize, targetStateVecReal, targetStateVecImag, copyStateVecReal, copyStateVecImag) \</span>
<a name="l01256"></a>01256 <span class="preprocessor">    private  (index) </span>
<a name="l01257"></a>01257 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01258"></a>01258 <span class="preprocessor"></span>    {
<a name="l01259"></a>01259 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01260"></a>01260 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01261"></a>01261 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01262"></a>01262 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01263"></a>01263             targetStateVecReal[index] = copyStateVecReal[index];
<a name="l01264"></a>01264             targetStateVecImag[index] = copyStateVecImag[index];
<a name="l01265"></a>01265         }
<a name="l01266"></a>01266     }
<a name="l01267"></a>01267 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acd82c94cfac89eacb901348ff0d06af8"></a><!-- doxytag: member="QuEST_cpu.c::statevec_collapseToKnownProbOutcomeDistributedRenorm" ref="acd82c94cfac89eacb901348ff0d06af8" args="(Qureg qureg, const int measureQubit, const qreal totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qreal&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02953">2953</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">statevec_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02954"></a>02954 {
<a name="l02955"></a>02955     <span class="comment">// ----- temp variables</span>
<a name="l02956"></a>02956     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l02957"></a>02957     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02958"></a>02958 
<a name="l02959"></a>02959     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> renorm=1/sqrt(totalProbability);
<a name="l02960"></a>02960 
<a name="l02961"></a>02961     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02962"></a>02962     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02963"></a>02963 
<a name="l02964"></a>02964 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02965"></a>02965 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02966"></a>02966 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l02967"></a>02967 <span class="preprocessor">    private   (thisTask)</span>
<a name="l02968"></a>02968 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02969"></a>02969 <span class="preprocessor"></span>    {
<a name="l02970"></a>02970 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02971"></a>02971 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02972"></a>02972 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02973"></a>02973 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02974"></a>02974             stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;
<a name="l02975"></a>02975             stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;
<a name="l02976"></a>02976         }
<a name="l02977"></a>02977     }
<a name="l02978"></a>02978 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab02bce0ebbb8f624e8ced8b09b99cdef"></a><!-- doxytag: member="QuEST_cpu.c::statevec_collapseToKnownProbOutcomeLocal" ref="ab02bce0ebbb8f624e8ced8b09b99cdef" args="(Qureg qureg, int measureQubit, int outcome, qreal totalProbability)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>totalProbability</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p>Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalProbability</em>&nbsp;</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>outcome</em>&nbsp;</td><td>to measure the probability of and set the state to -- either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02871">2871</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">statevec_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02872"></a>02872 {
<a name="l02873"></a>02873     <span class="comment">// ----- sizes</span>
<a name="l02874"></a>02874     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span>
<a name="l02875"></a>02875          sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l02876"></a>02876     <span class="comment">// ----- indices</span>
<a name="l02877"></a>02877     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span>
<a name="l02878"></a>02878          index;                                               <span class="comment">// current index for first half block</span>
<a name="l02879"></a>02879     <span class="comment">// ----- measured probability</span>
<a name="l02880"></a>02880     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   renorm;                                            <span class="comment">// probability (returned) value</span>
<a name="l02881"></a>02881     <span class="comment">// ----- temp variables</span>
<a name="l02882"></a>02882     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l02883"></a>02883     <span class="comment">// (good for shared memory parallelism)</span>
<a name="l02884"></a>02884     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02885"></a>02885 
<a name="l02886"></a>02886     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02887"></a>02887     <span class="comment">//            dimensions                                            //</span>
<a name="l02888"></a>02888     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02889"></a>02889     sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l02890"></a>02890     <span class="comment">// and then the number to skip</span>
<a name="l02891"></a>02891     sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l02892"></a>02892 
<a name="l02893"></a>02893     renorm=1/sqrt(totalProbability);
<a name="l02894"></a>02894     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02895"></a>02895     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02896"></a>02896 
<a name="l02897"></a>02897 
<a name="l02898"></a>02898 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02899"></a>02899 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02900"></a>02900 <span class="preprocessor">    default (none) \</span>
<a name="l02901"></a>02901 <span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span>
<a name="l02902"></a>02902 <span class="preprocessor">    private   (thisTask,thisBlock,index)</span>
<a name="l02903"></a>02903 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02904"></a>02904 <span class="preprocessor"></span>    {
<a name="l02905"></a>02905         <span class="keywordflow">if</span> (outcome==0){
<a name="l02906"></a>02906             <span class="comment">// measure qubit is 0</span>
<a name="l02907"></a>02907 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02908"></a>02908 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02909"></a>02909 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02910"></a>02910 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02911"></a>02911                 thisBlock = thisTask / sizeHalfBlock;
<a name="l02912"></a>02912                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02913"></a>02913                 stateVecReal[index]=stateVecReal[index]*renorm;
<a name="l02914"></a>02914                 stateVecImag[index]=stateVecImag[index]*renorm;
<a name="l02915"></a>02915 
<a name="l02916"></a>02916                 stateVecReal[index+sizeHalfBlock]=0;
<a name="l02917"></a>02917                 stateVecImag[index+sizeHalfBlock]=0;
<a name="l02918"></a>02918             }
<a name="l02919"></a>02919         } <span class="keywordflow">else</span> {
<a name="l02920"></a>02920             <span class="comment">// measure qubit is 1</span>
<a name="l02921"></a>02921 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02922"></a>02922 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02923"></a>02923 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02924"></a>02924 <span class="preprocessor"></span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02925"></a>02925                 thisBlock = thisTask / sizeHalfBlock;
<a name="l02926"></a>02926                 index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02927"></a>02927                 stateVecReal[index]=0;
<a name="l02928"></a>02928                 stateVecImag[index]=0;
<a name="l02929"></a>02929 
<a name="l02930"></a>02930                 stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;
<a name="l02931"></a>02931                 stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;
<a name="l02932"></a>02932             }
<a name="l02933"></a>02933         }
<a name="l02934"></a>02934     }
<a name="l02935"></a>02935 
<a name="l02936"></a>02936 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ea68e9132ed9db9c242353a33dba2f0"></a><!-- doxytag: member="QuEST_cpu.c::statevec_collapseToOutcomeDistributedSetZero" ref="a7ea68e9132ed9db9c242353a33dba2f0" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set all amplitudes in one chunk to 0. </p>
<p>Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that a zero have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles setting amplitudes to 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02992">2992</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">statevec_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02993"></a>02993 {
<a name="l02994"></a>02994     <span class="comment">// ----- temp variables</span>
<a name="l02995"></a>02995     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l02996"></a>02996     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02997"></a>02997 
<a name="l02998"></a>02998     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02999"></a>02999     <span class="comment">//            find probability                                      //</span>
<a name="l03000"></a>03000     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l03001"></a>03001 
<a name="l03002"></a>03002     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l03003"></a>03003     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l03004"></a>03004 
<a name="l03005"></a>03005 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l03006"></a>03006 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l03007"></a>03007 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l03008"></a>03008 <span class="preprocessor">    private   (thisTask)</span>
<a name="l03009"></a>03009 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l03010"></a>03010 <span class="preprocessor"></span>    {
<a name="l03011"></a>03011 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l03012"></a>03012 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l03013"></a>03013 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l03014"></a>03014 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l03015"></a>03015             stateVecReal[thisTask] = 0;
<a name="l03016"></a>03016             stateVecImag[thisTask] = 0;
<a name="l03017"></a>03017         }
<a name="l03018"></a>03018     }
<a name="l03019"></a>03019 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aede1ba1fc2d189001745ee6f76f8caa7"></a><!-- doxytag: member="QuEST_cpu.c::statevec_compactUnitaryDistributed" ref="aede1ba1fc2d189001745ee6f76f8caa7" args="(Qureg qureg, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01547">1547</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01552"></a>01552 {
<a name="l01553"></a>01553 
<a name="l01554"></a>01554     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01555"></a>01555     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01556"></a>01556     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01557"></a>01557 
<a name="l01558"></a>01558     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01559"></a>01559     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01560"></a>01560     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l01561"></a>01561     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l01562"></a>01562     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01565"></a>01565 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01566"></a>01566 <span class="preprocessor">    default  (none) \</span>
<a name="l01567"></a>01567 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01568"></a>01568 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l01569"></a>01569 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01570"></a>01570 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01571"></a>01571 <span class="preprocessor"></span>    {
<a name="l01572"></a>01572 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01573"></a>01573 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01574"></a>01574 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01575"></a>01575 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01576"></a>01576             <span class="comment">// store current state vector values in temp variables</span>
<a name="l01577"></a>01577             stateRealUp = stateVecRealUp[thisTask];
<a name="l01578"></a>01578             stateImagUp = stateVecImagUp[thisTask];
<a name="l01579"></a>01579 
<a name="l01580"></a>01580             stateRealLo = stateVecRealLo[thisTask];
<a name="l01581"></a>01581             stateImagLo = stateVecImagLo[thisTask];
<a name="l01582"></a>01582 
<a name="l01583"></a>01583             <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l01584"></a>01584             stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l01585"></a>01585             stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l01586"></a>01586         }
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5865e66a6e0993ae17d400c9ee0eb43"></a><!-- doxytag: member="QuEST_cpu.c::statevec_compactUnitaryLocal" ref="aa5865e66a6e0993ae17d400c9ee0eb43" args="(Qureg qureg, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01418">1418</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01419"></a>01419 {
<a name="l01420"></a>01420     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01421"></a>01421     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01422"></a>01422          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01423"></a>01423 
<a name="l01424"></a>01424     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01425"></a>01425     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01426"></a>01426     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l01427"></a>01427 
<a name="l01428"></a>01428     <span class="comment">// set dimensions</span>
<a name="l01429"></a>01429     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01430"></a>01430     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01431"></a>01431 
<a name="l01432"></a>01432     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l01433"></a>01433     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01434"></a>01434     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01435"></a>01435     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> alphaImag=alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l01436"></a>01436     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> betaImag=beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l01437"></a>01437 
<a name="l01438"></a>01438 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01439"></a>01439 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01440"></a>01440 <span class="preprocessor">    default  (none) \</span>
<a name="l01441"></a>01441 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l01442"></a>01442 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01443"></a>01443 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01444"></a>01444 <span class="preprocessor"></span>    {
<a name="l01445"></a>01445 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01446"></a>01446 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01447"></a>01447 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01448"></a>01448 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01449"></a>01449 
<a name="l01450"></a>01450             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01451"></a>01451             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01452"></a>01452             indexLo     = indexUp + sizeHalfBlock;
<a name="l01453"></a>01453 
<a name="l01454"></a>01454             <span class="comment">// store current state vector values in temp variables</span>
<a name="l01455"></a>01455             stateRealUp = stateVecReal[indexUp];
<a name="l01456"></a>01456             stateImagUp = stateVecImag[indexUp];
<a name="l01457"></a>01457 
<a name="l01458"></a>01458             stateRealLo = stateVecReal[indexLo];
<a name="l01459"></a>01459             stateImagLo = stateVecImag[indexLo];
<a name="l01460"></a>01460 
<a name="l01461"></a>01461             <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l01462"></a>01462             stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l01463"></a>01463                 - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l01464"></a>01464             stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l01465"></a>01465                 - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l01466"></a>01466 
<a name="l01467"></a>01467             <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l01468"></a>01468             stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l01469"></a>01469                 + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l01470"></a>01470             stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l01471"></a>01471                 + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l01472"></a>01472         } 
<a name="l01473"></a>01473     }
<a name="l01474"></a>01474 
<a name="l01475"></a>01475 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6cecbad32a03416138b321cdc1a2c33"></a><!-- doxytag: member="QuEST_cpu.c::statevec_compareStates" ref="ae6cecbad32a03416138b321cdc1a2c33" args="(Qureg mq1, Qureg mq2, qreal precision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>precision</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01405">1405</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01405"></a>01405                                                                  {
<a name="l01406"></a>01406     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> diff;
<a name="l01407"></a>01407     <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01408"></a>01408     
<a name="l01409"></a>01409     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){
<a name="l01410"></a>01410         diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i]);
<a name="l01411"></a>01411         <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l01412"></a>01412         diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i]);
<a name="l01413"></a>01413         <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l01414"></a>01414     }
<a name="l01415"></a>01415     <span class="keywordflow">return</span> 1;
<a name="l01416"></a>01416 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5837db2f736dce21fb28dad168a23130"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledCompactUnitaryDistributed" ref="a5837db2f736dce21fb28dad168a23130" args="(Qureg qureg, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01857">1857</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01862"></a>01862 {
<a name="l01863"></a>01863 
<a name="l01864"></a>01864     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01865"></a>01865     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01866"></a>01866     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01867"></a>01867     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01868"></a>01868     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01869"></a>01869 
<a name="l01870"></a>01870     <span class="keywordtype">int</span> controlBit;
<a name="l01871"></a>01871 
<a name="l01872"></a>01872     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01873"></a>01873     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01874"></a>01874     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l01875"></a>01875     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l01876"></a>01876     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l01877"></a>01877 
<a name="l01878"></a>01878 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01879"></a>01879 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01880"></a>01880 <span class="preprocessor">    default  (none) \</span>
<a name="l01881"></a>01881 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01882"></a>01882 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l01883"></a>01883 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l01884"></a>01884 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01885"></a>01885 <span class="preprocessor"></span>    {
<a name="l01886"></a>01886 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01887"></a>01887 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01888"></a>01888 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01889"></a>01889 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01890"></a>01890             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01891"></a>01891             <span class="keywordflow">if</span> (controlBit){
<a name="l01892"></a>01892                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01893"></a>01893                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01894"></a>01894                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01895"></a>01895 
<a name="l01896"></a>01896                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01897"></a>01897                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01898"></a>01898 
<a name="l01899"></a>01899                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l01900"></a>01900                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;
<a name="l01901"></a>01901                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;
<a name="l01902"></a>01902             }
<a name="l01903"></a>01903         }
<a name="l01904"></a>01904     }
<a name="l01905"></a>01905 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0e5527c6e144fab8062ea5296e8bdf2a"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledCompactUnitaryLocal" ref="a0e5527c6e144fab8062ea5296e8bdf2a" args="(Qureg qureg, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01648">1648</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01650"></a>01650 {
<a name="l01651"></a>01651     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01652"></a>01652     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01653"></a>01653          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01654"></a>01654 
<a name="l01655"></a>01655     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01656"></a>01656     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01657"></a>01657     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l01658"></a>01658     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01659"></a>01659     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01660"></a>01660 
<a name="l01661"></a>01661     <span class="keywordtype">int</span> controlBit;
<a name="l01662"></a>01662 
<a name="l01663"></a>01663     <span class="comment">// set dimensions</span>
<a name="l01664"></a>01664     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01665"></a>01665     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01666"></a>01666 
<a name="l01667"></a>01667     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l01668"></a>01668     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01669"></a>01669     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01670"></a>01670     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> alphaImag=alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l01671"></a>01671     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> betaImag=beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01674"></a>01674 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01675"></a>01675 <span class="preprocessor">    default  (none) \</span>
<a name="l01676"></a>01676 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag) \</span>
<a name="l01677"></a>01677 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l01678"></a>01678 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01679"></a>01679 <span class="preprocessor"></span>    {
<a name="l01680"></a>01680 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01681"></a>01681 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01682"></a>01682 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01683"></a>01683 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01684"></a>01684 
<a name="l01685"></a>01685             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01686"></a>01686             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01687"></a>01687             indexLo     = indexUp + sizeHalfBlock;
<a name="l01688"></a>01688 
<a name="l01689"></a>01689             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l01690"></a>01690             <span class="keywordflow">if</span> (controlBit){
<a name="l01691"></a>01691                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01692"></a>01692                 stateRealUp = stateVecReal[indexUp];
<a name="l01693"></a>01693                 stateImagUp = stateVecImag[indexUp];
<a name="l01694"></a>01694 
<a name="l01695"></a>01695                 stateRealLo = stateVecReal[indexLo];
<a name="l01696"></a>01696                 stateImagLo = stateVecImag[indexLo];
<a name="l01697"></a>01697 
<a name="l01698"></a>01698                 <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span>
<a name="l01699"></a>01699                 stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp 
<a name="l01700"></a>01700                     - betaReal*stateRealLo - betaImag*stateImagLo;
<a name="l01701"></a>01701                 stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp 
<a name="l01702"></a>01702                     - betaReal*stateImagLo + betaImag*stateRealLo;
<a name="l01703"></a>01703 
<a name="l01704"></a>01704                 <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span>
<a name="l01705"></a>01705                 stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp 
<a name="l01706"></a>01706                     + alphaReal*stateRealLo + alphaImag*stateImagLo;
<a name="l01707"></a>01707                 stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp 
<a name="l01708"></a>01708                     + alphaReal*stateImagLo - alphaImag*stateRealLo;
<a name="l01709"></a>01709             }
<a name="l01710"></a>01710         } 
<a name="l01711"></a>01711     }
<a name="l01712"></a>01712 
<a name="l01713"></a>01713 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="afa036cb8b502ef9a0977885ea74e41bc"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledNotDistributed" ref="afa036cb8b502ef9a0977885ea74e41bc" args="(Qureg qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02184">2184</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01015">statevec_controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02187"></a>02187 {
<a name="l02188"></a>02188 
<a name="l02189"></a>02189     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l02190"></a>02190     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02191"></a>02191     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02192"></a>02192     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194     <span class="keywordtype">int</span> controlBit;
<a name="l02195"></a>02195 
<a name="l02196"></a>02196     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;
<a name="l02197"></a>02197     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02198"></a>02198 
<a name="l02199"></a>02199 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02200"></a>02200 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02201"></a>02201 <span class="preprocessor">    default  (none) \</span>
<a name="l02202"></a>02202 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l02203"></a>02203 <span class="preprocessor">    private  (thisTask,controlBit)</span>
<a name="l02204"></a>02204 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02205"></a>02205 <span class="preprocessor"></span>    {
<a name="l02206"></a>02206 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02207"></a>02207 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02208"></a>02208 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02209"></a>02209 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02210"></a>02210             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l02211"></a>02211             <span class="keywordflow">if</span> (controlBit){
<a name="l02212"></a>02212                 stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l02213"></a>02213                 stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l02214"></a>02214             }
<a name="l02215"></a>02215         }
<a name="l02216"></a>02216     }
<a name="l02217"></a>02217 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11c9685e4ad1f44cfd6243e0c4435893"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledNotLocal" ref="a11c9685e4ad1f44cfd6243e0c4435893" args="(Qureg qureg, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02121">2121</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01015">statevec_controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02122"></a>02122 {
<a name="l02123"></a>02123     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l02124"></a>02124     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l02125"></a>02125          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l02126"></a>02126 
<a name="l02127"></a>02127     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateImagUp;
<a name="l02128"></a>02128     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l02129"></a>02129     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02130"></a>02130     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02131"></a>02131     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02132"></a>02132 
<a name="l02133"></a>02133     <span class="keywordtype">int</span> controlBit;
<a name="l02134"></a>02134 
<a name="l02135"></a>02135     <span class="comment">// set dimensions</span>
<a name="l02136"></a>02136     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l02137"></a>02137     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l02138"></a>02138 
<a name="l02139"></a>02139     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l02140"></a>02140     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02141"></a>02141     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02142"></a>02142 
<a name="l02143"></a>02143 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02144"></a>02144 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02145"></a>02145 <span class="preprocessor">    default  (none) \</span>
<a name="l02146"></a>02146 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l02147"></a>02147 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l02148"></a>02148 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02149"></a>02149 <span class="preprocessor"></span>    {
<a name="l02150"></a>02150 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02151"></a>02151 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02152"></a>02152 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02153"></a>02153 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02154"></a>02154             thisBlock   = thisTask / sizeHalfBlock;
<a name="l02155"></a>02155             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02156"></a>02156             indexLo     = indexUp + sizeHalfBlock;
<a name="l02157"></a>02157 
<a name="l02158"></a>02158             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l02159"></a>02159             <span class="keywordflow">if</span> (controlBit){
<a name="l02160"></a>02160                 stateRealUp = stateVecReal[indexUp];
<a name="l02161"></a>02161                 stateImagUp = stateVecImag[indexUp];
<a name="l02162"></a>02162 
<a name="l02163"></a>02163                 stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l02164"></a>02164                 stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l02165"></a>02165 
<a name="l02166"></a>02166                 stateVecReal[indexLo] = stateRealUp;
<a name="l02167"></a>02167                 stateVecImag[indexLo] = stateImagUp;
<a name="l02168"></a>02168             }
<a name="l02169"></a>02169         } 
<a name="l02170"></a>02170     }
<a name="l02171"></a>02171 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a85014e8266bebf037bc2d66f80ca5936"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledPauliYDistributed" ref="a85014e8266bebf037bc2d66f80ca5936" args="(Qureg qureg, const int controlQubit, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, const int conjFac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>conjFac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02366">2366</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01094">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01127">statevec_controlledPauliYConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02369"></a>02369 {
<a name="l02370"></a>02370 
<a name="l02371"></a>02371     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l02372"></a>02372     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02373"></a>02373     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02374"></a>02374     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02375"></a>02375 
<a name="l02376"></a>02376     <span class="keywordtype">int</span> controlBit;
<a name="l02377"></a>02377 
<a name="l02378"></a>02378     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;
<a name="l02379"></a>02379     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02380"></a>02380 
<a name="l02381"></a>02381 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02382"></a>02382 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02383"></a>02383 <span class="preprocessor">    default  (none) \</span>
<a name="l02384"></a>02384 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l02385"></a>02385 <span class="preprocessor">    private  (thisTask,controlBit)</span>
<a name="l02386"></a>02386 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02387"></a>02387 <span class="preprocessor"></span>    {
<a name="l02388"></a>02388 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02389"></a>02389 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02390"></a>02390 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02391"></a>02391 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02392"></a>02392             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l02393"></a>02393             <span class="keywordflow">if</span> (controlBit){
<a name="l02394"></a>02394                 stateVecRealOut[thisTask] = conjFac * stateVecRealIn[thisTask];
<a name="l02395"></a>02395                 stateVecImagOut[thisTask] = conjFac * stateVecImagIn[thisTask];
<a name="l02396"></a>02396             }
<a name="l02397"></a>02397         }
<a name="l02398"></a>02398     }
<a name="l02399"></a>02399 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9028deac63419d71d523f73229a7bd84"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledPauliYLocal" ref="a9028deac63419d71d523f73229a7bd84" args="(Qureg qureg, const int controlQubit, const int targetQubit, const int conjFac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>conjFac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02313">2313</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01094">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01127">statevec_controlledPauliYConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02314"></a>02314 {
<a name="l02315"></a>02315     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l02316"></a>02316     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l02317"></a>02317          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l02318"></a>02318 
<a name="l02319"></a>02319     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateImagUp;
<a name="l02320"></a>02320     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l02321"></a>02321     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02322"></a>02322     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02323"></a>02323     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02324"></a>02324 
<a name="l02325"></a>02325     <span class="keywordtype">int</span> controlBit;
<a name="l02326"></a>02326 
<a name="l02327"></a>02327     <span class="comment">// set dimensions</span>
<a name="l02328"></a>02328     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l02329"></a>02329     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l02330"></a>02330 
<a name="l02331"></a>02331     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l02332"></a>02332     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02333"></a>02333     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02334"></a>02334 
<a name="l02335"></a>02335 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02336"></a>02336 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02337"></a>02337 <span class="preprocessor">    default  (none) \</span>
<a name="l02338"></a>02338 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l02339"></a>02339 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit) </span>
<a name="l02340"></a>02340 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02341"></a>02341 <span class="preprocessor"></span>    {
<a name="l02342"></a>02342 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02343"></a>02343 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02344"></a>02344 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02345"></a>02345 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02346"></a>02346             thisBlock   = thisTask / sizeHalfBlock;
<a name="l02347"></a>02347             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02348"></a>02348             indexLo     = indexUp + sizeHalfBlock;
<a name="l02349"></a>02349 
<a name="l02350"></a>02350             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);
<a name="l02351"></a>02351             <span class="keywordflow">if</span> (controlBit){
<a name="l02352"></a>02352                 stateRealUp = stateVecReal[indexUp];
<a name="l02353"></a>02353                 stateImagUp = stateVecImag[indexUp];
<a name="l02354"></a>02354 
<a name="l02355"></a>02355                 <span class="comment">// update under +-{{0, -i}, {i, 0}}</span>
<a name="l02356"></a>02356                 stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];
<a name="l02357"></a>02357                 stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];
<a name="l02358"></a>02358                 stateVecReal[indexLo] = conjFac * -stateImagUp;
<a name="l02359"></a>02359                 stateVecImag[indexLo] = conjFac * stateRealUp;
<a name="l02360"></a>02360             }
<a name="l02361"></a>02361         } 
<a name="l02362"></a>02362     }
<a name="l02363"></a>02363 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c0067cb9f243ead20de7392aea328bc"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledPhaseFlip" ref="a7c0067cb9f243ead20de7392aea328bc" args="(Qureg qureg, const int idQubit1, const int idQubit2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02789">2789</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02790"></a>02790 {
<a name="l02791"></a>02791     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02792"></a>02792     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02793"></a>02793     <span class="keywordtype">int</span> bit1, bit2;
<a name="l02794"></a>02794 
<a name="l02795"></a>02795     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02796"></a>02796     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02797"></a>02797     
<a name="l02798"></a>02798     <span class="comment">// dimension of the state vector</span>
<a name="l02799"></a>02799     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02800"></a>02800     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02801"></a>02801     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02802"></a>02802 
<a name="l02803"></a>02803 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02804"></a>02804 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02805"></a>02805 <span class="preprocessor">    default  (none)              \</span>
<a name="l02806"></a>02806 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02807"></a>02807 <span class="preprocessor">    private  (index,bit1,bit2)             \</span>
<a name="l02808"></a>02808 <span class="preprocessor">    schedule (static)</span>
<a name="l02809"></a>02809 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02810"></a>02810 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02811"></a>02811         bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l02812"></a>02812         bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l02813"></a>02813         <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l02814"></a>02814             stateVecReal [index] = - stateVecReal [index];
<a name="l02815"></a>02815             stateVecImag [index] = - stateVecImag [index];
<a name="l02816"></a>02816         }
<a name="l02817"></a>02817     }
<a name="l02818"></a>02818 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adeb715f3f2c167f9bfbe92b75f5988ce"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledPhaseShift" ref="adeb715f3f2c167f9bfbe92b75f5988ce" args="(Qureg qureg, const int idQubit1, const int idQubit2, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02554">2554</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02555"></a>02555 {
<a name="l02556"></a>02556     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02557"></a>02557     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02558"></a>02558     <span class="keywordtype">int</span> bit1, bit2;
<a name="l02559"></a>02559     
<a name="l02560"></a>02560     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02561"></a>02561     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02562"></a>02562 
<a name="l02563"></a>02563     <span class="comment">// dimension of the state vector</span>
<a name="l02564"></a>02564     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02565"></a>02565     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02566"></a>02566     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02567"></a>02567     
<a name="l02568"></a>02568     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02569"></a>02569     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = cos(angle);
<a name="l02570"></a>02570     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = sin(angle);
<a name="l02571"></a>02571 
<a name="l02572"></a>02572 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02573"></a>02573 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02574"></a>02574 <span class="preprocessor">    default  (none)              \</span>
<a name="l02575"></a>02575 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02576"></a>02576 <span class="preprocessor">    private  (index,bit1,bit2,stateRealLo,stateImagLo)             \</span>
<a name="l02577"></a>02577 <span class="preprocessor">    schedule (static)</span>
<a name="l02578"></a>02578 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02579"></a>02579 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02580"></a>02580         bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l02581"></a>02581         bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l02582"></a>02582         <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l02583"></a>02583             
<a name="l02584"></a>02584             stateRealLo = stateVecReal[index];
<a name="l02585"></a>02585             stateImagLo = stateVecImag[index];
<a name="l02586"></a>02586             
<a name="l02587"></a>02587             stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02588"></a>02588             stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02589"></a>02589         }
<a name="l02590"></a>02590     }
<a name="l02591"></a>02591 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4f77ef0be5137ed64321c2d6d14d8035"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledUnitaryDistributed" ref="a4f77ef0be5137ed64321c2d6d14d8035" args="(Qureg qureg, const int controlQubit, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where the control qubit is one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01920">1920</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00909">statevec_controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01925"></a>01925 {
<a name="l01926"></a>01926 
<a name="l01927"></a>01927     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01928"></a>01928     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01929"></a>01929     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01930"></a>01930     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01931"></a>01931     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01932"></a>01932 
<a name="l01933"></a>01933     <span class="keywordtype">int</span> controlBit;
<a name="l01934"></a>01934 
<a name="l01935"></a>01935     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01936"></a>01936     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01937"></a>01937     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l01938"></a>01938     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l01939"></a>01939     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l01940"></a>01940 
<a name="l01941"></a>01941 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01942"></a>01942 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01943"></a>01943 <span class="preprocessor">    default  (none) \</span>
<a name="l01944"></a>01944 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01945"></a>01945 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag) \</span>
<a name="l01946"></a>01946 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span>
<a name="l01947"></a>01947 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01948"></a>01948 <span class="preprocessor"></span>    {
<a name="l01949"></a>01949 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01950"></a>01950 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01951"></a>01951 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01952"></a>01952 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01953"></a>01953             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);
<a name="l01954"></a>01954             <span class="keywordflow">if</span> (controlBit){
<a name="l01955"></a>01955                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01956"></a>01956                 stateRealUp = stateVecRealUp[thisTask];
<a name="l01957"></a>01957                 stateImagUp = stateVecImagUp[thisTask];
<a name="l01958"></a>01958 
<a name="l01959"></a>01959                 stateRealLo = stateVecRealLo[thisTask];
<a name="l01960"></a>01960                 stateImagLo = stateVecImagLo[thisTask];
<a name="l01961"></a>01961 
<a name="l01962"></a>01962                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01963"></a>01963                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01964"></a>01964                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01965"></a>01965                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01966"></a>01966             }
<a name="l01967"></a>01967         }
<a name="l01968"></a>01968     }
<a name="l01969"></a>01969 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac0c120ac374b402c576c4b38bcda9992"></a><!-- doxytag: member="QuEST_cpu.c::statevec_controlledUnitaryLocal" ref="ac0c120ac374b402c576c4b38bcda9992" args="(Qureg qureg, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01778">1778</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00909">statevec_controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01780"></a>01780 {
<a name="l01781"></a>01781     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01782"></a>01782     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01783"></a>01783          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01784"></a>01784 
<a name="l01785"></a>01785     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01786"></a>01786     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01787"></a>01787     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l01788"></a>01788     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01789"></a>01789     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01790"></a>01790 
<a name="l01791"></a>01791     <span class="keywordtype">int</span> controlBit;
<a name="l01792"></a>01792 
<a name="l01793"></a>01793     <span class="comment">// set dimensions</span>
<a name="l01794"></a>01794     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01795"></a>01795     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01796"></a>01796 
<a name="l01797"></a>01797     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l01798"></a>01798     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01799"></a>01799     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01800"></a>01800 
<a name="l01801"></a>01801 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01802"></a>01802 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01803"></a>01803 <span class="preprocessor">    default  (none) \</span>
<a name="l01804"></a>01804 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l01805"></a>01805 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit) </span>
<a name="l01806"></a>01806 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01807"></a>01807 <span class="preprocessor"></span>    {
<a name="l01808"></a>01808 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01809"></a>01809 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01810"></a>01810 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01811"></a>01811 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01812"></a>01812 
<a name="l01813"></a>01813             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01814"></a>01814             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01815"></a>01815             indexLo     = indexUp + sizeHalfBlock;
<a name="l01816"></a>01816 
<a name="l01817"></a>01817             controlBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);
<a name="l01818"></a>01818             <span class="keywordflow">if</span> (controlBit){
<a name="l01819"></a>01819                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01820"></a>01820                 stateRealUp = stateVecReal[indexUp];
<a name="l01821"></a>01821                 stateImagUp = stateVecImag[indexUp];
<a name="l01822"></a>01822 
<a name="l01823"></a>01823                 stateRealLo = stateVecReal[indexLo];
<a name="l01824"></a>01824                 stateImagLo = stateVecImag[indexLo];
<a name="l01825"></a>01825 
<a name="l01826"></a>01826 
<a name="l01827"></a>01827                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l01828"></a>01828                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01829"></a>01829                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01830"></a>01830                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01831"></a>01831                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01832"></a>01832 
<a name="l01833"></a>01833                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l01834"></a>01834                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01835"></a>01835                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01836"></a>01836                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01837"></a>01837                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01838"></a>01838             }
<a name="l01839"></a>01839         } 
<a name="l01840"></a>01840     }
<a name="l01841"></a>01841 
<a name="l01842"></a>01842 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a365bbb1b80cb00405c8bf1a4fa1ea8e5"></a><!-- doxytag: member="QuEST_cpu.c::statevec_createQureg" ref="a365bbb1b80cb00405c8bf1a4fa1ea8e5" args="(Qureg *qureg, int numQubits, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_createQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01058">1058</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00084">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00093">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00119">QuESTEnv::rank</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01059"></a>01059 {
<a name="l01060"></a>01060     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l01061"></a>01061     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real)));
<a name="l01064"></a>01064     qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag)));
<a name="l01065"></a>01065     <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l01066"></a>01066         qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real)));
<a name="l01067"></a>01067         qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag)));
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070     <span class="keywordflow">if</span> ( (!(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag))
<a name="l01071"></a>01071             &amp;&amp; numAmpsPerRank ) {
<a name="l01072"></a>01072         printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l01073"></a>01073         exit (EXIT_FAILURE);
<a name="l01074"></a>01074     }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076     <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag))
<a name="l01077"></a>01077             &amp;&amp; numAmpsPerRank ) {
<a name="l01078"></a>01078         printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l01079"></a>01079         exit (EXIT_FAILURE);
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082     qureg-&gt;<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218" title="Number of qubits in the state-vector - this is double the number represented for...">numQubitsInStateVec</a> = numQubits;
<a name="l01083"></a>01083     qureg-&gt;<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4" title="Total number of amplitudes, which are possibly distributed among machines.">numAmpsTotal</a> = numAmps;
<a name="l01084"></a>01084     qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a> = numAmpsPerRank;
<a name="l01085"></a>01085     qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;
<a name="l01086"></a>01086     qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l01087"></a>01087     qureg-&gt;<a class="code" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79" title="Whether this instance is a density-state representation.">isDensityMatrix</a> = 0;
<a name="l01088"></a>01088 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2a52ad9f9ad9b2fd6a76f6d433b3b217"></a><!-- doxytag: member="QuEST_cpu.c::statevec_destroyQureg" ref="a2a52ad9f9ad9b2fd6a76f6d433b3b217" args="(Qureg qureg, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01090">1090</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01090"></a>01090                                                      {
<a name="l01091"></a>01091     
<a name="l01092"></a>01092     free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real);
<a name="l01093"></a>01093     free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag);
<a name="l01094"></a>01094     <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l01095"></a>01095         free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real);
<a name="l01096"></a>01096         free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag);
<a name="l01097"></a>01097     }    
<a name="l01098"></a>01098 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa2e838d65b214d266cd51ad0091ad827"></a><!-- doxytag: member="QuEST_cpu.c::statevec_findProbabilityOfZeroDistributed" ref="aa2e838d65b214d266cd51ad0091ad827" args="(Qureg qureg, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p>Size of regions to skip is a multiple of chunkSize. The results are communicated and aggregated by the caller</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02749">2749</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">statevec_calcProbOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02751"></a>02751 {
<a name="l02752"></a>02752     <span class="comment">// ----- measured probability</span>
<a name="l02753"></a>02753     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span>
<a name="l02754"></a>02754     <span class="comment">// ----- temp variables</span>
<a name="l02755"></a>02755     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span>
<a name="l02756"></a>02756     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02757"></a>02757 
<a name="l02758"></a>02758     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02759"></a>02759     <span class="comment">//            find probability                                      //</span>
<a name="l02760"></a>02760     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02761"></a>02761 
<a name="l02762"></a>02762     <span class="comment">// initialise returned value</span>
<a name="l02763"></a>02763     totalProbability = 0.0;
<a name="l02764"></a>02764 
<a name="l02765"></a>02765     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02766"></a>02766     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02767"></a>02767 
<a name="l02768"></a>02768 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02769"></a>02769 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02770"></a>02770 <span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span>
<a name="l02771"></a>02771 <span class="preprocessor">    private   (thisTask) \</span>
<a name="l02772"></a>02772 <span class="preprocessor">    reduction ( +:totalProbability )</span>
<a name="l02773"></a>02773 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02774"></a>02774 <span class="preprocessor"></span>    {
<a name="l02775"></a>02775 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02776"></a>02776 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02777"></a>02777 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02778"></a>02778 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02779"></a>02779             totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]
<a name="l02780"></a>02780                 + stateVecImag[thisTask]*stateVecImag[thisTask];
<a name="l02781"></a>02781         }
<a name="l02782"></a>02782     }
<a name="l02783"></a>02783 
<a name="l02784"></a>02784     <span class="keywordflow">return</span> totalProbability;
<a name="l02785"></a>02785 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afa06d0143cea46f1e425c61ac6f6f9a2"></a><!-- doxytag: member="QuEST_cpu.c::statevec_findProbabilityOfZeroLocal" ref="afa06d0143cea46f1e425c61ac6f6f9a2" args="(Qureg qureg, const int measureQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p>Size of regions to skip is less than the size of one chunk.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>measureQubit</em>&nbsp;</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02692">2692</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">statevec_calcProbOfOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02694"></a>02694 {
<a name="l02695"></a>02695     <span class="comment">// ----- sizes</span>
<a name="l02696"></a>02696     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span>
<a name="l02697"></a>02697          sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span>
<a name="l02698"></a>02698     <span class="comment">// ----- indices</span>
<a name="l02699"></a>02699     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span>
<a name="l02700"></a>02700          index;                                               <span class="comment">// current index for first half block</span>
<a name="l02701"></a>02701     <span class="comment">// ----- measured probability</span>
<a name="l02702"></a>02702     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span>
<a name="l02703"></a>02703     <span class="comment">// ----- temp variables</span>
<a name="l02704"></a>02704     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   
<a name="l02705"></a>02705     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02706"></a>02706 
<a name="l02707"></a>02707     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02708"></a>02708     <span class="comment">//            dimensions                                            //</span>
<a name="l02709"></a>02709     <span class="comment">// ---------------------------------------------------------------- //</span>
<a name="l02710"></a>02710     sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span>
<a name="l02711"></a>02711     <span class="comment">// and then the number to skip</span>
<a name="l02712"></a>02712     sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span>
<a name="l02713"></a>02713 
<a name="l02714"></a>02714     <span class="comment">// initialise returned value</span>
<a name="l02715"></a>02715     totalProbability = 0.0;
<a name="l02716"></a>02716 
<a name="l02717"></a>02717     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02718"></a>02718     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02719"></a>02719 
<a name="l02720"></a>02720 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02721"></a>02721 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02722"></a>02722 <span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l02723"></a>02723 <span class="preprocessor">    private   (thisTask,thisBlock,index) \</span>
<a name="l02724"></a>02724 <span class="preprocessor">    reduction ( +:totalProbability )</span>
<a name="l02725"></a>02725 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l02726"></a>02726 <span class="preprocessor"></span>    {
<a name="l02727"></a>02727 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02728"></a>02728 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l02729"></a>02729 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02730"></a>02730 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02731"></a>02731             thisBlock = thisTask / sizeHalfBlock;
<a name="l02732"></a>02732             index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02733"></a>02733 
<a name="l02734"></a>02734             totalProbability += stateVecReal[index]*stateVecReal[index]
<a name="l02735"></a>02735                 + stateVecImag[index]*stateVecImag[index];
<a name="l02736"></a>02736         }
<a name="l02737"></a>02737     }
<a name="l02738"></a>02738     <span class="keywordflow">return</span> totalProbability;
<a name="l02739"></a>02739 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6870e335f2a78b724f603cd9f820b9ab"></a><!-- doxytag: member="QuEST_cpu.c::statevec_getEnvironmentString" ref="a6870e335f2a78b724f603cd9f820b9ab" args="(QuESTEnv env, Qureg qureg, char str[200])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_getEnvironmentString </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>str</em>[200]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01124">1124</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01124"></a>01124                                                                             {
<a name="l01125"></a>01125     <span class="keywordtype">int</span> numThreads=1;
<a name="l01126"></a>01126 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01127"></a>01127 <span class="preprocessor"></span>    numThreads=omp_get_max_threads(); 
<a name="l01128"></a>01128 <span class="preprocessor"># endif</span>
<a name="l01129"></a>01129 <span class="preprocessor"></span>    sprintf(str, <span class="stringliteral">&quot;%dqubits_CPU_%dranksx%dthreads&quot;</span>, qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218" title="Number of qubits in the state-vector - this is double the number represented for...">numQubitsInStateVec</a>, env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>, numThreads);
<a name="l01130"></a>01130 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4271beeba4f1bec3556779aab318cdab"></a><!-- doxytag: member="QuEST_cpu.c::statevec_hadamardDistributed" ref="a4271beeba4f1bec3556779aab318cdab" args="(Qureg qureg, const int targetQubit, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02468">2468</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01160">statevec_hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02473"></a>02473 {
<a name="l02474"></a>02474 
<a name="l02475"></a>02475     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l02476"></a>02476     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l02477"></a>02477     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02478"></a>02478 
<a name="l02479"></a>02479     <span class="keywordtype">int</span> sign;
<a name="l02480"></a>02480     <span class="keywordflow">if</span> (updateUpper) sign=1;
<a name="l02481"></a>02481     <span class="keywordflow">else</span> sign=-1;
<a name="l02482"></a>02482 
<a name="l02483"></a>02483     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> recRoot2 = 1.0/sqrt(2);
<a name="l02484"></a>02484 
<a name="l02485"></a>02485     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l02486"></a>02486     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l02487"></a>02487     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02488"></a>02488 
<a name="l02489"></a>02489 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02490"></a>02490 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02491"></a>02491 <span class="preprocessor">    default  (none) \</span>
<a name="l02492"></a>02492 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l02493"></a>02493 <span class="preprocessor">            recRoot2, sign) \</span>
<a name="l02494"></a>02494 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l02495"></a>02495 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02496"></a>02496 <span class="preprocessor"></span>    {
<a name="l02497"></a>02497 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02498"></a>02498 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02499"></a>02499 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02500"></a>02500 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02501"></a>02501             <span class="comment">// store current state vector values in temp variables</span>
<a name="l02502"></a>02502             stateRealUp = stateVecRealUp[thisTask];
<a name="l02503"></a>02503             stateImagUp = stateVecImagUp[thisTask];
<a name="l02504"></a>02504 
<a name="l02505"></a>02505             stateRealLo = stateVecRealLo[thisTask];
<a name="l02506"></a>02506             stateImagLo = stateVecImagLo[thisTask];
<a name="l02507"></a>02507 
<a name="l02508"></a>02508             stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);
<a name="l02509"></a>02509             stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);
<a name="l02510"></a>02510         }
<a name="l02511"></a>02511     }
<a name="l02512"></a>02512 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24f9ade18290c82bbb2c4a706b3d5999"></a><!-- doxytag: member="QuEST_cpu.c::statevec_hadamardLocal" ref="a24f9ade18290c82bbb2c4a706b3d5999" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02407">2407</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01160">statevec_hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02408"></a>02408 {
<a name="l02409"></a>02409     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l02410"></a>02410     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l02411"></a>02411          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l02412"></a>02412 
<a name="l02413"></a>02413     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l02414"></a>02414     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l02415"></a>02415     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02416"></a>02416 
<a name="l02417"></a>02417     <span class="comment">// set dimensions</span>
<a name="l02418"></a>02418     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l02419"></a>02419     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l02420"></a>02420 
<a name="l02421"></a>02421     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l02422"></a>02422     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02423"></a>02423     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02424"></a>02424 
<a name="l02425"></a>02425     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> recRoot2 = 1.0/sqrt(2);
<a name="l02426"></a>02426 
<a name="l02427"></a>02427 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02428"></a>02428 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02429"></a>02429 <span class="preprocessor">    default  (none) \</span>
<a name="l02430"></a>02430 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2) \</span>
<a name="l02431"></a>02431 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l02432"></a>02432 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02433"></a>02433 <span class="preprocessor"></span>    {
<a name="l02434"></a>02434 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02435"></a>02435 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02436"></a>02436 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02437"></a>02437 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02438"></a>02438             thisBlock   = thisTask / sizeHalfBlock;
<a name="l02439"></a>02439             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02440"></a>02440             indexLo     = indexUp + sizeHalfBlock;
<a name="l02441"></a>02441 
<a name="l02442"></a>02442             stateRealUp = stateVecReal[indexUp];
<a name="l02443"></a>02443             stateImagUp = stateVecImag[indexUp];
<a name="l02444"></a>02444 
<a name="l02445"></a>02445             stateRealLo = stateVecReal[indexLo];
<a name="l02446"></a>02446             stateImagLo = stateVecImag[indexLo];
<a name="l02447"></a>02447 
<a name="l02448"></a>02448             stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);
<a name="l02449"></a>02449             stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);
<a name="l02450"></a>02450 
<a name="l02451"></a>02451             stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);
<a name="l02452"></a>02452             stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);
<a name="l02453"></a>02453         } 
<a name="l02454"></a>02454     }
<a name="l02455"></a>02455 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a288dc4b46bdacd69cbf4a6fd070d26a7"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initClassicalState" ref="a288dc4b46bdacd69cbf4a6fd070d26a7" args="(Qureg qureg, long long int stateInd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>stateInd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01200">1200</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01201"></a>01201 {
<a name="l01202"></a>01202     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01203"></a>01203     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205     <span class="comment">// dimension of the state vector</span>
<a name="l01206"></a>01206     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01207"></a>01207 
<a name="l01208"></a>01208     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01209"></a>01209     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01210"></a>01210     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01211"></a>01211 
<a name="l01212"></a>01212     <span class="comment">// initialise the state to vector to all zeros</span>
<a name="l01213"></a>01213 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01214"></a>01214 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01215"></a>01215 <span class="preprocessor">    default  (none) \</span>
<a name="l01216"></a>01216 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l01217"></a>01217 <span class="preprocessor">    private  (index) </span>
<a name="l01218"></a>01218 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01219"></a>01219 <span class="preprocessor"></span>    {
<a name="l01220"></a>01220 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01221"></a>01221 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01222"></a>01222 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01223"></a>01223 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01224"></a>01224             stateVecReal[index] = 0.0;
<a name="l01225"></a>01225             stateVecImag[index] = 0.0;
<a name="l01226"></a>01226         }
<a name="l01227"></a>01227     }
<a name="l01228"></a>01228 
<a name="l01229"></a>01229     <span class="comment">// give the specified classical state prob 1</span>
<a name="l01230"></a>01230     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> == stateInd/stateVecSize){
<a name="l01231"></a>01231         stateVecReal[stateInd % stateVecSize] = 1.0;
<a name="l01232"></a>01232         stateVecImag[stateInd % stateVecSize] = 0.0;
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a482fc361fd5f08075404c72e536316a0"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initPlusState" ref="a482fc361fd5f08075404c72e536316a0" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01168">1168</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01169"></a>01169 {
<a name="l01170"></a>01170     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01171"></a>01171     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01172"></a>01172 
<a name="l01173"></a>01173     <span class="comment">// dimension of the state vector</span>
<a name="l01174"></a>01174     chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01175"></a>01175     stateVecSize = chunkSize*qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01176"></a>01176     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>)stateVecSize);
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01179"></a>01179     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01180"></a>01180     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182     <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span>
<a name="l01183"></a>01183 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01184"></a>01184 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01185"></a>01185 <span class="preprocessor">    default  (none) \</span>
<a name="l01186"></a>01186 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span>
<a name="l01187"></a>01187 <span class="preprocessor">    private  (index) </span>
<a name="l01188"></a>01188 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01189"></a>01189 <span class="preprocessor"></span>    {
<a name="l01190"></a>01190 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01191"></a>01191 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01192"></a>01192 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01193"></a>01193 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01194"></a>01194             stateVecReal[index] = normFactor;
<a name="l01195"></a>01195             stateVecImag[index] = 0.0;
<a name="l01196"></a>01196         }
<a name="l01197"></a>01197     }
<a name="l01198"></a>01198 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a38445cdb2a18671a7c73112ce3337acb"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initStateDebug" ref="a38445cdb2a18671a7c73112ce3337acb" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01321">1321</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01322"></a>01322 {
<a name="l01323"></a>01323     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;
<a name="l01324"></a>01324     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01325"></a>01325     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;
<a name="l01326"></a>01326 
<a name="l01327"></a>01327     <span class="comment">// dimension of the state vector</span>
<a name="l01328"></a>01328     chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01329"></a>01329 
<a name="l01330"></a>01330     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01331"></a>01331     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01332"></a>01332     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01333"></a>01333 
<a name="l01334"></a>01334     indexOffset = chunkSize * qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01337"></a>01337 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01338"></a>01338 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01339"></a>01339 <span class="preprocessor">    default  (none) \</span>
<a name="l01340"></a>01340 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span>
<a name="l01341"></a>01341 <span class="preprocessor">    private  (index) </span>
<a name="l01342"></a>01342 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01343"></a>01343 <span class="preprocessor"></span>    {
<a name="l01344"></a>01344 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01345"></a>01345 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01346"></a>01346 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01347"></a>01347 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01348"></a>01348             stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;
<a name="l01349"></a>01349             stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;
<a name="l01350"></a>01350         }
<a name="l01351"></a>01351     }
<a name="l01352"></a>01352 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05756b45f10135bb2eeb07380f806c20"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initStateFromSingleFile" ref="a05756b45f10135bb2eeb07380f806c20" args="(Qureg *qureg, char filename[200], QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_initStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01355">1355</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01355"></a>01355                                                                                     {
<a name="l01356"></a>01356     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01357"></a>01357     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;
<a name="l01358"></a>01358 
<a name="l01359"></a>01359     chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01360"></a>01360     stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01361"></a>01361 
<a name="l01362"></a>01362     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01363"></a>01363     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01364"></a>01364 
<a name="l01365"></a>01365     FILE *fp;
<a name="l01366"></a>01366     <span class="keywordtype">char</span> line[200];
<a name="l01367"></a>01367 
<a name="l01368"></a>01368     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>); rank++){
<a name="l01369"></a>01369         <span class="keywordflow">if</span> (rank==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l01370"></a>01370             fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l01371"></a>01371             
<a name="l01372"></a>01372             <span class="comment">// indicate file open failure</span>
<a name="l01373"></a>01373             <span class="keywordflow">if</span> (fp == NULL)
<a name="l01374"></a>01374                 <span class="keywordflow">return</span> 0;
<a name="l01375"></a>01375             
<a name="l01376"></a>01376             indexInChunk = 0; totalIndex = 0;
<a name="l01377"></a>01377             <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){
<a name="l01378"></a>01378                 <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&apos;#&apos;</span>){
<a name="l01379"></a>01379                     <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;
<a name="l01380"></a>01380                     <span class="keywordflow">if</span> (chunkId==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l01381"></a>01381 <span class="preprocessor">                        # if QuEST_PREC==1</span>
<a name="l01382"></a>01382 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%f, %f&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01383"></a>01383                                 &amp;(stateVecImag[indexInChunk])); 
<a name="l01384"></a>01384 <span class="preprocessor">                        # elif QuEST_PREC==2                    </span>
<a name="l01385"></a>01385 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01386"></a>01386                                 &amp;(stateVecImag[indexInChunk]));
<a name="l01387"></a>01387 <span class="preprocessor">                        # elif QuEST_PREC==4</span>
<a name="l01388"></a>01388 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%Lf, %Lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01389"></a>01389                                 &amp;(stateVecImag[indexInChunk]));
<a name="l01390"></a>01390 <span class="preprocessor">                        # endif</span>
<a name="l01391"></a>01391 <span class="preprocessor"></span>                        indexInChunk += 1;
<a name="l01392"></a>01392                     }
<a name="l01393"></a>01393                     totalIndex += 1;
<a name="l01394"></a>01394                 }
<a name="l01395"></a>01395             }   
<a name="l01396"></a>01396             fclose(fp);
<a name="l01397"></a>01397         }
<a name="l01398"></a>01398         <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l01399"></a>01399     }
<a name="l01400"></a>01400     
<a name="l01401"></a>01401     <span class="comment">// indicate success</span>
<a name="l01402"></a>01402     <span class="keywordflow">return</span> 1;
<a name="l01403"></a>01403 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a923906770cac0da9e3459bae58de9e64"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initStateOfSingleQubit" ref="a923906770cac0da9e3459bae58de9e64" args="(Qureg *qureg, int qubitId, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qubitId</em>&nbsp;</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01275">1275</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01276"></a>01276 {
<a name="l01277"></a>01277     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01278"></a>01278     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01279"></a>01279     <span class="keywordtype">int</span> bit;
<a name="l01280"></a>01280     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     <span class="comment">// dimension of the state vector</span>
<a name="l01283"></a>01283     chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01284"></a>01284     stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01285"></a>01285     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>)stateVecSize/2.0);
<a name="l01286"></a>01286 
<a name="l01287"></a>01287     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01288"></a>01288     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01289"></a>01289     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01292"></a>01292 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01293"></a>01293 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01294"></a>01294 <span class="preprocessor">    default  (none) \</span>
<a name="l01295"></a>01295 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span>
<a name="l01296"></a>01296 <span class="preprocessor">    private  (index, bit) </span>
<a name="l01297"></a>01297 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01298"></a>01298 <span class="preprocessor"></span>    {
<a name="l01299"></a>01299 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01300"></a>01300 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01302"></a>01302 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01303"></a>01303             bit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubitId, index+chunkId*chunkSize);
<a name="l01304"></a>01304             <span class="keywordflow">if</span> (bit==outcome) {
<a name="l01305"></a>01305                 stateVecReal[index] = normFactor;
<a name="l01306"></a>01306                 stateVecImag[index] = 0.0;
<a name="l01307"></a>01307             } <span class="keywordflow">else</span> {
<a name="l01308"></a>01308                 stateVecReal[index] = 0.0;
<a name="l01309"></a>01309                 stateVecImag[index] = 0.0;
<a name="l01310"></a>01310             }
<a name="l01311"></a>01311         }
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ca0c6ba07ab2b4b437321bf17efc966"></a><!-- doxytag: member="QuEST_cpu.c::statevec_initZeroState" ref="a2ca0c6ba07ab2b4b437321bf17efc966" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initZeroState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01132">1132</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01133"></a>01133 {
<a name="l01134"></a>01134     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01135"></a>01135     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137     <span class="comment">// dimension of the state vector</span>
<a name="l01138"></a>01138     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01139"></a>01139 
<a name="l01140"></a>01140     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01141"></a>01141     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01142"></a>01142     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01143"></a>01143 
<a name="l01144"></a>01144     <span class="comment">// initialise the state-vector to all-zeroes</span>
<a name="l01145"></a>01145 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01146"></a>01146 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01147"></a>01147 <span class="preprocessor">    default  (none) \</span>
<a name="l01148"></a>01148 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l01149"></a>01149 <span class="preprocessor">    private  (index) </span>
<a name="l01150"></a>01150 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01151"></a>01151 <span class="preprocessor"></span>    {
<a name="l01152"></a>01152 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01153"></a>01153 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01154"></a>01154 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01155"></a>01155 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01156"></a>01156             stateVecReal[index] = 0.0;
<a name="l01157"></a>01157             stateVecImag[index] = 0.0;
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159     }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l01162"></a>01162         <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l01163"></a>01163         stateVecReal[0] = 1.0;
<a name="l01164"></a>01164         stateVecImag[0] = 0.0;
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac4ee5979d475e8c729294b8ef7e0270d"></a><!-- doxytag: member="QuEST_cpu.c::statevec_multiControlledPhaseFlip" ref="ac4ee5979d475e8c729294b8ef7e0270d" args="(Qureg qureg, int *controlQubits, int numControlQubits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02820">2820</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02821"></a>02821 {
<a name="l02822"></a>02822     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02823"></a>02823     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02824"></a>02824 
<a name="l02825"></a>02825     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02826"></a>02826     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02827"></a>02827 
<a name="l02828"></a>02828     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l02829"></a>02829     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++)
<a name="l02830"></a>02830         mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l02831"></a>02831 
<a name="l02832"></a>02832     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02833"></a>02833     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02834"></a>02834     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02835"></a>02835 
<a name="l02836"></a>02836 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02837"></a>02837 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02838"></a>02838 <span class="preprocessor">    default  (none)              \</span>
<a name="l02839"></a>02839 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span>
<a name="l02840"></a>02840 <span class="preprocessor">    private  (index)</span>
<a name="l02841"></a>02841 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02842"></a>02842 <span class="preprocessor"></span>    {
<a name="l02843"></a>02843 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02844"></a>02844 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02845"></a>02845 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02846"></a>02846 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02847"></a>02847             <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l02848"></a>02848                 stateVecReal [index] = - stateVecReal [index];
<a name="l02849"></a>02849                 stateVecImag [index] = - stateVecImag [index];
<a name="l02850"></a>02850             }
<a name="l02851"></a>02851         }
<a name="l02852"></a>02852     }
<a name="l02853"></a>02853 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa662796ea6e0f471143c53becae8c12c"></a><!-- doxytag: member="QuEST_cpu.c::statevec_multiControlledPhaseShift" ref="aa662796ea6e0f471143c53becae8c12c" args="(Qureg qureg, int *controlQubits, int numControlQubits, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02593">2593</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02594"></a>02594 {
<a name="l02595"></a>02595     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02596"></a>02596     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02597"></a>02597 
<a name="l02598"></a>02598     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02599"></a>02599     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02600"></a>02600 
<a name="l02601"></a>02601     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l02602"></a>02602     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) 
<a name="l02603"></a>02603         mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l02604"></a>02604 
<a name="l02605"></a>02605     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02606"></a>02606     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02607"></a>02607     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02608"></a>02608     
<a name="l02609"></a>02609     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02610"></a>02610     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = cos(angle);
<a name="l02611"></a>02611     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = sin(angle);
<a name="l02612"></a>02612 
<a name="l02613"></a>02613 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02614"></a>02614 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02615"></a>02615 <span class="preprocessor">    default  (none)              \</span>
<a name="l02616"></a>02616 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask) \</span>
<a name="l02617"></a>02617 <span class="preprocessor">    private  (index, stateRealLo, stateImagLo)</span>
<a name="l02618"></a>02618 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02619"></a>02619 <span class="preprocessor"></span>    {
<a name="l02620"></a>02620 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02621"></a>02621 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02622"></a>02622 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02623"></a>02623 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02624"></a>02624             <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l02625"></a>02625                 
<a name="l02626"></a>02626                 stateRealLo = stateVecReal[index];
<a name="l02627"></a>02627                 stateImagLo = stateVecImag[index];
<a name="l02628"></a>02628             
<a name="l02629"></a>02629                 stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02630"></a>02630                 stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02631"></a>02631             }
<a name="l02632"></a>02632         }
<a name="l02633"></a>02633     }
<a name="l02634"></a>02634 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2e6d75b454747741b2b805bf6b23194c"></a><!-- doxytag: member="QuEST_cpu.c::statevec_multiControlledUnitaryDistributed" ref="a2e6d75b454747741b2b805bf6b23194c" args="(Qureg qureg, const int targetQubit, long long int mask, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p>Only perform the rotation where all the control qubits are 1.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>controlQubit</em>&nbsp;</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot1</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rot2</em>&nbsp;</td><td>rotation angle </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01984">1984</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00948">statevec_multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01991"></a>01991 {
<a name="l01992"></a>01992 
<a name="l01993"></a>01993     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01994"></a>01994     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01995"></a>01995     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01996"></a>01996     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01997"></a>01997     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01998"></a>01998 
<a name="l01999"></a>01999     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l02000"></a>02000     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l02001"></a>02001     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l02002"></a>02002     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l02003"></a>02003     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02004"></a>02004 
<a name="l02005"></a>02005 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02006"></a>02006 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02007"></a>02007 <span class="preprocessor">    default  (none) \</span>
<a name="l02008"></a>02008 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l02009"></a>02009 <span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, mask) \</span>
<a name="l02010"></a>02010 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l02011"></a>02011 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02012"></a>02012 <span class="preprocessor"></span>    {
<a name="l02013"></a>02013 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02014"></a>02014 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02015"></a>02015 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02016"></a>02016 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02017"></a>02017             <span class="keywordflow">if</span> (mask == (mask &amp; (thisTask+chunkId*chunkSize)) ){
<a name="l02018"></a>02018                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l02019"></a>02019                 stateRealUp = stateVecRealUp[thisTask];
<a name="l02020"></a>02020                 stateImagUp = stateVecImagUp[thisTask];
<a name="l02021"></a>02021 
<a name="l02022"></a>02022                 stateRealLo = stateVecRealLo[thisTask];
<a name="l02023"></a>02023                 stateImagLo = stateVecImagLo[thisTask];
<a name="l02024"></a>02024 
<a name="l02025"></a>02025                 stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l02026"></a>02026                     + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l02027"></a>02027                 stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l02028"></a>02028                     + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l02029"></a>02029             }
<a name="l02030"></a>02030         }
<a name="l02031"></a>02031     }
<a name="l02032"></a>02032 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae183f44166ccfd908609c4e2207cc14b"></a><!-- doxytag: member="QuEST_cpu.c::statevec_multiControlledUnitaryLocal" ref="ae183f44166ccfd908609c4e2207cc14b" args="(Qureg qureg, const int targetQubit, long long int mask, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01715">1715</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00948">statevec_multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01717"></a>01717 {
<a name="l01718"></a>01718     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01719"></a>01719     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01720"></a>01720          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01721"></a>01721 
<a name="l01722"></a>01722     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01723"></a>01723     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01724"></a>01724     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l01725"></a>01725     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01726"></a>01726     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01727"></a>01727 
<a name="l01728"></a>01728     <span class="comment">// set dimensions</span>
<a name="l01729"></a>01729     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01730"></a>01730     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01731"></a>01731 
<a name="l01732"></a>01732     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l01733"></a>01733     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01734"></a>01734     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01735"></a>01735 
<a name="l01736"></a>01736 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01737"></a>01737 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01738"></a>01738 <span class="preprocessor">    default  (none) \</span>
<a name="l01739"></a>01739 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, mask) \</span>
<a name="l01740"></a>01740 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01741"></a>01741 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01742"></a>01742 <span class="preprocessor"></span>    {
<a name="l01743"></a>01743 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01744"></a>01744 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01745"></a>01745 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01746"></a>01746 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01747"></a>01747 
<a name="l01748"></a>01748             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01749"></a>01749             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01750"></a>01750             indexLo     = indexUp + sizeHalfBlock;
<a name="l01751"></a>01751 
<a name="l01752"></a>01752             <span class="keywordflow">if</span> (mask == (mask &amp; (indexUp+chunkId*chunkSize)) ){
<a name="l01753"></a>01753                 <span class="comment">// store current state vector values in temp variables</span>
<a name="l01754"></a>01754                 stateRealUp = stateVecReal[indexUp];
<a name="l01755"></a>01755                 stateImagUp = stateVecImag[indexUp];
<a name="l01756"></a>01756 
<a name="l01757"></a>01757                 stateRealLo = stateVecReal[indexLo];
<a name="l01758"></a>01758                 stateImagLo = stateVecImag[indexLo];
<a name="l01759"></a>01759 
<a name="l01760"></a>01760 
<a name="l01761"></a>01761                 <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l01762"></a>01762                 stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01763"></a>01763                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01764"></a>01764                 stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01765"></a>01765                     + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01766"></a>01766 
<a name="l01767"></a>01767                 <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l01768"></a>01768                 stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01769"></a>01769                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01770"></a>01770                 stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01771"></a>01771                     + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01772"></a>01772             }
<a name="l01773"></a>01773         } 
<a name="l01774"></a>01774     }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac4f8a0ab089bc002fd85cd87f8c451e9"></a><!-- doxytag: member="QuEST_cpu.c::statevec_pauliXDistributed" ref="ac4f8a0ab089bc002fd85cd87f8c451e9" args="(Qureg qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02093">2093</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00988">statevec_pauliX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02096"></a>02096 {
<a name="l02097"></a>02097 
<a name="l02098"></a>02098     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l02099"></a>02099     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02100"></a>02100 
<a name="l02101"></a>02101     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;
<a name="l02102"></a>02102     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02103"></a>02103 
<a name="l02104"></a>02104 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02105"></a>02105 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02106"></a>02106 <span class="preprocessor">    default  (none) \</span>
<a name="l02107"></a>02107 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut) \</span>
<a name="l02108"></a>02108 <span class="preprocessor">    private  (thisTask)</span>
<a name="l02109"></a>02109 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02110"></a>02110 <span class="preprocessor"></span>    {
<a name="l02111"></a>02111 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02112"></a>02112 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02113"></a>02113 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02114"></a>02114 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02115"></a>02115             stateVecRealOut[thisTask] = stateVecRealIn[thisTask];
<a name="l02116"></a>02116             stateVecImagOut[thisTask] = stateVecImagIn[thisTask];
<a name="l02117"></a>02117         }
<a name="l02118"></a>02118     }
<a name="l02119"></a>02119 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a842aaecd6d6cdc194c0b7c84623d2111"></a><!-- doxytag: member="QuEST_cpu.c::statevec_pauliXLocal" ref="a842aaecd6d6cdc194c0b7c84623d2111" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02034">2034</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00988">statevec_pauliX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02035"></a>02035 {
<a name="l02036"></a>02036     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l02037"></a>02037     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l02038"></a>02038          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l02039"></a>02039 
<a name="l02040"></a>02040     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateImagUp;
<a name="l02041"></a>02041     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l02042"></a>02042     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02043"></a>02043 
<a name="l02044"></a>02044     <span class="comment">// set dimensions</span>
<a name="l02045"></a>02045     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l02046"></a>02046     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l02047"></a>02047 
<a name="l02048"></a>02048     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l02049"></a>02049     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02050"></a>02050     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02051"></a>02051 
<a name="l02052"></a>02052 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02053"></a>02053 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02054"></a>02054 <span class="preprocessor">    default  (none) \</span>
<a name="l02055"></a>02055 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l02056"></a>02056 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l02057"></a>02057 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02058"></a>02058 <span class="preprocessor"></span>    {
<a name="l02059"></a>02059 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02060"></a>02060 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02061"></a>02061 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02062"></a>02062 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02063"></a>02063             thisBlock   = thisTask / sizeHalfBlock;
<a name="l02064"></a>02064             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02065"></a>02065             indexLo     = indexUp + sizeHalfBlock;
<a name="l02066"></a>02066 
<a name="l02067"></a>02067             stateRealUp = stateVecReal[indexUp];
<a name="l02068"></a>02068             stateImagUp = stateVecImag[indexUp];
<a name="l02069"></a>02069 
<a name="l02070"></a>02070             stateVecReal[indexUp] = stateVecReal[indexLo];
<a name="l02071"></a>02071             stateVecImag[indexUp] = stateVecImag[indexLo];
<a name="l02072"></a>02072 
<a name="l02073"></a>02073             stateVecReal[indexLo] = stateRealUp;
<a name="l02074"></a>02074             stateVecImag[indexLo] = stateImagUp;
<a name="l02075"></a>02075         } 
<a name="l02076"></a>02076     }
<a name="l02077"></a>02077 
<a name="l02078"></a>02078 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a04cdf71c5862ab2bf3a98cd0b3ea0c26"></a><!-- doxytag: member="QuEST_cpu.c::statevec_pauliYDistributed" ref="a04cdf71c5862ab2bf3a98cd0b3ea0c26" args="(Qureg qureg, const int targetQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, const int conjFac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>updateUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>conjFac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Rotate a single qubit by +-{{0,-i},{i,0}. </p>
<p>Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecIn</em>&nbsp;</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>updateUpper</em>&nbsp;</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02277">2277</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01044">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01069">statevec_pauliYConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02281"></a>02281 {
<a name="l02282"></a>02282 
<a name="l02283"></a>02283     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l02284"></a>02284     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02285"></a>02285 
<a name="l02286"></a>02286     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;
<a name="l02287"></a>02287     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l02288"></a>02288 
<a name="l02289"></a>02289     <span class="keywordtype">int</span> realSign=1, imagSign=1;
<a name="l02290"></a>02290     <span class="keywordflow">if</span> (updateUpper) imagSign=-1;
<a name="l02291"></a>02291     <span class="keywordflow">else</span> realSign = -1;
<a name="l02292"></a>02292 
<a name="l02293"></a>02293 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02294"></a>02294 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02295"></a>02295 <span class="preprocessor">    default  (none) \</span>
<a name="l02296"></a>02296 <span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,realSign,imagSign) \</span>
<a name="l02297"></a>02297 <span class="preprocessor">    private  (thisTask)</span>
<a name="l02298"></a>02298 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02299"></a>02299 <span class="preprocessor"></span>    {
<a name="l02300"></a>02300 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02301"></a>02301 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02302"></a>02302 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02303"></a>02303 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02304"></a>02304             stateVecRealOut[thisTask] = conjFac * realSign * stateVecImagIn[thisTask];
<a name="l02305"></a>02305             stateVecImagOut[thisTask] = conjFac * imagSign * stateVecRealIn[thisTask];
<a name="l02306"></a>02306         }
<a name="l02307"></a>02307     }
<a name="l02308"></a>02308 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8edf5f2066b05fb343931f45e2bec8f8"></a><!-- doxytag: member="QuEST_cpu.c::statevec_pauliYLocal" ref="a8edf5f2066b05fb343931f45e2bec8f8" args="(Qureg qureg, const int targetQubit, const int conjFac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>conjFac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02219">2219</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01044">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01069">statevec_pauliYConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02220"></a>02220 {
<a name="l02221"></a>02221     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l02222"></a>02222     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l02223"></a>02223          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l02224"></a>02224 
<a name="l02225"></a>02225     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateImagUp;
<a name="l02226"></a>02226     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l02227"></a>02227     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l02228"></a>02228 
<a name="l02229"></a>02229     <span class="comment">// set dimensions</span>
<a name="l02230"></a>02230     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l02231"></a>02231     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l02232"></a>02232 
<a name="l02233"></a>02233     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l02234"></a>02234     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02235"></a>02235     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02236"></a>02236 
<a name="l02237"></a>02237 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02238"></a>02238 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02239"></a>02239 <span class="preprocessor">    default  (none) \</span>
<a name="l02240"></a>02240 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span>
<a name="l02241"></a>02241 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp) </span>
<a name="l02242"></a>02242 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02243"></a>02243 <span class="preprocessor"></span>    {
<a name="l02244"></a>02244 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02245"></a>02245 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02246"></a>02246 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02247"></a>02247 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l02248"></a>02248             thisBlock   = thisTask / sizeHalfBlock;
<a name="l02249"></a>02249             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l02250"></a>02250             indexLo     = indexUp + sizeHalfBlock;
<a name="l02251"></a>02251 
<a name="l02252"></a>02252             stateRealUp = stateVecReal[indexUp];
<a name="l02253"></a>02253             stateImagUp = stateVecImag[indexUp];
<a name="l02254"></a>02254 
<a name="l02255"></a>02255             stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];
<a name="l02256"></a>02256             stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];
<a name="l02257"></a>02257             stateVecReal[indexLo] = conjFac * -stateImagUp;
<a name="l02258"></a>02258             stateVecImag[indexLo] = conjFac * stateRealUp;
<a name="l02259"></a>02259         } 
<a name="l02260"></a>02260     }
<a name="l02261"></a>02261 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8972669148af60d7e1c09687f69673d4"></a><!-- doxytag: member="QuEST_cpu.c::statevec_phaseShiftByTerm" ref="a8972669148af60d7e1c09687f69673d4" args="(Qureg qureg, const int targetQubit, Complex term)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShiftByTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>term</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02514">2514</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02515"></a>02515 {       
<a name="l02516"></a>02516     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02517"></a>02517     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02518"></a>02518     <span class="keywordtype">int</span> targetBit;
<a name="l02519"></a>02519     
<a name="l02520"></a>02520     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02521"></a>02521     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02522"></a>02522 
<a name="l02523"></a>02523     <span class="comment">// dimension of the state vector</span>
<a name="l02524"></a>02524     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02525"></a>02525     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02526"></a>02526     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02527"></a>02527     
<a name="l02528"></a>02528     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02529"></a>02529     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l02530"></a>02530     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l02531"></a>02531 
<a name="l02532"></a>02532 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02533"></a>02533 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02534"></a>02534 <span class="preprocessor">    default  (none)              \</span>
<a name="l02535"></a>02535 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02536"></a>02536 <span class="preprocessor">    private  (index,targetBit,stateRealLo,stateImagLo)             \</span>
<a name="l02537"></a>02537 <span class="preprocessor">    schedule (static)</span>
<a name="l02538"></a>02538 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02539"></a>02539 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02540"></a>02540         
<a name="l02541"></a>02541         <span class="comment">// update the coeff of the |1&gt; state of the target qubit</span>
<a name="l02542"></a>02542         targetBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (targetQubit, index+chunkId*chunkSize);
<a name="l02543"></a>02543         <span class="keywordflow">if</span> (targetBit) {
<a name="l02544"></a>02544             
<a name="l02545"></a>02545             stateRealLo = stateVecReal[index];
<a name="l02546"></a>02546             stateImagLo = stateVecImag[index];
<a name="l02547"></a>02547             
<a name="l02548"></a>02548             stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02549"></a>02549             stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02550"></a>02550         }
<a name="l02551"></a>02551     }
<a name="l02552"></a>02552 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1e57230c7995447039e62a84c0a36524"></a><!-- doxytag: member="QuEST_cpu.c::statevec_reportStateToScreen" ref="a1e57230c7995447039e62a84c0a36524" args="(Qureg qureg, QuESTEnv env, int reportRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reportRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01100">1100</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01100"></a>01100                                                                             {
<a name="l01101"></a>01101     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01102"></a>01102     <span class="keywordtype">int</span> rank;
<a name="l01103"></a>01103     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218" title="Number of qubits in the state-vector - this is double the number represented for...">numQubitsInStateVec</a>&lt;=5){
<a name="l01104"></a>01104         <span class="keywordflow">for</span> (rank=0; rank&lt;qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>; rank++){
<a name="l01105"></a>01105             <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==rank){
<a name="l01106"></a>01106                 <span class="keywordflow">if</span> (reportRank) {
<a name="l01107"></a>01107                     printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l01108"></a>01108                     printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l01109"></a>01109                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {
<a name="l01110"></a>01110                     printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);
<a name="l01111"></a>01111                     printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l01112"></a>01112                 }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114                 <span class="keywordflow">for</span>(index=0; index&lt;qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>; index++){
<a name="l01115"></a>01115                     <span class="comment">//printf(REAL_STRING_FORMAT &quot;, &quot; REAL_STRING_FORMAT &quot;\n&quot;, qureg.pairStateVec.real[index], qureg.pairStateVec.imag[index]);</span>
<a name="l01116"></a>01116                     printf(REAL_STRING_FORMAT <span class="stringliteral">&quot;, &quot;</span> REAL_STRING_FORMAT <span class="stringliteral">&quot;\n&quot;</span>, qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index], qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[index]);
<a name="l01117"></a>01117                 }
<a name="l01118"></a>01118                 <span class="keywordflow">if</span> (reportRank || rank==qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l01119"></a>01119             }
<a name="l01120"></a>01120             <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122     } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);
<a name="l01123"></a>01123 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa121d55f2ca09c06a96ddcd433c60b0f"></a><!-- doxytag: member="QuEST_cpu.c::statevec_setAmps" ref="aa121d55f2ca09c06a96ddcd433c60b0f" args="(Qureg qureg, long long int startInd, qreal *reals, qreal *imags, long long int numAmps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>imags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>numAmps</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01016">1016</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01016"></a>01016                                                                                                               {
<a name="l01017"></a>01017     
<a name="l01018"></a>01018     <span class="comment">/* this is actually distributed, since the user&apos;s code runs on every node */</span>
<a name="l01019"></a>01019     
<a name="l01020"></a>01020     <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span>
<a name="l01021"></a>01021     <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span>
<a name="l01022"></a>01022     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01023"></a>01023     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numAmps; <span class="comment">// exclusive</span>
<a name="l01024"></a>01024     
<a name="l01025"></a>01025     <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span>
<a name="l01026"></a>01026     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a> - startInd;
<a name="l01027"></a>01027     
<a name="l01028"></a>01028     <span class="comment">// restrict these indices to fit into this chunk</span>
<a name="l01029"></a>01029     <span class="keywordflow">if</span> (localStartInd &lt; 0)
<a name="l01030"></a>01030         localStartInd = 0;
<a name="l01031"></a>01031     <span class="keywordflow">if</span> (localEndInd &gt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>)
<a name="l01032"></a>01032         localEndInd = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01033"></a>01033     <span class="comment">// they may now be out of order = no iterations</span>
<a name="l01034"></a>01034     
<a name="l01035"></a>01035     <span class="comment">// unpacking OpenMP vars</span>
<a name="l01036"></a>01036     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01037"></a>01037     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01038"></a>01038     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01039"></a>01039     
<a name="l01040"></a>01040 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01041"></a>01041 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01042"></a>01042 <span class="preprocessor">    default  (none) \</span>
<a name="l01043"></a>01043 <span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, reals,imags, offset) \</span>
<a name="l01044"></a>01044 <span class="preprocessor">    private  (index) </span>
<a name="l01045"></a>01045 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01046"></a>01046 <span class="preprocessor"></span>    {
<a name="l01047"></a>01047 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01048"></a>01048 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01049"></a>01049 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01050"></a>01050 <span class="preprocessor"></span>        <span class="comment">// iterate these local inds - this might involve no iterations</span>
<a name="l01051"></a>01051         <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {
<a name="l01052"></a>01052             vecRe[index] = reals[index + offset];
<a name="l01053"></a>01053             vecIm[index] = imags[index + offset];
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055     }
<a name="l01056"></a>01056 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a62c5d85e323f2c3eea2b7fa6d8c193ea"></a><!-- doxytag: member="QuEST_cpu.c::statevec_unitaryDistributed" ref="a62c5d85e323f2c3eea2b7fa6d8c193ea" args="(Qureg qureg, const int targetQubit, Complex rot1, Complex rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&nbsp;</td>
          <td class="paramname"> <em>stateVecOut</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Qubits are zero-based and the first qubit is the rightmost</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>targetQubit</em>&nbsp;</td><td>qubit to rotate </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>u</em>&nbsp;</td><td>unitary matrix to apply </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecUp</em>&nbsp;</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stateVecLo</em>&nbsp;</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>stateVecOut</em>&nbsp;</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01603">1603</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00832">statevec_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01608"></a>01608 {
<a name="l01609"></a>01609 
<a name="l01610"></a>01610     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01611"></a>01611     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  
<a name="l01612"></a>01612     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01613"></a>01613 
<a name="l01614"></a>01614     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot1Real=rot1.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01615"></a>01615     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rot2Real=rot2.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l01616"></a>01616     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;
<a name="l01617"></a>01617     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;
<a name="l01618"></a>01618     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;
<a name="l01619"></a>01619 
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01622"></a>01622 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01623"></a>01623 <span class="preprocessor">    default  (none) \</span>
<a name="l01624"></a>01624 <span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span>
<a name="l01625"></a>01625 <span class="preprocessor">            rot1Real, rot1Imag, rot2Real, rot2Imag) \</span>
<a name="l01626"></a>01626 <span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span>
<a name="l01627"></a>01627 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01628"></a>01628 <span class="preprocessor"></span>    {
<a name="l01629"></a>01629 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01630"></a>01630 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01631"></a>01631 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01632"></a>01632 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01633"></a>01633             <span class="comment">// store current state vector values in temp variables</span>
<a name="l01634"></a>01634             stateRealUp = stateVecRealUp[thisTask];
<a name="l01635"></a>01635             stateImagUp = stateVecImagUp[thisTask];
<a name="l01636"></a>01636 
<a name="l01637"></a>01637             stateRealLo = stateVecRealLo[thisTask];
<a name="l01638"></a>01638             stateImagLo = stateVecImagLo[thisTask];
<a name="l01639"></a>01639 
<a name="l01640"></a>01640             stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp 
<a name="l01641"></a>01641                 + rot2Real*stateRealLo - rot2Imag*stateImagLo;
<a name="l01642"></a>01642             stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp 
<a name="l01643"></a>01643                 + rot2Real*stateImagLo + rot2Imag*stateRealLo;
<a name="l01644"></a>01644         }
<a name="l01645"></a>01645     }
<a name="l01646"></a>01646 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9f62ff38deae8ef012024d416d749c00"></a><!-- doxytag: member="QuEST_cpu.c::statevec_unitaryLocal" ref="a9f62ff38deae8ef012024d416d749c00" args="(Qureg qureg, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01477">1477</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00832">statevec_unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01478"></a>01478 {
<a name="l01479"></a>01479     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;
<a name="l01480"></a>01480     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span>
<a name="l01481"></a>01481          indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span>
<a name="l01482"></a>01482 
<a name="l01483"></a>01483     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;
<a name="l01484"></a>01484     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         
<a name="l01485"></a>01485     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>&gt;&gt;1;
<a name="l01486"></a>01486 
<a name="l01487"></a>01487     <span class="comment">// set dimensions</span>
<a name="l01488"></a>01488     sizeHalfBlock = 1LL &lt;&lt; targetQubit;  
<a name="l01489"></a>01489     sizeBlock     = 2LL * sizeHalfBlock; 
<a name="l01490"></a>01490 
<a name="l01491"></a>01491     <span class="comment">// Can&apos;t use qureg.stateVec as a private OMP var</span>
<a name="l01492"></a>01492     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01493"></a>01493     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01494"></a>01494 
<a name="l01495"></a>01495 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01496"></a>01496 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01497"></a>01497 <span class="preprocessor">    default  (none) \</span>
<a name="l01498"></a>01498 <span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u) \</span>
<a name="l01499"></a>01499 <span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo) </span>
<a name="l01500"></a>01500 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01501"></a>01501 <span class="preprocessor"></span>    {
<a name="l01502"></a>01502 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01503"></a>01503 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01504"></a>01504 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01505"></a>01505 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {
<a name="l01506"></a>01506 
<a name="l01507"></a>01507             thisBlock   = thisTask / sizeHalfBlock;
<a name="l01508"></a>01508             indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;
<a name="l01509"></a>01509             indexLo     = indexUp + sizeHalfBlock;
<a name="l01510"></a>01510 
<a name="l01511"></a>01511             <span class="comment">// store current state vector values in temp variables</span>
<a name="l01512"></a>01512             stateRealUp = stateVecReal[indexUp];
<a name="l01513"></a>01513             stateImagUp = stateVecImag[indexUp];
<a name="l01514"></a>01514 
<a name="l01515"></a>01515             stateRealLo = stateVecReal[indexLo];
<a name="l01516"></a>01516             stateImagLo = stateVecImag[indexLo];
<a name="l01517"></a>01517 
<a name="l01518"></a>01518 
<a name="l01519"></a>01519             <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span>
<a name="l01520"></a>01520             stateVecReal[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01521"></a>01521                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo - u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01522"></a>01522             stateVecImag[indexUp] = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01523"></a>01523                 + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525             <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span>
<a name="l01526"></a>01526             stateVecReal[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealUp  - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagUp 
<a name="l01527"></a>01527                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateRealLo  -  u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateImagLo;
<a name="l01528"></a>01528             stateVecImag[indexLo] = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagUp + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealUp 
<a name="l01529"></a>01529                 + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*stateImagLo + u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*stateRealLo;
<a name="l01530"></a>01530 
<a name="l01531"></a>01531         } 
<a name="l01532"></a>01532     }
<a name="l01533"></a>01533 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac5168399122f7f53977dcc9ceda4f458"></a><!-- doxytag: member="QuEST_cpu.c::zeroSomeAmps" ref="ac5168399122f7f53977dcc9ceda4f458" args="(Qureg qureg, long long int startInd, long long int numAmps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zeroSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>numAmps</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00583">583</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00603">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00583"></a>00583                                                                               {
<a name="l00584"></a>00584     
<a name="l00585"></a>00585 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00586"></a>00586 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for schedule (static)</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=startInd; i &lt; startInd+numAmps; i++) {
<a name="l00589"></a>00589         qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i] = 0;
<a name="l00590"></a>00590         qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i] = 0;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 11 Jan 2019 for Quantum Exact Simulation Toolkit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
