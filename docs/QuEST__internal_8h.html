<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Quantum Exact Simulation Toolkit: QuEST_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>QuEST_internal.h File Reference</h1>
<p>Functions used internally, supplied by QuEST_common or by hardware-specific backends.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="QuEST_8h_source.html">QuEST.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br/>

<p><a href="QuEST__internal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7c14b7f97aac42f390383893e703841f">densmatr_addDensityMatrix</a> (<a class="el" href="structQureg.html">Qureg</a> combineQureg, qreal otherProb, <a class="el" href="structQureg.html">Qureg</a> otherQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa6c3f86010ad398f42b0577ea3bb5bcf">densmatr_calcFidelity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad405e3fac20997043e0236b751e44270">densmatr_calcProbOfOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae45eefa65f4ecd37bab84fade7cf7f1f">densmatr_calcPurity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes the trace of the density matrix squared.  <a href="#ae45eefa65f4ecd37bab84fade7cf7f1f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a6153547f245c05874161a105e9a2f02c">densmatr_calcTotalProb</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab321af37fe3490253e12b7c70b8d2a98">densmatr_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, qreal outcomeProb)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.  <a href="#ab321af37fe3490253e12b7c70b8d2a98"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a20a155f53efc45c16803d7539c2c199d">densmatr_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2418bd9a6b9e6a0acf11faf5982d5d29">densmatr_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae5ad68d054875913d0f7ec654840a9ec">densmatr_initPureState</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae4ebc1f4dd48922bfb30ad1692310269">densmatr_measureWithStats</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, qreal *outcomeProb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a56b32228c24a7c4e1894d991ef4b6b99">densmatr_oneQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal dephase)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae5bf84ca607e1484e0ddb5570726848d">densmatr_oneQubitDepolarise</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal depolLevel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int qubit1, const int qubit2, qreal dephase)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa500e14a9ed1683f9c056f03f4c24cea">densmatr_twoQubitDepolarise</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, qreal depolLevel)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac8ea84dd85eca525daeeb30b3c96b673">ensureIndsIncrease</a> (int *ind1, int *ind2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a73300e3cdca56a7615980274905ba097">getComplexPairAndPhaseFromUnitary</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>, <a class="el" href="structComplex.html">Complex</a> *alpha, <a class="el" href="structComplex.html">Complex</a> *beta, qreal *globalPhase)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">maps U(r0c0, r0c1, r1c0, r1c1) to exp(i globalPhase) U(alpha, beta)  <a href="#a73300e3cdca56a7615980274905ba097"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a> (qreal angle, <a class="el" href="structVector.html">Vector</a> axis, <a class="el" href="structComplex.html">Complex</a> *alpha, <a class="el" href="structComplex.html">Complex</a> *beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac711ba2f44edc3f4f286ba9e9a7d6288">getConjugateMatrix</a> (<a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> matr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a> (<a class="el" href="structComplex.html">Complex</a> scalar)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3cf54148e2162b04aeb634badb90826c">getVectorMagnitude</a> (<a class="el" href="structVector.html">Vector</a> vec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a404d177b894ce008289e44a599ad77d6">getZYZRotAnglesFromComplexPair</a> (<a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta, qreal *rz2, qreal *ry, qreal *rz1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">maps U(alpha, beta) to Rz(rz2) Ry(ry) Rz(rz1)  <a href="#a404d177b894ce008289e44a599ad77d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab76254cfde16f0808476649507a1a2fc">hashString</a> (char *str)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#acf1c651a4359a370a2d9b3e1e1ebd430">shiftIndices</a> (int *indices, int numIndices, int shift)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aeeec9fe1501e25930adf6c38763a158e">statevec_calcFidelity</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7ebd3198a198f4cd20840f64fd8b84d0">statevec_calcInnerProduct</a> (<a class="el" href="structQureg.html">Qureg</a> bra, <a class="el" href="structQureg.html">Qureg</a> ket)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Terrible code which unnecessarily individually computes and sums the real and imaginary components of the inner product, so as to not have to worry about keeping the sums separated during reduction.  <a href="#a7ebd3198a198f4cd20840f64fd8b84d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab33cdf01831c4545e51299178acf7f27">statevec_calcProbOfOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad65ad1b5ea6f30b0c6b4ffda96e1a8e6">statevec_calcTotalProb</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">works for both statevectors and density matrices  <a href="#aa4b77089145184d990848cd66993aa8b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae7f25bb40734e18a992403b17355893b">statevec_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int measureQubit, int outcome, qreal outcomeProb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ae6cecbad32a03416138b321cdc1a2c33">statevec_compareStates</a> (<a class="el" href="structQureg.html">Qureg</a> mq1, <a class="el" href="structQureg.html">Qureg</a> mq2, qreal precision)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a114038296eb404b9b8a66aaad7b48800">statevec_controlledNot</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a708246b16236c492094c2633da0c08ff">statevec_controlledPauliY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9e647339720bf82b30c6331fad544ec5">statevec_controlledPauliYConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a7c0067cb9f243ead20de7392aea328bc">statevec_controlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#adeb715f3f2c167f9bfbe92b75f5988ce">statevec_controlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int idQubit1, const int idQubit2, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, qreal angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aeb4ddeb09a3c0fa39ac33984bd5ca0ea">statevec_controlledRotateAroundAxisConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, qreal angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af59bc61f97d42cdceaf7fc0257a387d6">statevec_controlledRotateX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad2dc0754043172e0449c78569d27fd4a">statevec_controlledRotateY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a06bffb653fa42a67254d034b6cce6d7d">statevec_controlledRotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2600999a19c817bfcf7ca14779e33b9a">statevec_controlledUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int controlQubit, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abd509244d57657e148e4084c5ab5d28f">statevec_getImagAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3afe58e49dce5536bc4c1b7caddf44a6">statevec_getProbAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">qreal&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abc9a9ef4344c7faaaf28ac25c76649b9">statevec_getRealAmp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a9226f386d010aaa85efc0e8889d341d5">statevec_hadamard</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a288dc4b46bdacd69cbf4a6fd070d26a7">statevec_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a482fc361fd5f08075404c72e536316a0">statevec_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a38445cdb2a18671a7c73112ce3337acb">statevec_initStateDebug</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="#a38445cdb2a18671a7c73112ce3337acb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a05756b45f10135bb2eeb07380f806c20">statevec_initStateFromSingleFile</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a923906770cac0da9e3459bae58de9e64">statevec_initStateOfSingleQubit</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int qubitId, int outcome)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="#a923906770cac0da9e3459bae58de9e64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2ca0c6ba07ab2b4b437321bf17efc966">statevec_initZeroState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac2eb81c71d0e0fbec7be5b45b1db1448">statevec_measureWithStats</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, qreal *outcomeProb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ac4ee5979d475e8c729294b8ef7e0270d">statevec_multiControlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa662796ea6e0f471143c53becae8c12c">statevec_multiControlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a2cc288d53df484516cde923c8a3b561a">statevec_multiControlledUnitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, const int numControlQubits, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#abdb6e0ee1e407755e1b944086cedd90e">statevec_pauliX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a73b56fbac6e464a37805fa9d9657a8f9">statevec_pauliY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aee97816cfabeea7874cd837a8d105412">statevec_pauliYConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ad711cac41adb0fea1ad4797ce14953e0">statevec_pauliZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a37bcd16fc0bbc8e665585ba9b99f382b">statevec_phaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplex.html">Complex</a> term)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a1e57230c7995447039e62a84c0a36524">statevec_reportStateToScreen</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the current state vector of probability amplitudes for a set of qubits to standard out.  <a href="#a1e57230c7995447039e62a84c0a36524"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, qreal angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#af9839c40de8df0cecc72a0258a20d979">statevec_rotateAroundAxisConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, qreal angle, <a class="el" href="structVector.html">Vector</a> axis)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aca123cc22e13a2cb819ef6c2f455b9e4">statevec_rotateX</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a4a62c8c00dc4adf74b982ad8a9049170">statevec_rotateY</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#ab96ee09e32e297629a481c3ba6d7eaf7">statevec_rotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int rotQubit, qreal angle)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aa121d55f2ca09c06a96ddcd433c60b0f">statevec_setAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, qreal *reals, qreal *imags, long long int numAmps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#aea5b9ea10791217a793a8040c36e4efc">statevec_sGate</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a78bfeb90f0c1812e726ec3092056bb52">statevec_sGateConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a0bd738cb7e7cdea8f1ce1e640d427d4c">statevec_tGate</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a3ce1b05fee70d930791513fec378d229">statevec_tGateConj</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__internal_8h.html#a4bea7ed7967083cbabd8a8e5acdd48c0">statevec_unitary</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, const int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> <a class="el" href="README_8md.html#a5d1c311241dc8d8ffa4badf059977dc5">u</a>)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Functions used internally, supplied by QuEST_common or by hardware-specific backends. </p>

<p>Definition in file <a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>.</p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7c14b7f97aac42f390383893e703841f"></a><!-- doxytag: member="QuEST_internal.h::densmatr_addDensityMatrix" ref="a7c14b7f97aac42f390383893e703841f" args="(Qureg combineQureg, qreal otherProb, Qureg otherQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_addDensityMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>combineQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>otherProb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>otherQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00739">739</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00585">addDensityMatrix()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00739"></a>00739                                                                                       {
<a name="l00740"></a>00740     
<a name="l00741"></a>00741     <span class="comment">/* corresponding amplitudes live on the same node (same dimensions) */</span>
<a name="l00742"></a>00742     
<a name="l00743"></a>00743     <span class="comment">// unpack vars for OpenMP</span>
<a name="l00744"></a>00744     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* combineVecRe = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00745"></a>00745     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* combineVecIm = combineQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00746"></a>00746     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* otherVecRe = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00747"></a>00747     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* otherVecIm = otherQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00748"></a>00748     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = combineQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00749"></a>00749     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00750"></a>00750     
<a name="l00751"></a>00751 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00752"></a>00752 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00753"></a>00753 <span class="preprocessor">    default (none) \</span>
<a name="l00754"></a>00754 <span class="preprocessor">    shared  (combineVecRe,combineVecIm,otherVecRe,otherVecIm, otherProb, numAmps) \</span>
<a name="l00755"></a>00755 <span class="preprocessor">    private (index)</span>
<a name="l00756"></a>00756 <span class="preprocessor"></span><span class="preprocessor"># endif </span>
<a name="l00757"></a>00757 <span class="preprocessor"></span>    {
<a name="l00758"></a>00758 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00759"></a>00759 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule  (static)</span>
<a name="l00760"></a>00760 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00761"></a>00761 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {
<a name="l00762"></a>00762             combineVecRe[index] *= 1-otherProb;
<a name="l00763"></a>00763             combineVecIm[index] *= 1-otherProb;
<a name="l00764"></a>00764             
<a name="l00765"></a>00765             combineVecRe[index] += otherProb * otherVecRe[index];
<a name="l00766"></a>00766             combineVecIm[index] += otherProb * otherVecIm[index];
<a name="l00767"></a>00767         }
<a name="l00768"></a>00768     }
<a name="l00769"></a>00769 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa6c3f86010ad398f42b0577ea3bb5bcf"></a><!-- doxytag: member="QuEST_internal.h::densmatr_calcFidelity" ref="aa6c3f86010ad398f42b0577ea3bb5bcf" args="(Qureg qureg, Qureg pureState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcFidelity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>pureState</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00413">413</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00379">copyVecIntoMatrixPairState()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00772">densmatr_calcFidelityLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00630">calcFidelity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00413"></a>00413                                                           {
<a name="l00414"></a>00414     
<a name="l00415"></a>00415     <span class="comment">// set qureg&apos;s pairState is to be the full pureState (on every node)</span>
<a name="l00416"></a>00416     <a class="code" href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a>(qureg, pureState);
<a name="l00417"></a>00417  
<a name="l00418"></a>00418     <span class="comment">// collect calcFidelityLocal by every machine</span>
<a name="l00419"></a>00419     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> localSum = <a class="code" href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c" title="computes a few dens-columns-worth of (vec^*T) dens * vec">densmatr_calcFidelityLocal</a>(qureg, pureState);
<a name="l00420"></a>00420     
<a name="l00421"></a>00421     <span class="comment">// sum each localSum</span>
<a name="l00422"></a>00422     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> globalSum;
<a name="l00423"></a>00423     MPI_Allreduce(&amp;localSum, &amp;globalSum, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l00424"></a>00424     
<a name="l00425"></a>00425     <span class="keywordflow">return</span> globalSum;
<a name="l00426"></a>00426 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad405e3fac20997043e0236b751e44270"></a><!-- doxytag: member="QuEST_internal.h::densmatr_calcProbOfOutcome" ref="ad405e3fac20997043e0236b751e44270" args="(Qureg qureg, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcProbOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01231">1231</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l01466">densmatr_findProbabilityOfZero()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02637">densmatr_findProbabilityOfZeroLocal()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00614">calcProbOfOutcome()</a>, <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00320">densmatr_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01231"></a>01231                                                                                    {
<a name="l01232"></a>01232         
<a name="l01233"></a>01233         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> zeroProb = <a class="code" href="QuEST__cpu_8c.html#a101e7ef38c5d654a697dafe14562dcee">densmatr_findProbabilityOfZeroLocal</a>(qureg, measureQubit);
<a name="l01234"></a>01234         
<a name="l01235"></a>01235         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> outcomeProb;
<a name="l01236"></a>01236         MPI_Allreduce(&amp;zeroProb, &amp;outcomeProb, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l01237"></a>01237         <span class="keywordflow">if</span> (outcome == 1)
<a name="l01238"></a>01238                 outcomeProb = 1.0 - outcomeProb;
<a name="l01239"></a>01239         
<a name="l01240"></a>01240         <span class="keywordflow">return</span> outcomeProb;
<a name="l01241"></a>01241 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae45eefa65f4ecd37bab84fade7cf7f1f"></a><!-- doxytag: member="QuEST_internal.h::densmatr_calcPurity" ref="ae45eefa65f4ecd37bab84fade7cf7f1f" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcPurity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Computes the trace of the density matrix squared. </p>

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01243">1243</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00710">densmatr_calcPurityLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00624">calcPurity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01243"></a>01243                                        {
<a name="l01244"></a>01244     
<a name="l01245"></a>01245     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> localPurity = <a class="code" href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a>(qureg);
<a name="l01246"></a>01246         
<a name="l01247"></a>01247     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> globalPurity;
<a name="l01248"></a>01248     MPI_Allreduce(&amp;localPurity, &amp;globalPurity, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l01249"></a>01249     
<a name="l01250"></a>01250     <span class="keywordflow">return</span> globalPurity;
<a name="l01251"></a>01251 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6153547f245c05874161a105e9a2f02c"></a><!-- doxytag: member="QuEST_internal.h::densmatr_calcTotalProb" ref="a6153547f245c05874161a105e9a2f02c" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal densmatr_calcTotalProb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00059">59</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="README_8md_source.html#l00018">y</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00599">calcTotalProb()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00059"></a>00059                                           {
<a name="l00060"></a>00060         
<a name="l00061"></a>00061         <span class="comment">// computes the trace by summing every element (&quot;diag&quot;) with global index (2^n + 1)i for i in [0, 2^n-1]</span>
<a name="l00062"></a>00062         
<a name="l00063"></a>00063         <span class="comment">// computes first local index containing a diagonal element</span>
<a name="l00064"></a>00064         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + (1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00065"></a>00065     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>&gt;0)? 1+(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>)/diagSpacing : 0;
<a name="l00066"></a>00066         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;
<a name="l00067"></a>00067         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00068"></a>00068         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00069"></a>00069         
<a name="l00070"></a>00070         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> rankTotal = 0;
<a name="l00071"></a>00071         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> <a class="code" href="README_8md.html#a003dc5701d53a819228f5417a8089139">y</a>, t, c;
<a name="l00072"></a>00072         c = 0;
<a name="l00073"></a>00073         
<a name="l00074"></a>00074         <span class="comment">// iterates every local diagonal</span>
<a name="l00075"></a>00075         <span class="keywordflow">for</span> (index=localIndNextDiag; index &lt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>; index += diagSpacing) {
<a name="l00076"></a>00076                 
<a name="l00077"></a>00077                 <span class="comment">// Kahan summation - brackets are important</span>
<a name="l00078"></a>00078                 y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index] - c;
<a name="l00079"></a>00079                 t = rankTotal + y;
<a name="l00080"></a>00080                 c = ( t - rankTotal ) - y;
<a name="l00081"></a>00081                 rankTotal = t;
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083         
<a name="l00084"></a>00084         <span class="comment">// combine each node&apos;s sum of diagonals</span>
<a name="l00085"></a>00085         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> globalTotal;
<a name="l00086"></a>00086         <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> &gt; 1)
<a name="l00087"></a>00087                 MPI_Allreduce(&amp;rankTotal, &amp;globalTotal, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l00088"></a>00088         <span class="keywordflow">else</span>
<a name="l00089"></a>00089                 globalTotal = rankTotal;
<a name="l00090"></a>00090         
<a name="l00091"></a>00091         <span class="keywordflow">return</span> globalTotal;
<a name="l00092"></a>00092 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab321af37fe3490253e12b7c70b8d2a98"></a><!-- doxytag: member="QuEST_internal.h::densmatr_collapseToKnownProbOutcome" ref="ab321af37fe3490253e12b7c70b8d2a98" args="(Qureg qureg, const int measureQubit, int outcome, qreal outcomeProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>outcomeProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>
<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.</p>
<p>..&gt;&lt;...j...| states and killing those where i!=j </p>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00634">634</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST__cpu_8c_source.html#l00603">alternateNormZeroingSomeAmpBlocks()</a>, <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00593">normaliseSomeAmps()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00583">zeroSomeAmps()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00320">densmatr_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00634"></a>00634                                                                                                                  {
<a name="l00635"></a>00635 
<a name="l00636"></a>00636         <span class="comment">// only (global) indices (as bit sequence): &apos;* outcome *(n+q) outcome *q are spared</span>
<a name="l00637"></a>00637     <span class="comment">// where n = measureQubit, q = qureg.numQubitsRepresented.</span>
<a name="l00638"></a>00638     <span class="comment">// We can thus step in blocks of 2^q+n, killing every second, and inside the others,</span>
<a name="l00639"></a>00639     <span class="comment">//  stepping in sub-blocks of 2^q, killing every second.</span>
<a name="l00640"></a>00640     <span class="comment">// When outcome=1, we offset the start of these blocks by their size.</span>
<a name="l00641"></a>00641     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerBlockSize = (1LL &lt;&lt; measureQubit);
<a name="l00642"></a>00642     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerBlockSize = (1LL &lt;&lt; (measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00643"></a>00643     
<a name="l00644"></a>00644     <span class="comment">// Because there are 2^a number of nodes(/chunks), each node will contain 2^b number of blocks,</span>
<a name="l00645"></a>00645     <span class="comment">// or each block will span 2^c number of nodes. Similarly for the innerblocks.</span>
<a name="l00646"></a>00646     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> locNumAmps = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00647"></a>00647     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> * locNumAmps;
<a name="l00648"></a>00648     <span class="keywordtype">int</span> innerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(measureQubit, globalStartInd);
<a name="l00649"></a>00649     <span class="keywordtype">int</span> outerBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(measureQubit + qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>, globalStartInd);
<a name="l00650"></a>00650     
<a name="l00651"></a>00651     <span class="comment">// If this chunk&apos;s amps are entirely inside an outer block</span>
<a name="l00652"></a>00652     <span class="keywordflow">if</span> (locNumAmps &lt;= outerBlockSize) {
<a name="l00653"></a>00653         
<a name="l00654"></a>00654         <span class="comment">// if this is an undesired outer block, kill all elems</span>
<a name="l00655"></a>00655         <span class="keywordflow">if</span> (outerBit != outcome)
<a name="l00656"></a>00656             <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00657"></a>00657         
<a name="l00658"></a>00658         <span class="comment">// othwerwise, if this is a desired outer block, and also entirely an inner block</span>
<a name="l00659"></a>00659         <span class="keywordflow">if</span> (locNumAmps &lt;= innerBlockSize) {
<a name="l00660"></a>00660             
<a name="l00661"></a>00661             <span class="comment">// and that inner block is undesired, kill all elems</span>
<a name="l00662"></a>00662             <span class="keywordflow">if</span> (innerBit != outcome)
<a name="l00663"></a>00663                 <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00664"></a>00664             <span class="comment">// otherwise normalise all elems</span>
<a name="l00665"></a>00665             <span class="keywordflow">else</span>
<a name="l00666"></a>00666                 <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, totalStateProb, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>);
<a name="l00667"></a>00667         }
<a name="l00668"></a>00668                 
<a name="l00669"></a>00669         <span class="comment">// otherwise this is a desired outer block which contains 2^a inner blocks; kill/renorm every second inner block</span>
<a name="l00670"></a>00670         <span class="keywordflow">return</span> <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00671"></a>00671             qureg, totalStateProb, innerBit==outcome, 0, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, innerBlockSize);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673     
<a name="l00674"></a>00674     <span class="comment">// Otherwise, this chunk&apos;s amps contain multiple outer blocks (and hence multiple inner blocks)</span>
<a name="l00675"></a>00675     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOuterDoubleBlocks = locNumAmps / (2*outerBlockSize);
<a name="l00676"></a>00676     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> firstBlockInd;
<a name="l00677"></a>00677     
<a name="l00678"></a>00678     <span class="comment">// alternate norming* and zeroing the outer blocks (with order based on the desired outcome)</span>
<a name="l00679"></a>00679     <span class="comment">// These loops aren&apos;t parallelised, since they could have 1 or 2 iterations and will prevent</span>
<a name="l00680"></a>00680     <span class="comment">// inner parallelisation</span>
<a name="l00681"></a>00681     <span class="keywordflow">if</span> (outerBit == outcome) {
<a name="l00682"></a>00682 
<a name="l00683"></a>00683         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {
<a name="l00684"></a>00684             firstBlockInd = outerDubBlockInd*2*outerBlockSize;
<a name="l00685"></a>00685             
<a name="l00686"></a>00686             <span class="comment">// *norm only the desired inner blocks in the desired outer block</span>
<a name="l00687"></a>00687             <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00688"></a>00688                 qureg, totalStateProb, innerBit==outcome, 
<a name="l00689"></a>00689                 firstBlockInd, outerBlockSize, innerBlockSize);
<a name="l00690"></a>00690             
<a name="l00691"></a>00691             <span class="comment">// zero the undesired outer block</span>
<a name="l00692"></a>00692             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd + outerBlockSize, outerBlockSize);
<a name="l00693"></a>00693         }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695     } <span class="keywordflow">else</span> {
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {
<a name="l00698"></a>00698             firstBlockInd = outerDubBlockInd*2*outerBlockSize;
<a name="l00699"></a>00699             
<a name="l00700"></a>00700             <span class="comment">// same thing but undesired outer blocks come first</span>
<a name="l00701"></a>00701             <a class="code" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd, outerBlockSize);
<a name="l00702"></a>00702             <a class="code" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(
<a name="l00703"></a>00703                 qureg, totalStateProb, innerBit==outcome, 
<a name="l00704"></a>00704                 firstBlockInd + outerBlockSize, outerBlockSize, innerBlockSize);
<a name="l00705"></a>00705         }
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707     
<a name="l00708"></a>00708 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20a155f53efc45c16803d7539c2c199d"></a><!-- doxytag: member="QuEST_internal.h::densmatr_initClassicalState" ref="a20a155f53efc45c16803d7539c2c199d" args="(Qureg qureg, long long int stateInd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>stateInd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00894">894</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00107">initClassicalState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00895"></a>00895 {
<a name="l00896"></a>00896     <span class="comment">// dimension of the state vector</span>
<a name="l00897"></a>00897     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityNumElems = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l00900"></a>00900     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00901"></a>00901     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903     <span class="comment">// initialise the state to all zeros</span>
<a name="l00904"></a>00904     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00905"></a>00905 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00906"></a>00906 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00907"></a>00907 <span class="preprocessor">    default  (none) \</span>
<a name="l00908"></a>00908 <span class="preprocessor">    shared   (densityNumElems, densityReal, densityImag) \</span>
<a name="l00909"></a>00909 <span class="preprocessor">    private  (index) </span>
<a name="l00910"></a>00910 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00911"></a>00911 <span class="preprocessor"></span>    {
<a name="l00912"></a>00912 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00913"></a>00913 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00914"></a>00914 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00915"></a>00915 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;densityNumElems; index++) {
<a name="l00916"></a>00916             densityReal[index] = 0.0;
<a name="l00917"></a>00917             densityImag[index] = 0.0;
<a name="l00918"></a>00918         }
<a name="l00919"></a>00919     }
<a name="l00920"></a>00920     
<a name="l00921"></a>00921     <span class="comment">// index of the single density matrix elem to set non-zero</span>
<a name="l00922"></a>00922     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = 1LL &lt;&lt; qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>;
<a name="l00923"></a>00923     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityInd = (densityDim + 1)*stateInd;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="comment">// give the specified classical state prob 1</span>
<a name="l00926"></a>00926     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> == densityInd / densityNumElems){
<a name="l00927"></a>00927         densityReal[densityInd % densityNumElems] = 1.0;
<a name="l00928"></a>00928         densityImag[densityInd % densityNumElems] = 0.0;
<a name="l00929"></a>00929     }
<a name="l00930"></a>00930 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2418bd9a6b9e6a0acf11faf5982d5d29"></a><!-- doxytag: member="QuEST_internal.h::densmatr_initPlusState" ref="a2418bd9a6b9e6a0acf11faf5982d5d29" args="(Qureg targetQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>targetQureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00933">933</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00098">initPlusState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00934"></a>00934 {
<a name="l00935"></a>00935     <span class="comment">// |+&gt;&lt;+| = sum_i 1/sqrt(2^N) |i&gt; 1/sqrt(2^N) &lt;j| = sum_ij 1/2^N |i&gt;&lt;j|</span>
<a name="l00936"></a>00936     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dim = (1LL &lt;&lt; qureg.numQubitsRepresented);
<a name="l00937"></a>00937     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> probFactor = 1.0/((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>) dim);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l00940"></a>00940     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityReal = qureg.stateVec.real;
<a name="l00941"></a>00941     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *densityImag = qureg.stateVec.imag;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00944"></a>00944     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = qureg.numAmpsPerChunk;
<a name="l00945"></a>00945     <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span>
<a name="l00946"></a>00946 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00947"></a>00947 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00948"></a>00948 <span class="preprocessor">    default  (none) \</span>
<a name="l00949"></a>00949 <span class="preprocessor">    shared   (chunkSize, densityReal, densityImag, probFactor) \</span>
<a name="l00950"></a>00950 <span class="preprocessor">    private  (index) </span>
<a name="l00951"></a>00951 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00952"></a>00952 <span class="preprocessor"></span>    {
<a name="l00953"></a>00953 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00954"></a>00954 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00955"></a>00955 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00956"></a>00956 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l00957"></a>00957             densityReal[index] = probFactor;
<a name="l00958"></a>00958             densityImag[index] = 0.0;
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5ad68d054875913d0f7ec654840a9ec"></a><!-- doxytag: member="QuEST_internal.h::densmatr_initPureState" ref="ae5ad68d054875913d0f7ec654840a9ec" args="(Qureg targetQureg, Qureg copyQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPureState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>copyQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00428">428</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00379">copyVecIntoMatrixPairState()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00963">densmatr_initPureStateLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00119">initPureState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00428"></a>00428                                                                 {
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="keywordflow">if</span> (targetQureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>==1){
<a name="l00431"></a>00431         <span class="comment">// local version</span>
<a name="l00432"></a>00432         <span class="comment">// save pointers to qureg&apos;s pair state</span>
<a name="l00433"></a>00433         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* quregPairRePtr = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real;
<a name="l00434"></a>00434         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* quregPairImPtr = targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         <span class="comment">// populate qureg pair state with pure state (by repointing)</span>
<a name="l00437"></a>00437         targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l00438"></a>00438         targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440         <span class="comment">// populate density matrix via it&apos;s pairState</span>
<a name="l00441"></a>00441         <a class="code" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a>(targetQureg, copyQureg);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443         <span class="comment">// restore pointers</span>
<a name="l00444"></a>00444         targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real = quregPairRePtr;
<a name="l00445"></a>00445         targetQureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag = quregPairImPtr;
<a name="l00446"></a>00446     } <span class="keywordflow">else</span> {
<a name="l00447"></a>00447         <span class="comment">// set qureg&apos;s pairState is to be the full pure state (on every node)</span>
<a name="l00448"></a>00448         <a class="code" href="QuEST__cpu__distributed_8c.html#a95af772d87c461fc8abfd6d47b752ac2">copyVecIntoMatrixPairState</a>(targetQureg, copyQureg);
<a name="l00449"></a>00449         
<a name="l00450"></a>00450         <span class="comment">// update every density matrix chunk using pairState</span>
<a name="l00451"></a>00451         <a class="code" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a>(targetQureg, copyQureg);
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae4ebc1f4dd48922bfb30ad1692310269"></a><!-- doxytag: member="QuEST_internal.h::densmatr_measureWithStats" ref="ae4ebc1f4dd48922bfb30ad1692310269" args="(Qureg qureg, int measureQubit, qreal *outcomeProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int densmatr_measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>outcomeProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00320">320</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01231">densmatr_calcProbOfOutcome()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00634">densmatr_collapseToKnownProbOutcome()</a>, <a class="el" href="QuEST__common_8c_source.html#l00105">generateMeasurementOutcome()</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00571">measure()</a>, and <a class="el" href="QuEST_8c_source.html#l00558">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00320"></a>00320                                                                                  {
<a name="l00321"></a>00321     
<a name="l00322"></a>00322     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> zeroProb = <a class="code" href="QuEST__internal_8h.html#ad405e3fac20997043e0236b751e44270">densmatr_calcProbOfOutcome</a>(qureg, measureQubit, 0);
<a name="l00323"></a>00323     <span class="keywordtype">int</span> outcome = <a class="code" href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a>(zeroProb, outcomeProb);
<a name="l00324"></a>00324     <a class="code" href="QuEST__internal_8h.html#ab321af37fe3490253e12b7c70b8d2a98" title="Renorms (/prob) every | * outcome * &amp;gt;&amp;lt; * outcome * | state, setting all others...">densmatr_collapseToKnownProbOutcome</a>(qureg, measureQubit, outcome, *outcomeProb);
<a name="l00325"></a>00325     <span class="keywordflow">return</span> outcome;
<a name="l00326"></a>00326 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56b32228c24a7c4e1894d991ef4b6b99"></a><!-- doxytag: member="QuEST_internal.h::densmatr_oneQubitDephase" ref="a56b32228c24a7c4e1894d991ef4b6b99" args="(Qureg qureg, const int targetQubit, qreal dephase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>dephase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00036">36</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00645">applyOneQubitDephaseError()</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l02127">densmatr_oneQubitDepolarise()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00159">densmatr_oneQubitDepolariseDistributed()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00036"></a>00036                                                                                  {
<a name="l00037"></a>00037         <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> retain=1-dephase;
<a name="l00038"></a>00038     
<a name="l00039"></a>00039         <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00040"></a>00040         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;
<a name="l00041"></a>00041         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00042"></a>00042     
<a name="l00043"></a>00043         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00044"></a>00044         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;
<a name="l00045"></a>00045         <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor"> # ifdef _OPENMP</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00049"></a>00049 <span class="preprocessor">    default  (none) \</span>
<a name="l00050"></a>00050 <span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain) \</span>
<a name="l00051"></a>00051 <span class="preprocessor">    private  (thisTask,thisPattern) </span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>    {
<a name="l00054"></a>00054 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){
<a name="l00058"></a>00058             thisPattern = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMask;
<a name="l00059"></a>00059             <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){
<a name="l00060"></a>00060                 <span class="comment">// do dephase</span>
<a name="l00061"></a>00061                 <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span>
<a name="l00062"></a>00062                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask]; 
<a name="l00063"></a>00063                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask]; 
<a name="l00064"></a>00064             } 
<a name="l00065"></a>00065         }  
<a name="l00066"></a>00066     }
<a name="l00067"></a>00067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae5bf84ca607e1484e0ddb5570726848d"></a><!-- doxytag: member="QuEST_internal.h::densmatr_oneQubitDepolarise" ref="ae5bf84ca607e1484e0ddb5570726848d" args="(Qureg qureg, const int targetQubit, qreal depolLevel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDepolarise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>depolLevel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00676">676</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00246">chunkIsUpperInOuterBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00521">compressPairVectorForSingleQubitDepolarise()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00373">densityMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00036">densmatr_oneQubitDephase()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00159">densmatr_oneQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00110">densmatr_oneQubitDepolariseLocal()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00487">exchangePairStateVectorHalves()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00324">getChunkOuterBlockPairId()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00662">applyOneQubitDepolariseError()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00676"></a>00676                                                                                        {
<a name="l00677"></a>00677     <span class="keywordflow">if</span> (depolLevel == 0)
<a name="l00678"></a>00678         <span class="keywordflow">return</span>;
<a name="l00679"></a>00679     
<a name="l00680"></a>00680     <span class="keywordtype">int</span> rankIsUpper; <span class="comment">// rank is in the upper half of an outer block</span>
<a name="l00681"></a>00681     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00682"></a>00682 
<a name="l00683"></a>00683     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00684"></a>00684             qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>, targetQubit);
<a name="l00685"></a>00685 
<a name="l00686"></a>00686     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00687"></a>00687         <a class="code" href="QuEST__cpu_8c.html#a5a0dd013940cf2ea20c397a551d9b781">densmatr_oneQubitDepolariseLocal</a>(qureg, targetQubit, depolLevel);
<a name="l00688"></a>00688     } <span class="keywordflow">else</span> {
<a name="l00689"></a>00689         <span class="comment">// pack data to send to my pair process into the first half of pairStateVec</span>
<a name="l00690"></a>00690         <a class="code" href="QuEST__cpu__distributed_8c.html#a2ebf115d3bdd88f4b290b5218a5399d3">compressPairVectorForSingleQubitDepolarise</a>(qureg, targetQubit);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f" title="fix -- do with masking instead">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit, 
<a name="l00693"></a>00693                 qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00694"></a>00694         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00695"></a>00695                 targetQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00698"></a>00698         <a class="code" href="QuEST__cpu_8c.html#a48e0715ee615f2ce44477521ab760627">densmatr_oneQubitDepolariseDistributed</a>(qureg, targetQubit, depolLevel);
<a name="l00699"></a>00699     }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8fde996ce8ba014fce542549406813f9"></a><!-- doxytag: member="QuEST_internal.h::densmatr_twoQubitDephase" ref="a8fde996ce8ba014fce542549406813f9" args="(Qureg qureg, const int qubit1, const int qubit2, qreal dephase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDephase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>dephase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00069">69</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00653">applyTwoQubitDephaseError()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">densmatr_twoQubitDepolarise()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00069"></a>00069                                                                                               {
<a name="l00070"></a>00070     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> retain=1-dephase;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00073"></a>00073     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;
<a name="l00074"></a>00074     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1 = 1LL &lt;&lt; (qubit1 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00075"></a>00075     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;
<a name="l00076"></a>00076     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + (qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>));
<a name="l00077"></a>00077     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1|outerMaskQubit1;
<a name="l00078"></a>00078     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2|outerMaskQubit2;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;
<a name="l00081"></a>00081     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l00085"></a>00085 <span class="preprocessor">    default  (none) \</span>
<a name="l00086"></a>00086 <span class="preprocessor">    shared   (innerMaskQubit1,outerMaskQubit1,totMaskQubit1,innerMaskQubit2,outerMaskQubit2, \</span>
<a name="l00087"></a>00087 <span class="preprocessor">                totMaskQubit2,qureg,retain) \</span>
<a name="l00088"></a>00088 <span class="preprocessor">    private  (thisTask,thisPatternQubit1,thisPatternQubit2) </span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>    {
<a name="l00091"></a>00091 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){
<a name="l00095"></a>00095             thisPatternQubit1 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit1;
<a name="l00096"></a>00096             thisPatternQubit2 = (thisTask+qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>*qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>)&amp;totMaskQubit2;
<a name="l00097"></a>00097             
<a name="l00098"></a>00098             <span class="comment">// any mismatch |...0...&gt;&lt;...1...| etc</span>
<a name="l00099"></a>00099             <span class="keywordflow">if</span> ( (thisPatternQubit1==innerMaskQubit1) || (thisPatternQubit1==outerMaskQubit1) || 
<a name="l00100"></a>00100                     (thisPatternQubit2==innerMaskQubit2) || (thisPatternQubit2==outerMaskQubit2) ){ 
<a name="l00101"></a>00101                 <span class="comment">// do dephase</span>
<a name="l00102"></a>00102                 <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span>
<a name="l00103"></a>00103                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[thisTask]; 
<a name="l00104"></a>00104                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[thisTask]; 
<a name="l00105"></a>00105             } 
<a name="l00106"></a>00106         }  
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa500e14a9ed1683f9c056f03f4c24cea"></a><!-- doxytag: member="QuEST_internal.h::densmatr_twoQubitDepolarise" ref="aa500e14a9ed1683f9c056f03f4c24cea" args="(Qureg qureg, int qubit1, int qubit2, qreal depolLevel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_twoQubitDepolarise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>depolLevel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00703">703</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00246">chunkIsUpperInOuterBlock()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00587">compressPairVectorForTwoQubitDepolarise()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00373">densityMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00069">densmatr_twoQubitDephase()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00390">densmatr_twoQubitDepolariseDistributed()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00235">densmatr_twoQubitDepolariseLocal()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00337">densmatr_twoQubitDepolariseLocalPart1()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00481">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00487">exchangePairStateVectorHalves()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00324">getChunkOuterBlockPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00335">getChunkOuterBlockPairIdForPart3()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00086">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00670">applyTwoQubitDepolariseError()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00703"></a>00703                                                                                        {
<a name="l00704"></a>00704     <span class="keywordflow">if</span> (depolLevel == 0)
<a name="l00705"></a>00705         <span class="keywordflow">return</span>;
<a name="l00706"></a>00706     <span class="keywordtype">int</span> rankIsUpperBiggerQubit, rankIsUpperSmallerQubit;
<a name="l00707"></a>00707     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00708"></a>00708     <span class="keywordtype">int</span> biggerQubit, smallerQubit;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     <a class="code" href="QuEST__internal_8h.html#a8fde996ce8ba014fce542549406813f9">densmatr_twoQubitDephase</a>(qureg, qubit1, qubit2, depolLevel);
<a name="l00711"></a>00711     
<a name="l00712"></a>00712     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> eta = 2/depolLevel;
<a name="l00713"></a>00713     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> delta = eta - 1 - sqrt( (eta-1)*(eta-1) - 1 ); 
<a name="l00714"></a>00714     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> gamma = 1+delta;
<a name="l00715"></a>00715     gamma = 1/(gamma*gamma*gamma);
<a name="l00716"></a>00716     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> GAMMA_PARTS_1_OR_2 = 1.0;
<a name="l00717"></a>00717     <span class="comment">// TODO -- test delta too small</span>
<a name="l00718"></a>00718     <span class="comment">/*   </span>
<a name="l00719"></a>00719 <span class="comment">    if (fabs(4*delta*(1+delta)*gamma-depolLevel)&gt;1e-5){</span>
<a name="l00720"></a>00720 <span class="comment">        printf(&quot;Numerical error in delta; for small error rates try Taylor expansion.\n&quot;);</span>
<a name="l00721"></a>00721 <span class="comment">        exit(1);</span>
<a name="l00722"></a>00722 <span class="comment">    }</span>
<a name="l00723"></a>00723 <span class="comment">    */</span>
<a name="l00724"></a>00724     
<a name="l00725"></a>00725     biggerQubit = qubit1 &gt; qubit2 ? qubit1 : qubit2;
<a name="l00726"></a>00726     smallerQubit = qubit1 &lt; qubit2 ? qubit1 : qubit2;
<a name="l00727"></a>00727     <span class="keywordtype">int</span> useLocalDataOnlyBigQubit, useLocalDataOnlySmallQubit;
<a name="l00728"></a>00728 
<a name="l00729"></a>00729     useLocalDataOnlyBigQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00730"></a>00730         qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>, biggerQubit);
<a name="l00731"></a>00731     <span class="keywordflow">if</span> (useLocalDataOnlyBigQubit){
<a name="l00732"></a>00732         <span class="comment">// does parts 1, 2 and 3 locally in one go</span>
<a name="l00733"></a>00733         <a class="code" href="QuEST__cpu_8c.html#a63a1b6169f59e86988aa519b71c496fb">densmatr_twoQubitDepolariseLocal</a>(qureg, qubit1, qubit2, delta, gamma);
<a name="l00734"></a>00734     } <span class="keywordflow">else</span> {
<a name="l00735"></a>00735         useLocalDataOnlySmallQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#a076fe6125da4d6037b8bc4d912df4015">densityMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00736"></a>00736             qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>, smallerQubit);
<a name="l00737"></a>00737         <span class="keywordflow">if</span> (useLocalDataOnlySmallQubit){
<a name="l00738"></a>00738             <span class="comment">// do part 1 locally</span>
<a name="l00739"></a>00739             <a class="code" href="QuEST__cpu_8c.html#a7f8192d6f93ea1565a27a8556d48878b">densmatr_twoQubitDepolariseLocalPart1</a>(qureg, smallerQubit, biggerQubit, delta);
<a name="l00740"></a>00740             
<a name="l00741"></a>00741             <span class="comment">// do parts 2 and 3 distributed (if part 2 is distributed part 3 is also distributed)</span>
<a name="l00742"></a>00742             <span class="comment">// part 2 will be distributed and the value of the small qubit won&apos;t matter</span>
<a name="l00743"></a>00743             <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);
<a name="l00744"></a>00744             rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f" title="fix -- do with masking instead">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, biggerQubit, 
<a name="l00745"></a>00745                     qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00746"></a>00746             pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00747"></a>00747                     biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00748"></a>00748 
<a name="l00749"></a>00749             <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00750"></a>00750             <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);
<a name="l00751"></a>00751             
<a name="l00752"></a>00752             <span class="comment">// part 3 will be distributed but involve rearranging for the smaller qubit</span>
<a name="l00753"></a>00753             <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);
<a name="l00754"></a>00754             rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f" title="fix -- do with masking instead">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, biggerQubit, 
<a name="l00755"></a>00755                     qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00756"></a>00756             pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00757"></a>00757                     biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759             <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00760"></a>00760             <a class="code" href="QuEST__cpu_8c.html#ae6946456e9b7814fc565f20622b9d2e5">densmatr_twoQubitDepolariseQ1LocalQ2DistributedPart3</a>(qureg, smallerQubit, biggerQubit, delta, gamma);
<a name="l00761"></a>00761         } <span class="keywordflow">else</span> {
<a name="l00762"></a>00762             <span class="comment">// do part 1, 2 and 3 distributed</span>
<a name="l00763"></a>00763             <span class="comment">// part 1</span>
<a name="l00764"></a>00764             <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);
<a name="l00765"></a>00765             rankIsUpperSmallerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f" title="fix -- do with masking instead">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, smallerQubit, 
<a name="l00766"></a>00766                     qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00767"></a>00767             pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperSmallerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00768"></a>00768                     smallerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00769"></a>00769 
<a name="l00770"></a>00770             <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00771"></a>00771             <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);
<a name="l00772"></a>00772 
<a name="l00773"></a>00773             <span class="comment">// part 2</span>
<a name="l00774"></a>00774             <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);
<a name="l00775"></a>00775             rankIsUpperBiggerQubit = <a class="code" href="QuEST__cpu__distributed_8c.html#aa3c2d644a2be7f0d3aa9f757527d306f" title="fix -- do with masking instead">chunkIsUpperInOuterBlock</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, biggerQubit, 
<a name="l00776"></a>00776                     qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00777"></a>00777             pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ae66dc6569c6e4008c33d6739db422c08">getChunkOuterBlockPairId</a>(rankIsUpperBiggerQubit, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, 
<a name="l00778"></a>00778                     biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780             <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00781"></a>00781             <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, GAMMA_PARTS_1_OR_2);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783             <span class="comment">// part 3</span>
<a name="l00784"></a>00784             <a class="code" href="QuEST__cpu__distributed_8c.html#a13a7c39357ba9a30339d7a6171aeda8d">compressPairVectorForTwoQubitDepolarise</a>(qureg, smallerQubit, biggerQubit);
<a name="l00785"></a>00785             pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#ab1ec7f241b68b079c8e316d190af49ce">getChunkOuterBlockPairIdForPart3</a>(rankIsUpperSmallerQubit, rankIsUpperBiggerQubit, 
<a name="l00786"></a>00786                     qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, smallerQubit, biggerQubit, qureg.<a class="code" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc" title="The number of qubits represented in either the state-vector or density matrix.">numQubitsRepresented</a>);
<a name="l00787"></a>00787             <a class="code" href="QuEST__cpu__distributed_8c.html#a37dae401754961c9100b3c0907913c3e">exchangePairStateVectorHalves</a>(qureg, pairRank);
<a name="l00788"></a>00788             <a class="code" href="QuEST__cpu_8c.html#a4a51a641ea15f95481375ff76791e023">densmatr_twoQubitDepolariseDistributed</a>(qureg, smallerQubit, biggerQubit, delta, gamma);
<a name="l00789"></a>00789 
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791     }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac8ea84dd85eca525daeeb30b3c96b673"></a><!-- doxytag: member="QuEST_internal.h::ensureIndsIncrease" ref="ac8ea84dd85eca525daeeb30b3c96b673" args="(int *ind1, int *ind2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ensureIndsIncrease </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>ind1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>ind2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00027">27</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00653">applyTwoQubitDephaseError()</a>, and <a class="el" href="QuEST_8c_source.html#l00670">applyTwoQubitDepolariseError()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00027"></a>00027                                               {
<a name="l00028"></a>00028     <span class="keywordflow">if</span> (*ind1 &gt; *ind2) {
<a name="l00029"></a>00029         <span class="keywordtype">int</span> copy = *ind1;
<a name="l00030"></a>00030         *ind1 = *ind2;
<a name="l00031"></a>00031         *ind2 = copy;
<a name="l00032"></a>00032     }
<a name="l00033"></a>00033 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a73300e3cdca56a7615980274905ba097"></a><!-- doxytag: member="QuEST_internal.h::getComplexPairAndPhaseFromUnitary" ref="a73300e3cdca56a7615980274905ba097" args="(ComplexMatrix2 u, Complex *alpha, Complex *beta, qreal *globalPhase)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getComplexPairAndPhaseFromUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>globalPhase</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>maps U(r0c0, r0c1, r1c0, r1c1) to exp(i globalPhase) U(alpha, beta) </p>

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00086">86</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00265">qasm_recordControlledUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00328">qasm_recordMultiControlledUnitary()</a>, and <a class="el" href="QuEST__qasm_8c_source.html#l00194">qasm_recordUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00086"></a>00086                                                                                                             {
<a name="l00087"></a>00087     
<a name="l00088"></a>00088     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> r0c0Phase = atan2(u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);
<a name="l00089"></a>00089     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> r1c1Phase = atan2(u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, u.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);
<a name="l00090"></a>00090     *globalPhase = (r0c0Phase + r1c1Phase)/2.0;
<a name="l00091"></a>00091     
<a name="l00092"></a>00092     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosPhase = cos(*globalPhase);
<a name="l00093"></a>00093     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinPhase = sin(*globalPhase);
<a name="l00094"></a>00094     alpha-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*cosPhase + u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*sinPhase;
<a name="l00095"></a>00095     alpha-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*cosPhase - u.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*sinPhase;
<a name="l00096"></a>00096     beta-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*cosPhase + u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*sinPhase;
<a name="l00097"></a>00097     beta-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*cosPhase - u.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a>.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*sinPhase;
<a name="l00098"></a>00098 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71b3ae4402c1c5039d3086ca0e47a522"></a><!-- doxytag: member="QuEST_internal.h::getComplexPairFromRotation" ref="a71b3ae4402c1c5039d3086ca0e47a522" args="(qreal angle, Vector axis, Complex *alpha, Complex *beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getComplexPairFromRotation </td>
          <td>(</td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a> *&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00064">64</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00039">getUnitVector()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::x</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::y</a>, and <a class="el" href="QuEST_8h_source.html#l00075">Vector::z</a>.</p>

<p>Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00210">qasm_recordAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00287">qasm_recordControlledAxisRotation()</a>, <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00285">statevec_controlledRotateAroundAxisConj()</a>, <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00269">statevec_rotateAroundAxisConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00064"></a>00064                                                                                          {
<a name="l00065"></a>00065     
<a name="l00066"></a>00066     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = <a class="code" href="QuEST__common_8c.html#a041bb75200ee316de7b90667a4fe04f3">getUnitVector</a>(axis);
<a name="l00067"></a>00067     alpha-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =   cos(angle/2.0);
<a name="l00068"></a>00068     alpha-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = - sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>;  
<a name="l00069"></a>00069     beta-&gt;<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>  =   sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a>;
<a name="l00070"></a>00070     beta-&gt;<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>  = - sin(angle/2.0)*unitAxis.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a>;
<a name="l00071"></a>00071 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac711ba2f44edc3f4f286ba9e9a7d6288"></a><!-- doxytag: member="QuEST_internal.h::getConjugateMatrix" ref="ac711ba2f44edc3f4f286ba9e9a7d6288" args="(ComplexMatrix2 matr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> getConjugateMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>matr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00054">54</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00046">getConjugateScalar()</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c0</a>, <a class="el" href="QuEST_8h_source.html#l00067">ComplexMatrix2::r0c1</a>, <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c0</a>, and <a class="el" href="QuEST_8h_source.html#l00068">ComplexMatrix2::r1c1</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00252">controlledUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>, and <a class="el" href="QuEST_8c_source.html#l00240">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00054"></a>00054                                                          {
<a name="l00055"></a>00055     
<a name="l00056"></a>00056     <a class="code" href="structComplexMatrix2.html" title="Represents a 2x2 matrix of complex numbers.">ComplexMatrix2</a> conjMatrix;
<a name="l00057"></a>00057     conjMatrix.<a class="code" href="structComplexMatrix2.html#ae72b4458233b077a636beee1892e81ff">r0c0</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r0c0);
<a name="l00058"></a>00058     conjMatrix.<a class="code" href="structComplexMatrix2.html#a0f3932f055a8b05cef361bce25d51172">r0c1</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r0c1);
<a name="l00059"></a>00059     conjMatrix.<a class="code" href="structComplexMatrix2.html#ab98282015ed2065e53fbc9638e2583ab">r1c0</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r1c0);
<a name="l00060"></a>00060     conjMatrix.<a class="code" href="structComplexMatrix2.html#a763007c3070802373549ba0350f83c8a">r1c1</a> = <a class="code" href="QuEST__common_8c.html#af92fa737f4491324408b3d15543dced4">getConjugateScalar</a>(matrix.r1c1);
<a name="l00061"></a>00061     <span class="keywordflow">return</span> conjMatrix;
<a name="l00062"></a>00062 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af92fa737f4491324408b3d15543dced4"></a><!-- doxytag: member="QuEST_internal.h::getConjugateScalar" ref="af92fa737f4491324408b3d15543dced4" args="(Complex scalar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> getConjugateScalar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>scalar</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00046">46</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00280">compactUnitary()</a>, <a class="el" href="QuEST_8c_source.html#l00293">controlledCompactUnitary()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00054">getConjugateMatrix()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00046"></a>00046                                            {
<a name="l00047"></a>00047     
<a name="l00048"></a>00048     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> conjScalar;
<a name="l00049"></a>00049     conjScalar.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =   scalar.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l00050"></a>00050     conjScalar.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = - scalar.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l00051"></a>00051     <span class="keywordflow">return</span> conjScalar;
<a name="l00052"></a>00052 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3cf54148e2162b04aeb634badb90826c"></a><!-- doxytag: member="QuEST_internal.h::getVectorMagnitude" ref="a3cf54148e2162b04aeb634badb90826c" args="(Vector vec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal getVectorMagnitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>vec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00035">35</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00075">Vector::x</a>, <a class="el" href="QuEST_8h_source.html#l00075">Vector::y</a>, and <a class="el" href="QuEST_8h_source.html#l00075">Vector::z</a>.</p>

<p>Referenced by <a class="el" href="QuEST__common_8c_source.html#l00039">getUnitVector()</a>, and <a class="el" href="QuEST__validation_8c_source.html#l00192">validateVector()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00035"></a>00035                                      {
<a name="l00036"></a>00036     <span class="keywordflow">return</span> sqrt(vec.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a>*vec.<a class="code" href="structVector.html#a0d0459a5b731ac5fb3dff2c6134e6e88">x</a> + vec.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a>*vec.<a class="code" href="structVector.html#abc3cfc6c8e297b1153a373d84b981e6b">y</a> + vec.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>*vec.<a class="code" href="structVector.html#ab33976d8fda2e44b770f71269d698a25">z</a>);
<a name="l00037"></a>00037 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a404d177b894ce008289e44a599ad77d6"></a><!-- doxytag: member="QuEST_internal.h::getZYZRotAnglesFromComplexPair" ref="a404d177b894ce008289e44a599ad77d6" args="(Complex alpha, Complex beta, qreal *rz2, qreal *ry, qreal *rz1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getZYZRotAnglesFromComplexPair </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>rz2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>ry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>rz1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>maps U(alpha, beta) to Rz(rz2) Ry(ry) Rz(rz1) </p>

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00074">74</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>.</p>

<p>Referenced by <a class="el" href="QuEST__qasm_8c_source.html#l00210">qasm_recordAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00182">qasm_recordCompactUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00287">qasm_recordControlledAxisRotation()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00251">qasm_recordControlledCompactUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00265">qasm_recordControlledUnitary()</a>, <a class="el" href="QuEST__qasm_8c_source.html#l00328">qasm_recordMultiControlledUnitary()</a>, and <a class="el" href="QuEST__qasm_8c_source.html#l00194">qasm_recordUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00074"></a>00074                                                                                                     {
<a name="l00075"></a>00075     
<a name="l00076"></a>00076     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> alphaMag = sqrt(alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> + alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>);
<a name="l00077"></a>00077     *ry = 2.0 * acos(alphaMag);
<a name="l00078"></a>00078     
<a name="l00079"></a>00079     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> alphaPhase = atan2(alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alpha.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);
<a name="l00080"></a>00080     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> betaPhase  = atan2(beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>,  beta.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>);
<a name="l00081"></a>00081     *rz2 = - alphaPhase + betaPhase;
<a name="l00082"></a>00082     *rz1 = - alphaPhase - betaPhase;
<a name="l00083"></a>00083 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab76254cfde16f0808476649507a1a2fc"></a><!-- doxytag: member="QuEST_internal.h::hashString" ref="ab76254cfde16f0808476649507a1a2fc" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long int hashString </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00125">125</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST__common_8c_source.html#l00135">seedQuESTDefault()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00125"></a>00125                                        {
<a name="l00126"></a>00126     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> hash = 5381;
<a name="l00127"></a>00127     <span class="keywordtype">int</span> c;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="keywordflow">while</span> ((c = *str++))
<a name="l00130"></a>00130         hash = ((hash &lt;&lt; 5) + hash) + c; <span class="comment">/* hash * 33 + c */</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keywordflow">return</span> hash;    
<a name="l00133"></a>00133 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acf1c651a4359a370a2d9b3e1e1ebd430"></a><!-- doxytag: member="QuEST_internal.h::shiftIndices" ref="acf1c651a4359a370a2d9b3e1e1ebd430" args="(int *indices, int numIndices, int shift)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shiftIndices </td>
          <td>(</td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>shift</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00100">100</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00436">multiControlledPhaseFlip()</a>, <a class="el" href="QuEST_8c_source.html#l00386">multiControlledPhaseShift()</a>, and <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00100"></a>00100                                                            {
<a name="l00101"></a>00101     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; numIndices; j++)
<a name="l00102"></a>00102         indices[j] += shift;
<a name="l00103"></a>00103 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeeec9fe1501e25930adf6c38763a158e"></a><!-- doxytag: member="QuEST_internal.h::statevec_calcFidelity" ref="aeeec9fe1501e25930adf6c38763a158e" args="(Qureg qureg, Qureg pureState)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_calcFidelity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>pureState</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00328">328</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00041">statevec_calcInnerProduct()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00630">calcFidelity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00328"></a>00328                                                           {
<a name="l00329"></a>00329     
<a name="l00330"></a>00330     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> innerProd = <a class="code" href="QuEST__internal_8h.html#a7ebd3198a198f4cd20840f64fd8b84d0" title="Terrible code which unnecessarily individually computes and sums the real and imaginary...">statevec_calcInnerProduct</a>(qureg, pureState);
<a name="l00331"></a>00331     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> innerProdMag = innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>*innerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> + innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>*innerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l00332"></a>00332     <span class="keywordflow">return</span> innerProdMag;
<a name="l00333"></a>00333 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ebd3198a198f4cd20840f64fd8b84d0"></a><!-- doxytag: member="QuEST_internal.h::statevec_calcInnerProduct" ref="a7ebd3198a198f4cd20840f64fd8b84d0" args="(Qureg bra, Qureg ket)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcInnerProduct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>bra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>ket</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Terrible code which unnecessarily individually computes and sums the real and imaginary components of the inner product, so as to not have to worry about keeping the sums separated during reduction. </p>
<p>Truly disgusting, probably doubles runtime, please fix.  could even do the kernel twice, storing real in bra.reduc and imag in ket.reduc? </p>

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00041">41</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l01353">copySharedReduceBlock()</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00850">statevec_calcInnerProductLocal()</a>, and <a class="el" href="QuEST__gpu_8cu_source.html#l01459">swapDouble()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00606">calcInnerProduct()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00328">statevec_calcFidelity()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00041"></a>00041                                                         {
<a name="l00042"></a>00042     
<a name="l00043"></a>00043     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> localInnerProd = <a class="code" href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a>(bra, ket);
<a name="l00044"></a>00044     <span class="keywordflow">if</span> (bra.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> == 1)
<a name="l00045"></a>00045         <span class="keywordflow">return</span> localInnerProd;
<a name="l00046"></a>00046     
<a name="l00047"></a>00047     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> localReal = localInnerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l00048"></a>00048     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> localImag = localInnerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l00049"></a>00049     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> globalReal, globalImag;
<a name="l00050"></a>00050     MPI_Allreduce(&amp;localReal, &amp;globalReal, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l00051"></a>00051     MPI_Allreduce(&amp;localImag, &amp;globalImag, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l00052"></a>00052     
<a name="l00053"></a>00053     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> globalInnerProd;
<a name="l00054"></a>00054     globalInnerProd.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = globalReal;
<a name="l00055"></a>00055     globalInnerProd.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = globalImag;
<a name="l00056"></a>00056     <span class="keywordflow">return</span> globalInnerProd;
<a name="l00057"></a>00057 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab33cdf01831c4545e51299178acf7f27"></a><!-- doxytag: member="QuEST_internal.h::statevec_calcProbOfOutcome" ref="ab33cdf01831c4545e51299178acf7f27" args="(Qureg qureg, const int measureQubit, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_calcProbOfOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">1215</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01206">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l01514">statevec_findProbabilityOfZero()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02749">statevec_findProbabilityOfZeroDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02692">statevec_findProbabilityOfZeroLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00614">calcProbOfOutcome()</a>, <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00312">statevec_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01216"></a>01216 {
<a name="l01217"></a>01217     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateProb=0, totalStateProb=0;
<a name="l01218"></a>01218     <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, measureQubit);
<a name="l01219"></a>01219     <span class="keywordflow">if</span> (skipValuesWithinRank) {
<a name="l01220"></a>01220         stateProb = <a class="code" href="QuEST__cpu_8c.html#afa06d0143cea46f1e425c61ac6f6f9a2" title="Measure the total probability of a specified qubit being in the zero state across...">statevec_findProbabilityOfZeroLocal</a>(qureg, measureQubit);
<a name="l01221"></a>01221     } <span class="keywordflow">else</span> {
<a name="l01222"></a>01222         <span class="keywordflow">if</span> (!<a class="code" href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41" title="Find chunks to skip when calculating probability of qubit being zero.">isChunkToSkipInFindPZero</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, measureQubit)){
<a name="l01223"></a>01223             stateProb = <a class="code" href="QuEST__cpu_8c.html#aa2e838d65b214d266cd51ad0091ad827" title="Measure the probability of a specified qubit being in the zero state across all amplitudes...">statevec_findProbabilityOfZeroDistributed</a>(qureg, measureQubit);
<a name="l01224"></a>01224         } <span class="keywordflow">else</span> stateProb = 0;
<a name="l01225"></a>01225     }
<a name="l01226"></a>01226     MPI_Allreduce(&amp;stateProb, &amp;totalStateProb, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l01227"></a>01227     <span class="keywordflow">if</span> (outcome==1) totalStateProb = 1.0 - totalStateProb;
<a name="l01228"></a>01228     <span class="keywordflow">return</span> totalStateProb;
<a name="l01229"></a>01229 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad65ad1b5ea6f30b0c6b4ffda96e1a8e6"></a><!-- doxytag: member="QuEST_internal.h::statevec_calcTotalProb" ref="ad65ad1b5ea6f30b0c6b4ffda96e1a8e6" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_calcTotalProb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00094">94</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="README_8md_source.html#l00018">y</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00599">calcTotalProb()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00094"></a>00094                                          {
<a name="l00095"></a>00095     <span class="comment">// Implemented using Kahan summation for greater accuracy at a slight floating</span>
<a name="l00096"></a>00096     <span class="comment">//   point operation overhead. For more details see https://en.wikipedia.org/wiki/Kahan_summation_algorithm</span>
<a name="l00097"></a>00097     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> pTotal=0; 
<a name="l00098"></a>00098     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> <a class="code" href="README_8md.html#a003dc5701d53a819228f5417a8089139">y</a>, t, c;
<a name="l00099"></a>00099     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> allRankTotals=0;
<a name="l00100"></a>00100     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l00101"></a>00101     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l00102"></a>00102     c = 0.0;
<a name="l00103"></a>00103     <span class="keywordflow">for</span> (index=0; index&lt;numAmpsPerRank; index++){ 
<a name="l00104"></a>00104         <span class="comment">// Perform pTotal+=qureg.stateVec.real[index]*qureg.stateVec.real[index]; by Kahan</span>
<a name="l00105"></a>00105         y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index]*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index] - c;
<a name="l00106"></a>00106         t = pTotal + y;
<a name="l00107"></a>00107         <span class="comment">// Don&apos;t change the bracketing on the following line</span>
<a name="l00108"></a>00108         c = ( t - pTotal ) - y;
<a name="l00109"></a>00109         pTotal = t;
<a name="l00110"></a>00110         <span class="comment">// Perform pTotal+=qureg.stateVec.imag[index]*qureg.stateVec.imag[index]; by Kahan</span>
<a name="l00111"></a>00111         y = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[index]*qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[index] - c;
<a name="l00112"></a>00112         t = pTotal + y;
<a name="l00113"></a>00113         <span class="comment">// Don&apos;t change the bracketing on the following line</span>
<a name="l00114"></a>00114         c = ( t - pTotal ) - y;
<a name="l00115"></a>00115         pTotal = t;
<a name="l00116"></a>00116     } 
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>&gt;1)
<a name="l00118"></a>00118                 MPI_Allreduce(&amp;pTotal, &amp;allRankTotals, 1, MPI_QuEST_REAL, MPI_SUM, MPI_COMM_WORLD);
<a name="l00119"></a>00119     <span class="keywordflow">else</span> 
<a name="l00120"></a>00120                 allRankTotals=pTotal;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="keywordflow">return</span> allRankTotals;
<a name="l00123"></a>00123 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa4b77089145184d990848cd66993aa8b"></a><!-- doxytag: member="QuEST_internal.h::statevec_cloneQureg" ref="aa4b77089145184d990848cd66993aa8b" args="(Qureg targetQureg, Qureg copyQureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_cloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>copyQureg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>works for both statevectors and density matrices </p>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01236">1236</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00148">cloneQureg()</a>, and <a class="el" href="QuEST_8c_source.html#l00119">initPureState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01236"></a>01236                                                              {
<a name="l01237"></a>01237     
<a name="l01238"></a>01238     <span class="comment">// registers are equal sized, so nodes hold the same state-vector partitions</span>
<a name="l01239"></a>01239     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01240"></a>01240     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242     <span class="comment">// dimension of the state vector</span>
<a name="l01243"></a>01243     stateVecSize = targetQureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01246"></a>01246     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *targetStateVecReal = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01247"></a>01247     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *targetStateVecImag = targetQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01248"></a>01248     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *copyStateVecReal = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01249"></a>01249     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *copyStateVecImag = copyQureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01250"></a>01250 
<a name="l01251"></a>01251     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01252"></a>01252 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01253"></a>01253 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01254"></a>01254 <span class="preprocessor">    default  (none) \</span>
<a name="l01255"></a>01255 <span class="preprocessor">    shared   (stateVecSize, targetStateVecReal, targetStateVecImag, copyStateVecReal, copyStateVecImag) \</span>
<a name="l01256"></a>01256 <span class="preprocessor">    private  (index) </span>
<a name="l01257"></a>01257 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01258"></a>01258 <span class="preprocessor"></span>    {
<a name="l01259"></a>01259 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01260"></a>01260 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01261"></a>01261 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01262"></a>01262 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01263"></a>01263             targetStateVecReal[index] = copyStateVecReal[index];
<a name="l01264"></a>01264             targetStateVecImag[index] = copyStateVecImag[index];
<a name="l01265"></a>01265         }
<a name="l01266"></a>01266     }
<a name="l01267"></a>01267 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae7f25bb40734e18a992403b17355893b"></a><!-- doxytag: member="QuEST_internal.h::statevec_collapseToKnownProbOutcome" ref="ae7f25bb40734e18a992403b17355893b" args="(Qureg qureg, const int measureQubit, int outcome, qreal outcomeProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>outcomeProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">1253</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01206">isChunkToSkipInFindPZero()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02953">statevec_collapseToKnownProbOutcomeDistributedRenorm()</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02871">statevec_collapseToKnownProbOutcomeLocal()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02992">statevec_collapseToOutcomeDistributedSetZero()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00539">collapseToOutcome()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00312">statevec_measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01254"></a>01254 {
<a name="l01255"></a>01255     <span class="keywordtype">int</span> skipValuesWithinRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, measureQubit);
<a name="l01256"></a>01256     <span class="keywordflow">if</span> (skipValuesWithinRank) {
<a name="l01257"></a>01257         <a class="code" href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef" title="Update the state vector to be consistent with measuring measureQubit=0 if outcome=0...">statevec_collapseToKnownProbOutcomeLocal</a>(qureg, measureQubit, outcome, totalStateProb);
<a name="l01258"></a>01258     } <span class="keywordflow">else</span> {
<a name="l01259"></a>01259         <span class="keywordflow">if</span> (!<a class="code" href="QuEST__cpu__distributed_8c.html#af0ea25f00987af4c53f17c9cca62ab41" title="Find chunks to skip when calculating probability of qubit being zero.">isChunkToSkipInFindPZero</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, measureQubit)){
<a name="l01260"></a>01260             <span class="comment">// chunk has amps for q=0</span>
<a name="l01261"></a>01261             <span class="keywordflow">if</span> (outcome==0) <a class="code" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">statevec_collapseToKnownProbOutcomeDistributedRenorm</a>(qureg, measureQubit, 
<a name="l01262"></a>01262                     totalStateProb);
<a name="l01263"></a>01263             <span class="keywordflow">else</span> <a class="code" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0" title="Set all amplitudes in one chunk to 0.">statevec_collapseToOutcomeDistributedSetZero</a>(qureg);
<a name="l01264"></a>01264         } <span class="keywordflow">else</span> {
<a name="l01265"></a>01265             <span class="comment">// chunk has amps for q=1</span>
<a name="l01266"></a>01266             <span class="keywordflow">if</span> (outcome==1) <a class="code" href="QuEST__cpu_8c.html#acd82c94cfac89eacb901348ff0d06af8" title="Renormalise parts of the state vector where measureQubit=0 or 1, based on the total...">statevec_collapseToKnownProbOutcomeDistributedRenorm</a>(qureg, measureQubit, 
<a name="l01267"></a>01267                     totalStateProb);
<a name="l01268"></a>01268             <span class="keywordflow">else</span> <a class="code" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0" title="Set all amplitudes in one chunk to 0.">statevec_collapseToOutcomeDistributedSetZero</a>(qureg);
<a name="l01269"></a>01269         }
<a name="l01270"></a>01270     }
<a name="l01271"></a>01271 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a94ee4df9faba286ad7a5bc829ef5174d"></a><!-- doxytag: member="QuEST_internal.h::statevec_compactUnitary" ref="a94ee4df9faba286ad7a5bc829ef5174d" args="(Qureg qureg, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">795</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00268">getRotAngle()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01547">statevec_compactUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01418">statevec_compactUnitaryLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00280">compactUnitary()</a>, <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00269">statevec_rotateAroundAxisConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00796"></a>00796 {
<a name="l00797"></a>00797     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00798"></a>00798     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00799"></a>00799     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00802"></a>00802     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00803"></a>00803     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00806"></a>00806         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00807"></a>00807         <a class="code" href="QuEST__cpu_8c.html#aa5865e66a6e0993ae17d400c9ee0eb43">statevec_compactUnitaryLocal</a>(qureg, targetQubit, alpha, beta);
<a name="l00808"></a>00808     } <span class="keywordflow">else</span> {
<a name="l00809"></a>00809         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00810"></a>00810         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00811"></a>00811         <a class="code" href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872" title="Get rotation values for a given chunk.">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);
<a name="l00812"></a>00812         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00813"></a>00813         <span class="comment">// get corresponding values from my pair</span>
<a name="l00814"></a>00814         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. </span>
<a name="l00817"></a>00817         <span class="comment">// send values to compactUnitaryDistributed in the correct order</span>
<a name="l00818"></a>00818         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00819"></a>00819             <a class="code" href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_compactUnitaryDistributed</a>(qureg,targetQubit,rot1,rot2,
<a name="l00820"></a>00820                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00821"></a>00821                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00822"></a>00822                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00823"></a>00823         } <span class="keywordflow">else</span> {
<a name="l00824"></a>00824             <a class="code" href="QuEST__cpu_8c.html#aede1ba1fc2d189001745ee6f76f8caa7" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_compactUnitaryDistributed</a>(qureg,targetQubit,rot1,rot2,
<a name="l00825"></a>00825                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00826"></a>00826                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00827"></a>00827                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00828"></a>00828         }
<a name="l00829"></a>00829     }
<a name="l00830"></a>00830 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6cecbad32a03416138b321cdc1a2c33"></a><!-- doxytag: member="QuEST_internal.h::statevec_compareStates" ref="ae6cecbad32a03416138b321cdc1a2c33" args="(Qureg mq1, Qureg mq2, qreal precision)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>precision</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01405">1405</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00684">compareStates()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01405"></a>01405                                                                  {
<a name="l01406"></a>01406     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> diff;
<a name="l01407"></a>01407     <span class="keywordtype">int</span> chunkSize = mq1.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01408"></a>01408     
<a name="l01409"></a>01409     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){
<a name="l01410"></a>01410         diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[i]);
<a name="l01411"></a>01411         <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l01412"></a>01412         diff = absReal(mq1.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i] - mq2.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[i]);
<a name="l01413"></a>01413         <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;
<a name="l01414"></a>01414     }
<a name="l01415"></a>01415     <span class="keywordflow">return</span> 1;
<a name="l01416"></a>01416 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a47b467a5445c7f15d1a8b0b2ec0ef2de"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledCompactUnitary" ref="a47b467a5445c7f15d1a8b0b2ec0ef2de" args="(Qureg qureg, const int controlQubit, const int targetQubit, Complex alpha, Complex beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>beta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">871</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00268">getRotAngle()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01857">statevec_controlledCompactUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01648">statevec_controlledCompactUnitaryLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00293">controlledCompactUnitary()</a>, <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00285">statevec_controlledRotateAroundAxisConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00872"></a>00872 {
<a name="l00873"></a>00873     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00874"></a>00874     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00875"></a>00875     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00878"></a>00878     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00879"></a>00879     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00880"></a>00880 
<a name="l00881"></a>00881     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00882"></a>00882         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00883"></a>00883         <a class="code" href="QuEST__cpu_8c.html#a0e5527c6e144fab8062ea5296e8bdf2a">statevec_controlledCompactUnitaryLocal</a>(qureg, controlQubit, targetQubit, alpha, beta);
<a name="l00884"></a>00884     } <span class="keywordflow">else</span> {
<a name="l00885"></a>00885         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00886"></a>00886         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00887"></a>00887         <a class="code" href="QuEST__cpu__distributed_8c.html#adb4b0373425b282abed27742d0ce0872" title="Get rotation values for a given chunk.">getRotAngle</a>(rankIsUpper, &amp;rot1, &amp;rot2, alpha, beta);
<a name="l00888"></a>00888         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00889"></a>00889         <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span>
<a name="l00890"></a>00890         <span class="comment">// get corresponding values from my pair</span>
<a name="l00891"></a>00891         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to controlledCompactUnitaryDistributed</span>
<a name="l00894"></a>00894         <span class="comment">// in the correct order</span>
<a name="l00895"></a>00895         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00896"></a>00896             <a class="code" href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_controlledCompactUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,
<a name="l00897"></a>00897                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00898"></a>00898                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00899"></a>00899                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00900"></a>00900         } <span class="keywordflow">else</span> {
<a name="l00901"></a>00901             <a class="code" href="QuEST__cpu_8c.html#a5837db2f736dce21fb28dad168a23130" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_controlledCompactUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,
<a name="l00902"></a>00902                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00903"></a>00903                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00904"></a>00904                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906     }
<a name="l00907"></a>00907 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a114038296eb404b9b8a66aaad7b48800"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledNot" ref="a114038296eb404b9b8a66aaad7b48800" args="(Qureg qureg, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01015">1015</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02184">statevec_controlledNotDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02121">statevec_controlledNotLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00400">controlledNot()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01016"></a>01016 {
<a name="l01017"></a>01017     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01018"></a>01018     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01019"></a>01019     <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01020"></a>01020     <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span>
<a name="l01021"></a>01021 
<a name="l01022"></a>01022     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01023"></a>01023         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l01024"></a>01024         <a class="code" href="QuEST__cpu_8c.html#a11c9685e4ad1f44cfd6243e0c4435893">statevec_controlledNotLocal</a>(qureg, controlQubit, targetQubit);
<a name="l01025"></a>01025     } <span class="keywordflow">else</span> {
<a name="l01026"></a>01026         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01027"></a>01027         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01028"></a>01028         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01029"></a>01029         <span class="comment">// get corresponding values from my pair</span>
<a name="l01030"></a>01030         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01031"></a>01031         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block</span>
<a name="l01032"></a>01032         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l01033"></a>01033             <a class="code" href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc" title="Rotate a single qubit by {{0,1},{1,0}.">statevec_controlledNotDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01034"></a>01034                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01035"></a>01035                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//out</span>
<a name="l01036"></a>01036         } <span class="keywordflow">else</span> {
<a name="l01037"></a>01037             <a class="code" href="QuEST__cpu_8c.html#afa036cb8b502ef9a0977885ea74e41bc" title="Rotate a single qubit by {{0,1},{1,0}.">statevec_controlledNotDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01038"></a>01038                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01039"></a>01039                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//out</span>
<a name="l01040"></a>01040         }
<a name="l01041"></a>01041     }
<a name="l01042"></a>01042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a708246b16236c492094c2633da0c08ff"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledPauliY" ref="a708246b16236c492094c2633da0c08ff" args="(Qureg qureg, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01094">1094</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02366">statevec_controlledPauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02313">statevec_controlledPauliYLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00412">controlledPauliY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01095"></a>01095 {
<a name="l01096"></a>01096         <span class="keywordtype">int</span> conjFac = 1;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01099"></a>01099     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01100"></a>01100     <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01101"></a>01101     <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span>
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01104"></a>01104         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l01105"></a>01105         <a class="code" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a>(qureg, controlQubit, targetQubit, conjFac);
<a name="l01106"></a>01106     } <span class="keywordflow">else</span> {
<a name="l01107"></a>01107         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01108"></a>01108         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01109"></a>01109         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01110"></a>01110         <span class="comment">// get corresponding values from my pair</span>
<a name="l01111"></a>01111         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01112"></a>01112         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block</span>
<a name="l01113"></a>01113         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l01114"></a>01114             <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01115"></a>01115                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01116"></a>01116                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>,
<a name="l01117"></a>01117                                         conjFac); <span class="comment">//out</span>
<a name="l01118"></a>01118         } <span class="keywordflow">else</span> {
<a name="l01119"></a>01119             <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01120"></a>01120                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01121"></a>01121                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>,
<a name="l01122"></a>01122                                         conjFac); <span class="comment">//out</span>
<a name="l01123"></a>01123         }
<a name="l01124"></a>01124     }
<a name="l01125"></a>01125 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9e647339720bf82b30c6331fad544ec5"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledPauliYConj" ref="a9e647339720bf82b30c6331fad544ec5" args="(Qureg qureg, const int controlQubit, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01127">1127</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02366">statevec_controlledPauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02313">statevec_controlledPauliYLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00412">controlledPauliY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01128"></a>01128 {
<a name="l01129"></a>01129         <span class="keywordtype">int</span> conjFac = -1;
<a name="l01130"></a>01130 
<a name="l01131"></a>01131     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01132"></a>01132     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01133"></a>01133     <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01134"></a>01134     <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span>
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01137"></a>01137         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l01138"></a>01138         <a class="code" href="QuEST__cpu_8c.html#a9028deac63419d71d523f73229a7bd84">statevec_controlledPauliYLocal</a>(qureg, controlQubit, targetQubit, conjFac);
<a name="l01139"></a>01139     } <span class="keywordflow">else</span> {
<a name="l01140"></a>01140         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01141"></a>01141         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01142"></a>01142         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01143"></a>01143         <span class="comment">// get corresponding values from my pair</span>
<a name="l01144"></a>01144         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01145"></a>01145         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block</span>
<a name="l01146"></a>01146         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l01147"></a>01147             <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01148"></a>01148                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01149"></a>01149                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>,
<a name="l01150"></a>01150                                         conjFac); <span class="comment">//out</span>
<a name="l01151"></a>01151         } <span class="keywordflow">else</span> {
<a name="l01152"></a>01152             <a class="code" href="QuEST__cpu_8c.html#a85014e8266bebf037bc2d66f80ca5936">statevec_controlledPauliYDistributed</a>(qureg,controlQubit,targetQubit,
<a name="l01153"></a>01153                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//in</span>
<a name="l01154"></a>01154                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>,
<a name="l01155"></a>01155                                         conjFac); <span class="comment">//out</span>
<a name="l01156"></a>01156         }
<a name="l01157"></a>01157     }
<a name="l01158"></a>01158 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c0067cb9f243ead20de7392aea328bc"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledPhaseFlip" ref="a7c0067cb9f243ead20de7392aea328bc" args="(Qureg qureg, const int idQubit1, const int idQubit2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02789">2789</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00424">controlledPhaseFlip()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02790"></a>02790 {
<a name="l02791"></a>02791     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02792"></a>02792     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02793"></a>02793     <span class="keywordtype">int</span> bit1, bit2;
<a name="l02794"></a>02794 
<a name="l02795"></a>02795     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02796"></a>02796     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02797"></a>02797     
<a name="l02798"></a>02798     <span class="comment">// dimension of the state vector</span>
<a name="l02799"></a>02799     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02800"></a>02800     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02801"></a>02801     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02802"></a>02802 
<a name="l02803"></a>02803 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02804"></a>02804 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02805"></a>02805 <span class="preprocessor">    default  (none)              \</span>
<a name="l02806"></a>02806 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02807"></a>02807 <span class="preprocessor">    private  (index,bit1,bit2)             \</span>
<a name="l02808"></a>02808 <span class="preprocessor">    schedule (static)</span>
<a name="l02809"></a>02809 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02810"></a>02810 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02811"></a>02811         bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l02812"></a>02812         bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l02813"></a>02813         <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l02814"></a>02814             stateVecReal [index] = - stateVecReal [index];
<a name="l02815"></a>02815             stateVecImag [index] = - stateVecImag [index];
<a name="l02816"></a>02816         }
<a name="l02817"></a>02817     }
<a name="l02818"></a>02818 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adeb715f3f2c167f9bfbe92b75f5988ce"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledPhaseShift" ref="adeb715f3f2c167f9bfbe92b75f5988ce" args="(Qureg qureg, const int idQubit1, const int idQubit2, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02554">2554</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00374">controlledPhaseShift()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02555"></a>02555 {
<a name="l02556"></a>02556     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02557"></a>02557     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02558"></a>02558     <span class="keywordtype">int</span> bit1, bit2;
<a name="l02559"></a>02559     
<a name="l02560"></a>02560     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02561"></a>02561     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02562"></a>02562 
<a name="l02563"></a>02563     <span class="comment">// dimension of the state vector</span>
<a name="l02564"></a>02564     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02565"></a>02565     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02566"></a>02566     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02567"></a>02567     
<a name="l02568"></a>02568     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02569"></a>02569     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = cos(angle);
<a name="l02570"></a>02570     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = sin(angle);
<a name="l02571"></a>02571 
<a name="l02572"></a>02572 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02573"></a>02573 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02574"></a>02574 <span class="preprocessor">    default  (none)              \</span>
<a name="l02575"></a>02575 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02576"></a>02576 <span class="preprocessor">    private  (index,bit1,bit2,stateRealLo,stateImagLo)             \</span>
<a name="l02577"></a>02577 <span class="preprocessor">    schedule (static)</span>
<a name="l02578"></a>02578 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02579"></a>02579 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02580"></a>02580         bit1 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit1, index+chunkId*chunkSize);
<a name="l02581"></a>02581         bit2 = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (idQubit2, index+chunkId*chunkSize);
<a name="l02582"></a>02582         <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {
<a name="l02583"></a>02583             
<a name="l02584"></a>02584             stateRealLo = stateVecReal[index];
<a name="l02585"></a>02585             stateImagLo = stateVecImag[index];
<a name="l02586"></a>02586             
<a name="l02587"></a>02587             stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02588"></a>02588             stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02589"></a>02589         }
<a name="l02590"></a>02590     }
<a name="l02591"></a>02591 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2c489375aad6fb71203553c60bff043b"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledRotateAroundAxis" ref="a2c489375aad6fb71203553c60bff043b" args="(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00278">278</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00463">controlledRotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00294">statevec_controlledRotateX()</a>, <a class="el" href="QuEST__common_8c_source.html#l00300">statevec_controlledRotateY()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00306">statevec_controlledRotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00278"></a>00278                                                                                                                               {
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00281"></a>00281     <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);
<a name="l00282"></a>00282     <a class="code" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a>(qureg, controlQubit, targetQubit, alpha, beta);
<a name="l00283"></a>00283 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeb4ddeb09a3c0fa39ac33984bd5ca0ea"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledRotateAroundAxisConj" ref="aeb4ddeb09a3c0fa39ac33984bd5ca0ea" args="(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateAroundAxisConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00285">285</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00871">statevec_controlledCompactUnitary()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00463">controlledRotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00285"></a>00285                                                                                                                                   {
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00288"></a>00288     <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);
<a name="l00289"></a>00289     alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1; 
<a name="l00290"></a>00290     beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1;
<a name="l00291"></a>00291     <a class="code" href="QuEST__internal_8h.html#a47b467a5445c7f15d1a8b0b2ec0ef2de">statevec_controlledCompactUnitary</a>(qureg, controlQubit, targetQubit, alpha, beta);
<a name="l00292"></a>00292 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af59bc61f97d42cdceaf7fc0257a387d6"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledRotateX" ref="af59bc61f97d42cdceaf7fc0257a387d6" args="(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00294">294</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00204">controlledRotateX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00294"></a>00294                                                                                                         {
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {1, 0, 0};
<a name="l00297"></a>00297     <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);
<a name="l00298"></a>00298 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad2dc0754043172e0449c78569d27fd4a"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledRotateY" ref="ad2dc0754043172e0449c78569d27fd4a" args="(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00300">300</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00216">controlledRotateY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00300"></a>00300                                                                                                         {
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 1, 0};
<a name="l00303"></a>00303     <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);
<a name="l00304"></a>00304 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a06bffb653fa42a67254d034b6cce6d7d"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledRotateZ" ref="a06bffb653fa42a67254d034b6cce6d7d" args="(Qureg qureg, const int controlQubit, const int targetQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00306">306</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00278">statevec_controlledRotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00228">controlledRotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00306"></a>00306                                                                                                         {
<a name="l00307"></a>00307 
<a name="l00308"></a>00308     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 0, 1};
<a name="l00309"></a>00309     <a class="code" href="QuEST__common_8c.html#a2c489375aad6fb71203553c60bff043b">statevec_controlledRotateAroundAxis</a>(qureg, controlQubit, targetQubit, angle, unitAxis);
<a name="l00310"></a>00310 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2600999a19c817bfcf7ca14779e33b9a"></a><!-- doxytag: member="QuEST_internal.h::statevec_controlledUnitary" ref="a2600999a19c817bfcf7ca14779e33b9a" args="(Qureg qureg, const int controlQubit, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00909">909</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01920">statevec_controlledUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01778">statevec_controlledUnitaryLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00252">controlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00911"></a>00911 {
<a name="l00912"></a>00912     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00913"></a>00913     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00914"></a>00914     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00915"></a>00915 
<a name="l00916"></a>00916     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00917"></a>00917     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00918"></a>00918     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00919"></a>00919 
<a name="l00920"></a>00920     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00921"></a>00921         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00922"></a>00922         <a class="code" href="QuEST__cpu_8c.html#ac0c120ac374b402c576c4b38bcda9992">statevec_controlledUnitaryLocal</a>(qureg, controlQubit, targetQubit, u);
<a name="l00923"></a>00923     } <span class="keywordflow">else</span> {
<a name="l00924"></a>00924         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00925"></a>00925         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00926"></a>00926         <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00927"></a>00927         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00928"></a>00928         <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span>
<a name="l00929"></a>00929         <span class="comment">// get corresponding values from my pair</span>
<a name="l00930"></a>00930         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to controlledUnitaryDistributed</span>
<a name="l00933"></a>00933         <span class="comment">// in the correct order</span>
<a name="l00934"></a>00934         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00935"></a>00935             <a class="code" href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_controlledUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,
<a name="l00936"></a>00936                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00937"></a>00937                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00938"></a>00938                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00939"></a>00939         } <span class="keywordflow">else</span> {
<a name="l00940"></a>00940             <a class="code" href="QuEST__cpu_8c.html#a4f77ef0be5137ed64321c2d6d14d8035" title="Rotate a single qubit in the state vector of probability amplitudes, given two complex...">statevec_controlledUnitaryDistributed</a>(qureg,controlQubit,targetQubit,rot1,rot2,
<a name="l00941"></a>00941                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00942"></a>00942                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00943"></a>00943                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945     }
<a name="l00946"></a>00946 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a365bbb1b80cb00405c8bf1a4fa1ea8e5"></a><!-- doxytag: member="QuEST_internal.h::statevec_createQureg" ref="a365bbb1b80cb00405c8bf1a4fa1ea8e5" args="(Qureg *qureg, int numQubits, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_createQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01058">1058</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::firstLevelReduction</a>, <a class="el" href="QuEST_8h_source.html#l00084">Qureg::isDensityMatrix</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00093">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00119">QuESTEnv::rank</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00015">REDUCE_SHARED_SIZE</a>, <a class="el" href="QuEST_8h_source.html#l00107">Qureg::secondLevelReduction</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00042">createDensityQureg()</a>, and <a class="el" href="QuEST_8c_source.html#l00028">createQureg()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01059"></a>01059 {
<a name="l01060"></a>01060     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1L &lt;&lt; numQubits;
<a name="l01061"></a>01061     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real)));
<a name="l01064"></a>01064     qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag)));
<a name="l01065"></a>01065     <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l01066"></a>01066         qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real)));
<a name="l01067"></a>01067         qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag = malloc(numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag)));
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070     <span class="keywordflow">if</span> ( (!(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag))
<a name="l01071"></a>01071             &amp;&amp; numAmpsPerRank ) {
<a name="l01072"></a>01072         printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l01073"></a>01073         exit (EXIT_FAILURE);
<a name="l01074"></a>01074     }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076     <span class="keywordflow">if</span> ( env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1 &amp;&amp; (!(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real) || !(qureg-&gt;<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag))
<a name="l01077"></a>01077             &amp;&amp; numAmpsPerRank ) {
<a name="l01078"></a>01078         printf(<span class="stringliteral">&quot;Could not allocate memory!&quot;</span>);
<a name="l01079"></a>01079         exit (EXIT_FAILURE);
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082     qureg-&gt;<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218" title="Number of qubits in the state-vector - this is double the number represented for...">numQubitsInStateVec</a> = numQubits;
<a name="l01083"></a>01083     qureg-&gt;<a class="code" href="structQureg.html#adef4935cac95763c29164cf99b144ed4" title="Total number of amplitudes, which are possibly distributed among machines.">numAmpsTotal</a> = numAmps;
<a name="l01084"></a>01084     qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a> = numAmpsPerRank;
<a name="l01085"></a>01085     qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> = env.<a class="code" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;
<a name="l01086"></a>01086     qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a> = env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;
<a name="l01087"></a>01087     qureg-&gt;<a class="code" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79" title="Whether this instance is a density-state representation.">isDensityMatrix</a> = 0;
<a name="l01088"></a>01088 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2a52ad9f9ad9b2fd6a76f6d433b3b217"></a><!-- doxytag: member="QuEST_internal.h::statevec_destroyQureg" ref="a2a52ad9f9ad9b2fd6a76f6d433b3b217" args="(Qureg qureg, QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01090">1090</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00120">QuESTEnv::numRanks</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00056">destroyQureg()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01090"></a>01090                                                      {
<a name="l01091"></a>01091     
<a name="l01092"></a>01092     free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real);
<a name="l01093"></a>01093     free(qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag);
<a name="l01094"></a>01094     <span class="keywordflow">if</span> (env.<a class="code" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){
<a name="l01095"></a>01095         free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.real);
<a name="l01096"></a>01096         free(qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>.imag);
<a name="l01097"></a>01097     }    
<a name="l01098"></a>01098 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abd509244d57657e148e4084c5ab5d28f"></a><!-- doxytag: member="QuEST_internal.h::statevec_getImagAmp" ref="abd509244d57657e148e4084c5ab5d28f" args="(Qureg qureg, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_getImagAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00218">218</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00204">getChunkIdFromIndex()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00512">getAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00522">getDensityAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00498">getImagAmp()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00167">statevec_getProbAmp()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00218"></a>00218                                                            {
<a name="l00219"></a>00219     <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a>(qureg, index);
<a name="l00220"></a>00220     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> el; 
<a name="l00221"></a>00221     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==chunkId){
<a name="l00222"></a>00222         el = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[index-chunkId*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>];
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224     MPI_Bcast(&amp;el, 1, MPI_QuEST_REAL, chunkId, MPI_COMM_WORLD);
<a name="l00225"></a>00225     <span class="keywordflow">return</span> el; 
<a name="l00226"></a>00226 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3afe58e49dce5536bc4c1b7caddf44a6"></a><!-- doxytag: member="QuEST_internal.h::statevec_getProbAmp" ref="a3afe58e49dce5536bc4c1b7caddf44a6" args="(Qureg qureg, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_getProbAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00167">167</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00218">statevec_getImagAmp()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00208">statevec_getRealAmp()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00505">getProbAmp()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00167"></a>00167                                                            {
<a name="l00168"></a>00168     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> real = <a class="code" href="QuEST__internal_8h.html#abc9a9ef4344c7faaaf28ac25c76649b9">statevec_getRealAmp</a>(qureg, index);
<a name="l00169"></a>00169     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> imag = <a class="code" href="QuEST__internal_8h.html#abd509244d57657e148e4084c5ab5d28f">statevec_getImagAmp</a>(qureg, index);
<a name="l00170"></a>00170     <span class="keywordflow">return</span> real*real + imag*imag;
<a name="l00171"></a>00171 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abc9a9ef4344c7faaaf28ac25c76649b9"></a><!-- doxytag: member="QuEST_internal.h::statevec_getRealAmp" ref="abc9a9ef4344c7faaaf28ac25c76649b9" args="(Qureg qureg, long long int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">qreal statevec_getRealAmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00208">208</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00204">getChunkIdFromIndex()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00512">getAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00522">getDensityAmp()</a>, <a class="el" href="QuEST_8c_source.html#l00491">getRealAmp()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00167">statevec_getProbAmp()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00208"></a>00208                                                            {
<a name="l00209"></a>00209     <span class="keywordtype">int</span> chunkId = <a class="code" href="QuEST__cpu__distributed_8c.html#a28be36627b2dd9a0da63dd6f60121b06">getChunkIdFromIndex</a>(qureg, index);
<a name="l00210"></a>00210     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> el; 
<a name="l00211"></a>00211     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==chunkId){
<a name="l00212"></a>00212         el = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index-chunkId*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>];
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214     MPI_Bcast(&amp;el, 1, MPI_QuEST_REAL, chunkId, MPI_COMM_WORLD);
<a name="l00215"></a>00215     <span class="keywordflow">return</span> el; 
<a name="l00216"></a>00216 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9226f386d010aaa85efc0e8889d341d5"></a><!-- doxytag: member="QuEST_internal.h::statevec_hadamard" ref="a9226f386d010aaa85efc0e8889d341d5" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamard </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01160">1160</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02468">statevec_hadamardDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02407">statevec_hadamardLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00160">hadamard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01161"></a>01161 {
<a name="l01162"></a>01162     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01163"></a>01163     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01164"></a>01164 
<a name="l01165"></a>01165     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01166"></a>01166     <span class="keywordtype">int</span> rankIsUpper;
<a name="l01167"></a>01167     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l01168"></a>01168 
<a name="l01169"></a>01169     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01170"></a>01170         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l01171"></a>01171         <a class="code" href="QuEST__cpu_8c.html#a24f9ade18290c82bbb2c4a706b3d5999">statevec_hadamardLocal</a>(qureg, targetQubit);
<a name="l01172"></a>01172     } <span class="keywordflow">else</span> {
<a name="l01173"></a>01173         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01174"></a>01174         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01175"></a>01175         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01176"></a>01176         <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span>
<a name="l01177"></a>01177         <span class="comment">// get corresponding values from my pair</span>
<a name="l01178"></a>01178         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01179"></a>01179         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to hadamardDistributed</span>
<a name="l01180"></a>01180         <span class="comment">// in the correct order</span>
<a name="l01181"></a>01181         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l01182"></a>01182             <a class="code" href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab" title="Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.">statevec_hadamardDistributed</a>(qureg,targetQubit,
<a name="l01183"></a>01183                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l01184"></a>01184                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l01185"></a>01185                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, rankIsUpper); <span class="comment">//output</span>
<a name="l01186"></a>01186         } <span class="keywordflow">else</span> {
<a name="l01187"></a>01187             <a class="code" href="QuEST__cpu_8c.html#a4271beeba4f1bec3556779aab318cdab" title="Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.">statevec_hadamardDistributed</a>(qureg,targetQubit,
<a name="l01188"></a>01188                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l01189"></a>01189                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l01190"></a>01190                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, rankIsUpper); <span class="comment">//output</span>
<a name="l01191"></a>01191         }
<a name="l01192"></a>01192     }
<a name="l01193"></a>01193 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a288dc4b46bdacd69cbf4a6fd070d26a7"></a><!-- doxytag: member="QuEST_internal.h::statevec_initClassicalState" ref="a288dc4b46bdacd69cbf4a6fd070d26a7" args="(Qureg qureg, long long int stateInd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>stateInd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01200">1200</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00107">initClassicalState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01201"></a>01201 {
<a name="l01202"></a>01202     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01203"></a>01203     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205     <span class="comment">// dimension of the state vector</span>
<a name="l01206"></a>01206     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01207"></a>01207 
<a name="l01208"></a>01208     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01209"></a>01209     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01210"></a>01210     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01211"></a>01211 
<a name="l01212"></a>01212     <span class="comment">// initialise the state to vector to all zeros</span>
<a name="l01213"></a>01213 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01214"></a>01214 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01215"></a>01215 <span class="preprocessor">    default  (none) \</span>
<a name="l01216"></a>01216 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l01217"></a>01217 <span class="preprocessor">    private  (index) </span>
<a name="l01218"></a>01218 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01219"></a>01219 <span class="preprocessor"></span>    {
<a name="l01220"></a>01220 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01221"></a>01221 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01222"></a>01222 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01223"></a>01223 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01224"></a>01224             stateVecReal[index] = 0.0;
<a name="l01225"></a>01225             stateVecImag[index] = 0.0;
<a name="l01226"></a>01226         }
<a name="l01227"></a>01227     }
<a name="l01228"></a>01228 
<a name="l01229"></a>01229     <span class="comment">// give the specified classical state prob 1</span>
<a name="l01230"></a>01230     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a> == stateInd/stateVecSize){
<a name="l01231"></a>01231         stateVecReal[stateInd % stateVecSize] = 1.0;
<a name="l01232"></a>01232         stateVecImag[stateInd % stateVecSize] = 0.0;
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a482fc361fd5f08075404c72e536316a0"></a><!-- doxytag: member="QuEST_internal.h::statevec_initPlusState" ref="a482fc361fd5f08075404c72e536316a0" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01168">1168</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00098">initPlusState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01169"></a>01169 {
<a name="l01170"></a>01170     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01171"></a>01171     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01172"></a>01172 
<a name="l01173"></a>01173     <span class="comment">// dimension of the state vector</span>
<a name="l01174"></a>01174     chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01175"></a>01175     stateVecSize = chunkSize*qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01176"></a>01176     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>)stateVecSize);
<a name="l01177"></a>01177 
<a name="l01178"></a>01178     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01179"></a>01179     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01180"></a>01180     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01181"></a>01181 
<a name="l01182"></a>01182     <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span>
<a name="l01183"></a>01183 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01184"></a>01184 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01185"></a>01185 <span class="preprocessor">    default  (none) \</span>
<a name="l01186"></a>01186 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span>
<a name="l01187"></a>01187 <span class="preprocessor">    private  (index) </span>
<a name="l01188"></a>01188 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01189"></a>01189 <span class="preprocessor"></span>    {
<a name="l01190"></a>01190 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01191"></a>01191 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01192"></a>01192 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01193"></a>01193 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01194"></a>01194             stateVecReal[index] = normFactor;
<a name="l01195"></a>01195             stateVecImag[index] = 0.0;
<a name="l01196"></a>01196         }
<a name="l01197"></a>01197     }
<a name="l01198"></a>01198 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a38445cdb2a18671a7c73112ce3337acb"></a><!-- doxytag: member="QuEST_internal.h::statevec_initStateDebug" ref="a38445cdb2a18671a7c73112ce3337acb" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateDebug </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p>For debugging processes </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01321">1321</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00689">initStateDebug()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01322"></a>01322 {
<a name="l01323"></a>01323     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;
<a name="l01324"></a>01324     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01325"></a>01325     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;
<a name="l01326"></a>01326 
<a name="l01327"></a>01327     <span class="comment">// dimension of the state vector</span>
<a name="l01328"></a>01328     chunkSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01329"></a>01329 
<a name="l01330"></a>01330     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01331"></a>01331     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01332"></a>01332     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01333"></a>01333 
<a name="l01334"></a>01334     indexOffset = chunkSize * qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01335"></a>01335 
<a name="l01336"></a>01336     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01337"></a>01337 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01338"></a>01338 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01339"></a>01339 <span class="preprocessor">    default  (none) \</span>
<a name="l01340"></a>01340 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span>
<a name="l01341"></a>01341 <span class="preprocessor">    private  (index) </span>
<a name="l01342"></a>01342 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01343"></a>01343 <span class="preprocessor"></span>    {
<a name="l01344"></a>01344 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01345"></a>01345 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01346"></a>01346 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01347"></a>01347 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01348"></a>01348             stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;
<a name="l01349"></a>01349             stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;
<a name="l01350"></a>01350         }
<a name="l01351"></a>01351     }
<a name="l01352"></a>01352 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05756b45f10135bb2eeb07380f806c20"></a><!-- doxytag: member="QuEST_internal.h::statevec_initStateFromSingleFile" ref="a05756b45f10135bb2eeb07380f806c20" args="(Qureg *qureg, char filename[200], QuESTEnv env)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_initStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01355">1355</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00277">copyStateToGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00693">initStateFromSingleFile()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01355"></a>01355                                                                                     {
<a name="l01356"></a>01356     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01357"></a>01357     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;
<a name="l01358"></a>01358 
<a name="l01359"></a>01359     chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01360"></a>01360     stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01361"></a>01361 
<a name="l01362"></a>01362     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01363"></a>01363     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01364"></a>01364 
<a name="l01365"></a>01365     FILE *fp;
<a name="l01366"></a>01366     <span class="keywordtype">char</span> line[200];
<a name="l01367"></a>01367 
<a name="l01368"></a>01368     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>); rank++){
<a name="l01369"></a>01369         <span class="keywordflow">if</span> (rank==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l01370"></a>01370             fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l01371"></a>01371             
<a name="l01372"></a>01372             <span class="comment">// indicate file open failure</span>
<a name="l01373"></a>01373             <span class="keywordflow">if</span> (fp == NULL)
<a name="l01374"></a>01374                 <span class="keywordflow">return</span> 0;
<a name="l01375"></a>01375             
<a name="l01376"></a>01376             indexInChunk = 0; totalIndex = 0;
<a name="l01377"></a>01377             <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){
<a name="l01378"></a>01378                 <span class="keywordflow">if</span> (line[0]!=<span class="charliteral">&apos;#&apos;</span>){
<a name="l01379"></a>01379                     <span class="keywordtype">int</span> chunkId = totalIndex/chunkSize;
<a name="l01380"></a>01380                     <span class="keywordflow">if</span> (chunkId==qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>){
<a name="l01381"></a>01381 <span class="preprocessor">                        # if QuEST_PREC==1</span>
<a name="l01382"></a>01382 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%f, %f&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01383"></a>01383                                 &amp;(stateVecImag[indexInChunk])); 
<a name="l01384"></a>01384 <span class="preprocessor">                        # elif QuEST_PREC==2                    </span>
<a name="l01385"></a>01385 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%lf, %lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01386"></a>01386                                 &amp;(stateVecImag[indexInChunk]));
<a name="l01387"></a>01387 <span class="preprocessor">                        # elif QuEST_PREC==4</span>
<a name="l01388"></a>01388 <span class="preprocessor"></span>                        sscanf(line, <span class="stringliteral">&quot;%Lf, %Lf&quot;</span>, &amp;(stateVecReal[indexInChunk]), 
<a name="l01389"></a>01389                                 &amp;(stateVecImag[indexInChunk]));
<a name="l01390"></a>01390 <span class="preprocessor">                        # endif</span>
<a name="l01391"></a>01391 <span class="preprocessor"></span>                        indexInChunk += 1;
<a name="l01392"></a>01392                     }
<a name="l01393"></a>01393                     totalIndex += 1;
<a name="l01394"></a>01394                 }
<a name="l01395"></a>01395             }   
<a name="l01396"></a>01396             fclose(fp);
<a name="l01397"></a>01397         }
<a name="l01398"></a>01398         <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l01399"></a>01399     }
<a name="l01400"></a>01400     
<a name="l01401"></a>01401     <span class="comment">// indicate success</span>
<a name="l01402"></a>01402     <span class="keywordflow">return</span> 1;
<a name="l01403"></a>01403 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a923906770cac0da9e3459bae58de9e64"></a><!-- doxytag: member="QuEST_internal.h::statevec_initStateOfSingleQubit" ref="a923906770cac0da9e3459bae58de9e64" args="(Qureg *qureg, int qubitId, int outcome)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>outcome</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>qureg</em>&nbsp;</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>qubitId</em>&nbsp;</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01275">1275</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00698">initStateOfSingleQubit()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01276"></a>01276 {
<a name="l01277"></a>01277     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;
<a name="l01278"></a>01278     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01279"></a>01279     <span class="keywordtype">int</span> bit;
<a name="l01280"></a>01280     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg-&gt;<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l01281"></a>01281 
<a name="l01282"></a>01282     <span class="comment">// dimension of the state vector</span>
<a name="l01283"></a>01283     chunkSize = qureg-&gt;<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01284"></a>01284     stateVecSize = chunkSize*qureg-&gt;<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>;
<a name="l01285"></a>01285     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> normFactor = 1.0/sqrt((<a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>)stateVecSize/2.0);
<a name="l01286"></a>01286 
<a name="l01287"></a>01287     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01288"></a>01288     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01289"></a>01289     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg-&gt;<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01290"></a>01290 
<a name="l01291"></a>01291     <span class="comment">// initialise the state to |0000..0000&gt;</span>
<a name="l01292"></a>01292 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01293"></a>01293 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01294"></a>01294 <span class="preprocessor">    default  (none) \</span>
<a name="l01295"></a>01295 <span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome) \</span>
<a name="l01296"></a>01296 <span class="preprocessor">    private  (index, bit) </span>
<a name="l01297"></a>01297 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01298"></a>01298 <span class="preprocessor"></span>    {
<a name="l01299"></a>01299 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01300"></a>01300 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01302"></a>01302 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {
<a name="l01303"></a>01303             bit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a>(qubitId, index+chunkId*chunkSize);
<a name="l01304"></a>01304             <span class="keywordflow">if</span> (bit==outcome) {
<a name="l01305"></a>01305                 stateVecReal[index] = normFactor;
<a name="l01306"></a>01306                 stateVecImag[index] = 0.0;
<a name="l01307"></a>01307             } <span class="keywordflow">else</span> {
<a name="l01308"></a>01308                 stateVecReal[index] = 0.0;
<a name="l01309"></a>01309                 stateVecImag[index] = 0.0;
<a name="l01310"></a>01310             }
<a name="l01311"></a>01311         }
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ca0c6ba07ab2b4b437321bf17efc966"></a><!-- doxytag: member="QuEST_internal.h::statevec_initZeroState" ref="a2ca0c6ba07ab2b4b437321bf17efc966" args="(Qureg qureg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initZeroState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01132">1132</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00092">initZeroState()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01133"></a>01133 {
<a name="l01134"></a>01134     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l01135"></a>01135     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137     <span class="comment">// dimension of the state vector</span>
<a name="l01138"></a>01138     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01139"></a>01139 
<a name="l01140"></a>01140     <span class="comment">// Can&apos;t use qureg-&gt;stateVec as a private OMP var</span>
<a name="l01141"></a>01141     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01142"></a>01142     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01143"></a>01143 
<a name="l01144"></a>01144     <span class="comment">// initialise the state-vector to all-zeroes</span>
<a name="l01145"></a>01145 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01146"></a>01146 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01147"></a>01147 <span class="preprocessor">    default  (none) \</span>
<a name="l01148"></a>01148 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span>
<a name="l01149"></a>01149 <span class="preprocessor">    private  (index) </span>
<a name="l01150"></a>01150 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01151"></a>01151 <span class="preprocessor"></span>    {
<a name="l01152"></a>01152 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01153"></a>01153 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01154"></a>01154 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01155"></a>01155 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l01156"></a>01156             stateVecReal[index] = 0.0;
<a name="l01157"></a>01157             stateVecImag[index] = 0.0;
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159     }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==0){
<a name="l01162"></a>01162         <span class="comment">// zero state |0000..0000&gt; has probability 1</span>
<a name="l01163"></a>01163         stateVecReal[0] = 1.0;
<a name="l01164"></a>01164         stateVecImag[0] = 0.0;
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac2eb81c71d0e0fbec7be5b45b1db1448"></a><!-- doxytag: member="QuEST_internal.h::statevec_measureWithStats" ref="ac2eb81c71d0e0fbec7be5b45b1db1448" args="(Qureg qureg, int measureQubit, qreal *outcomeProb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_measureWithStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>outcomeProb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00312">312</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00105">generateMeasurementOutcome()</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01215">statevec_calcProbOfOutcome()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01253">statevec_collapseToKnownProbOutcome()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00571">measure()</a>, and <a class="el" href="QuEST_8c_source.html#l00558">measureWithStats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00312"></a>00312                                                                                  {
<a name="l00313"></a>00313     
<a name="l00314"></a>00314     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> zeroProb = <a class="code" href="QuEST__internal_8h.html#ab33cdf01831c4545e51299178acf7f27">statevec_calcProbOfOutcome</a>(qureg, measureQubit, 0);
<a name="l00315"></a>00315     <span class="keywordtype">int</span> outcome = <a class="code" href="QuEST__common_8c.html#a9d19fc690afb425d0df5feb09be567a3">generateMeasurementOutcome</a>(zeroProb, outcomeProb);
<a name="l00316"></a>00316     <a class="code" href="QuEST__internal_8h.html#ae7f25bb40734e18a992403b17355893b">statevec_collapseToKnownProbOutcome</a>(qureg, measureQubit, outcome, *outcomeProb);
<a name="l00317"></a>00317     <span class="keywordflow">return</span> outcome;
<a name="l00318"></a>00318 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac4ee5979d475e8c729294b8ef7e0270d"></a><!-- doxytag: member="QuEST_internal.h::statevec_multiControlledPhaseFlip" ref="ac4ee5979d475e8c729294b8ef7e0270d" args="(Qureg qureg, int *controlQubits, int numControlQubits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02820">2820</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00436">multiControlledPhaseFlip()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02821"></a>02821 {
<a name="l02822"></a>02822     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02823"></a>02823     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02824"></a>02824 
<a name="l02825"></a>02825     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02826"></a>02826     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02827"></a>02827 
<a name="l02828"></a>02828     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l02829"></a>02829     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++)
<a name="l02830"></a>02830         mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l02831"></a>02831 
<a name="l02832"></a>02832     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02833"></a>02833     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02834"></a>02834     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02835"></a>02835 
<a name="l02836"></a>02836 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02837"></a>02837 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02838"></a>02838 <span class="preprocessor">    default  (none)              \</span>
<a name="l02839"></a>02839 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask ) \</span>
<a name="l02840"></a>02840 <span class="preprocessor">    private  (index)</span>
<a name="l02841"></a>02841 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02842"></a>02842 <span class="preprocessor"></span>    {
<a name="l02843"></a>02843 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02844"></a>02844 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02845"></a>02845 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02846"></a>02846 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02847"></a>02847             <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l02848"></a>02848                 stateVecReal [index] = - stateVecReal [index];
<a name="l02849"></a>02849                 stateVecImag [index] = - stateVecImag [index];
<a name="l02850"></a>02850             }
<a name="l02851"></a>02851         }
<a name="l02852"></a>02852     }
<a name="l02853"></a>02853 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa662796ea6e0f471143c53becae8c12c"></a><!-- doxytag: member="QuEST_internal.h::statevec_multiControlledPhaseShift" ref="aa662796ea6e0f471143c53becae8c12c" args="(Qureg qureg, int *controlQubits, int numControlQubits, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02593">2593</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00386">multiControlledPhaseShift()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02594"></a>02594 {
<a name="l02595"></a>02595     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02596"></a>02596     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02597"></a>02597 
<a name="l02598"></a>02598     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02599"></a>02599     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02600"></a>02600 
<a name="l02601"></a>02601     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l02602"></a>02602     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) 
<a name="l02603"></a>02603         mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l02604"></a>02604 
<a name="l02605"></a>02605     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02606"></a>02606     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02607"></a>02607     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02608"></a>02608     
<a name="l02609"></a>02609     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02610"></a>02610     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = cos(angle);
<a name="l02611"></a>02611     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = sin(angle);
<a name="l02612"></a>02612 
<a name="l02613"></a>02613 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02614"></a>02614 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l02615"></a>02615 <span class="preprocessor">    default  (none)              \</span>
<a name="l02616"></a>02616 <span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask) \</span>
<a name="l02617"></a>02617 <span class="preprocessor">    private  (index, stateRealLo, stateImagLo)</span>
<a name="l02618"></a>02618 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02619"></a>02619 <span class="preprocessor"></span>    {
<a name="l02620"></a>02620 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02621"></a>02621 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l02622"></a>02622 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02623"></a>02623 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02624"></a>02624             <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){
<a name="l02625"></a>02625                 
<a name="l02626"></a>02626                 stateRealLo = stateVecReal[index];
<a name="l02627"></a>02627                 stateImagLo = stateVecImag[index];
<a name="l02628"></a>02628             
<a name="l02629"></a>02629                 stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02630"></a>02630                 stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02631"></a>02631             }
<a name="l02632"></a>02632         }
<a name="l02633"></a>02633     }
<a name="l02634"></a>02634 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2cc288d53df484516cde923c8a3b561a"></a><!-- doxytag: member="QuEST_internal.h::statevec_multiControlledUnitary" ref="a2cc288d53df484516cde923c8a3b561a" args="(Qureg qureg, int *controlQubits, const int numControlQubits, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00948">948</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01984">statevec_multiControlledUnitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01715">statevec_multiControlledUnitaryLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00265">multiControlledUnitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00949"></a>00949 {
<a name="l00950"></a>00950     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask=0;
<a name="l00951"></a>00951     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;numControlQubits; i++) mask = mask | (1LL&lt;&lt;controlQubits[i]);
<a name="l00952"></a>00952 
<a name="l00953"></a>00953     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00954"></a>00954     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00955"></a>00955     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00956"></a>00956 
<a name="l00957"></a>00957     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00958"></a>00958     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00959"></a>00959     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00960"></a>00960 
<a name="l00961"></a>00961     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00962"></a>00962         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00963"></a>00963         <a class="code" href="QuEST__cpu_8c.html#ae183f44166ccfd908609c4e2207cc14b">statevec_multiControlledUnitaryLocal</a>(qureg, targetQubit, mask, u);
<a name="l00964"></a>00964     } <span class="keywordflow">else</span> {
<a name="l00965"></a>00965         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00966"></a>00966         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00967"></a>00967         <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00968"></a>00968         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00969"></a>00969         <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span>
<a name="l00970"></a>00970         <span class="comment">// get corresponding values from my pair</span>
<a name="l00971"></a>00971         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l00972"></a>00972 
<a name="l00973"></a>00973         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. send values to multiControlledUnitaryDistributed</span>
<a name="l00974"></a>00974         <span class="comment">// in the correct order</span>
<a name="l00975"></a>00975         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00976"></a>00976             <a class="code" href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c" title="Apply a unitary operation to a single qubit in the state vector of probability amplitudes...">statevec_multiControlledUnitaryDistributed</a>(qureg,targetQubit,mask,rot1,rot2,
<a name="l00977"></a>00977                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00978"></a>00978                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00979"></a>00979                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00980"></a>00980         } <span class="keywordflow">else</span> {
<a name="l00981"></a>00981             <a class="code" href="QuEST__cpu_8c.html#a2e6d75b454747741b2b805bf6b23194c" title="Apply a unitary operation to a single qubit in the state vector of probability amplitudes...">statevec_multiControlledUnitaryDistributed</a>(qureg,targetQubit,mask,rot1,rot2,
<a name="l00982"></a>00982                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00983"></a>00983                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00984"></a>00984                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00985"></a>00985         }
<a name="l00986"></a>00986     }
<a name="l00987"></a>00987 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abdb6e0ee1e407755e1b944086cedd90e"></a><!-- doxytag: member="QuEST_internal.h::statevec_pauliX" ref="abdb6e0ee1e407755e1b944086cedd90e" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00988">988</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02093">statevec_pauliXDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02034">statevec_pauliXLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00308">pauliX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00989"></a>00989 {
<a name="l00990"></a>00990     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00991"></a>00991     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00992"></a>00992 
<a name="l00993"></a>00993     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00994"></a>00994     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00995"></a>00995     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00996"></a>00996 
<a name="l00997"></a>00997     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00998"></a>00998         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00999"></a>00999         <a class="code" href="QuEST__cpu_8c.html#a842aaecd6d6cdc194c0b7c84623d2111">statevec_pauliXLocal</a>(qureg, targetQubit);
<a name="l01000"></a>01000     } <span class="keywordflow">else</span> {
<a name="l01001"></a>01001         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01002"></a>01002         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01003"></a>01003         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01004"></a>01004         <span class="comment">//printf(&quot;%d rank has pair rank: %d\n&quot;, qureg.rank, pairRank);</span>
<a name="l01005"></a>01005         <span class="comment">// get corresponding values from my pair</span>
<a name="l01006"></a>01006         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01007"></a>01007         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. pauliX just replaces</span>
<a name="l01008"></a>01008         <span class="comment">// this rank&apos;s values with pair values</span>
<a name="l01009"></a>01009         <a class="code" href="QuEST__cpu_8c.html#ac4f8a0ab089bc002fd85cd87f8c451e9" title="Rotate a single qubit by {{0,1},{1,0}.">statevec_pauliXDistributed</a>(qureg, targetQubit,
<a name="l01010"></a>01010                 qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">// in</span>
<a name="l01011"></a>01011                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">// out</span>
<a name="l01012"></a>01012     }
<a name="l01013"></a>01013 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a73b56fbac6e464a37805fa9d9657a8f9"></a><!-- doxytag: member="QuEST_internal.h::statevec_pauliY" ref="a73b56fbac6e464a37805fa9d9657a8f9" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01044">1044</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02277">statevec_pauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02219">statevec_pauliYLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00319">pauliY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01045"></a>01045 {       
<a name="l01046"></a>01046         <span class="keywordtype">int</span> conjFac = 1;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01049"></a>01049     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01050"></a>01050     <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01051"></a>01051     <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span>
<a name="l01052"></a>01052 
<a name="l01053"></a>01053     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01054"></a>01054         <a class="code" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a>(qureg, targetQubit, conjFac);
<a name="l01055"></a>01055     } <span class="keywordflow">else</span> {
<a name="l01056"></a>01056         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01057"></a>01057         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01058"></a>01058         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01059"></a>01059         <span class="comment">// get corresponding values from my pair</span>
<a name="l01060"></a>01060         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01061"></a>01061         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block</span>
<a name="l01062"></a>01062         <a class="code" href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26" title="Rotate a single qubit by +-{{0,-i},{i,0}.">statevec_pauliYDistributed</a>(qureg,targetQubit,
<a name="l01063"></a>01063                 qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">// in</span>
<a name="l01064"></a>01064                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">// out</span>
<a name="l01065"></a>01065                 rankIsUpper, conjFac);
<a name="l01066"></a>01066     }
<a name="l01067"></a>01067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aee97816cfabeea7874cd837a8d105412"></a><!-- doxytag: member="QuEST_internal.h::statevec_pauliYConj" ref="aee97816cfabeea7874cd837a8d105412" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01069">1069</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l02277">statevec_pauliYDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02219">statevec_pauliYLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00319">pauliY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01070"></a>01070 {       
<a name="l01071"></a>01071         <span class="keywordtype">int</span> conjFac = -1;
<a name="l01072"></a>01072 
<a name="l01073"></a>01073     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l01074"></a>01074     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01075"></a>01075     <span class="keywordtype">int</span> rankIsUpper;    <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l01076"></a>01076     <span class="keywordtype">int</span> pairRank;               <span class="comment">// rank of corresponding chunk</span>
<a name="l01077"></a>01077 
<a name="l01078"></a>01078     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l01079"></a>01079         <a class="code" href="QuEST__cpu_8c.html#a8edf5f2066b05fb343931f45e2bec8f8">statevec_pauliYLocal</a>(qureg, targetQubit, conjFac);
<a name="l01080"></a>01080     } <span class="keywordflow">else</span> {
<a name="l01081"></a>01081         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l01082"></a>01082         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01083"></a>01083         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l01084"></a>01084         <span class="comment">// get corresponding values from my pair</span>
<a name="l01085"></a>01085         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l01086"></a>01086         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block</span>
<a name="l01087"></a>01087         <a class="code" href="QuEST__cpu_8c.html#a04cdf71c5862ab2bf3a98cd0b3ea0c26" title="Rotate a single qubit by +-{{0,-i},{i,0}.">statevec_pauliYDistributed</a>(qureg,targetQubit,
<a name="l01088"></a>01088                 qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">// in</span>
<a name="l01089"></a>01089                 qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">// out</span>
<a name="l01090"></a>01090                 rankIsUpper, conjFac);
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad711cac41adb0fea1ad4797ce14953e0"></a><!-- doxytag: member="QuEST_internal.h::statevec_pauliZ" ref="ad711cac41adb0fea1ad4797ce14953e0" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00209">209</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00330">pauliZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00209"></a>00209                                                          {
<a name="l00210"></a>00210     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00211"></a>00211     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = -1;
<a name="l00212"></a>00212     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> =  0;
<a name="l00213"></a>00213     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00214"></a>00214 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37bcd16fc0bbc8e665585ba9b99f382b"></a><!-- doxytag: member="QuEST_internal.h::statevec_phaseShift" ref="a37bcd16fc0bbc8e665585ba9b99f382b" args="(Qureg qureg, const int targetQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00202">202</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00363">phaseShift()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00202"></a>00202                                                                           {
<a name="l00203"></a>00203     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00204"></a>00204     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = cos(angle); 
<a name="l00205"></a>00205     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = sin(angle);
<a name="l00206"></a>00206     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00207"></a>00207 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8972669148af60d7e1c09687f69673d4"></a><!-- doxytag: member="QuEST_internal.h::statevec_phaseShiftByTerm" ref="a8972669148af60d7e1c09687f69673d4" args="(Qureg qureg, const int targetQubit, Complex term)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShiftByTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&nbsp;</td>
          <td class="paramname"> <em>term</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02514">2514</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00031">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST__common_8c_source.html#l00209">statevec_pauliZ()</a>, <a class="el" href="QuEST__common_8c_source.html#l00202">statevec_phaseShift()</a>, <a class="el" href="QuEST__common_8c_source.html#l00216">statevec_sGate()</a>, <a class="el" href="QuEST__common_8c_source.html#l00230">statevec_sGateConj()</a>, <a class="el" href="QuEST__common_8c_source.html#l00223">statevec_tGate()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00237">statevec_tGateConj()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02515"></a>02515 {       
<a name="l02516"></a>02516     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l02517"></a>02517     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;
<a name="l02518"></a>02518     <span class="keywordtype">int</span> targetBit;
<a name="l02519"></a>02519     
<a name="l02520"></a>02520     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02521"></a>02521     <span class="keyword">const</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>;
<a name="l02522"></a>02522 
<a name="l02523"></a>02523     <span class="comment">// dimension of the state vector</span>
<a name="l02524"></a>02524     stateVecSize = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l02525"></a>02525     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecReal = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l02526"></a>02526     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> *stateVecImag = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l02527"></a>02527     
<a name="l02528"></a>02528     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> stateRealLo, stateImagLo;
<a name="l02529"></a>02529     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> cosAngle = term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;
<a name="l02530"></a>02530     <span class="keyword">const</span> <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a> sinAngle = term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;
<a name="l02531"></a>02531 
<a name="l02532"></a>02532 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l02533"></a>02533 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel for \</span>
<a name="l02534"></a>02534 <span class="preprocessor">    default  (none)              \</span>
<a name="l02535"></a>02535 <span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag ) \</span>
<a name="l02536"></a>02536 <span class="preprocessor">    private  (index,targetBit,stateRealLo,stateImagLo)             \</span>
<a name="l02537"></a>02537 <span class="preprocessor">    schedule (static)</span>
<a name="l02538"></a>02538 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l02539"></a>02539 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {
<a name="l02540"></a>02540         
<a name="l02541"></a>02541         <span class="comment">// update the coeff of the |1&gt; state of the target qubit</span>
<a name="l02542"></a>02542         targetBit = <a class="code" href="QuEST__cpu_8c.html#a100463f6ec212c76a5fad99579000505" title="Get the value of the bit at a particular index in a number.">extractBit</a> (targetQubit, index+chunkId*chunkSize);
<a name="l02543"></a>02543         <span class="keywordflow">if</span> (targetBit) {
<a name="l02544"></a>02544             
<a name="l02545"></a>02545             stateRealLo = stateVecReal[index];
<a name="l02546"></a>02546             stateImagLo = stateVecImag[index];
<a name="l02547"></a>02547             
<a name="l02548"></a>02548             stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;
<a name="l02549"></a>02549             stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  
<a name="l02550"></a>02550         }
<a name="l02551"></a>02551     }
<a name="l02552"></a>02552 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1e57230c7995447039e62a84c0a36524"></a><!-- doxytag: member="QuEST_internal.h::statevec_reportStateToScreen" ref="a1e57230c7995447039e62a84c0a36524" args="(Qureg qureg, QuESTEnv env, int reportRank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&nbsp;</td>
          <td class="paramname"> <em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>reportRank</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the current state vector of probability amplitudes for a set of qubits to standard out. </p>
<p>For debugging purposes. Each rank should print output serially. Only print output for systems &lt;= 5 qubits </p>

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01100">1100</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__gpu_8cu_source.html#l00291">copyStateFromGPU()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00097">Qureg::numChunks</a>, <a class="el" href="QuEST_8h_source.html#l00088">Qureg::numQubitsInStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00166">syncQuESTEnv()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00705">reportStateToScreen()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01100"></a>01100                                                                             {
<a name="l01101"></a>01101     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01102"></a>01102     <span class="keywordtype">int</span> rank;
<a name="l01103"></a>01103     <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218" title="Number of qubits in the state-vector - this is double the number represented for...">numQubitsInStateVec</a>&lt;=5){
<a name="l01104"></a>01104         <span class="keywordflow">for</span> (rank=0; rank&lt;qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>; rank++){
<a name="l01105"></a>01105             <span class="keywordflow">if</span> (qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>==rank){
<a name="l01106"></a>01106                 <span class="keywordflow">if</span> (reportRank) {
<a name="l01107"></a>01107                     printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>);
<a name="l01108"></a>01108                     printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l01109"></a>01109                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {
<a name="l01110"></a>01110                     printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);
<a name="l01111"></a>01111                     printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);
<a name="l01112"></a>01112                 }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114                 <span class="keywordflow">for</span>(index=0; index&lt;qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>; index++){
<a name="l01115"></a>01115                     <span class="comment">//printf(REAL_STRING_FORMAT &quot;, &quot; REAL_STRING_FORMAT &quot;\n&quot;, qureg.pairStateVec.real[index], qureg.pairStateVec.imag[index]);</span>
<a name="l01116"></a>01116                     printf(REAL_STRING_FORMAT <span class="stringliteral">&quot;, &quot;</span> REAL_STRING_FORMAT <span class="stringliteral">&quot;\n&quot;</span>, qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real[index], qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag[index]);
<a name="l01117"></a>01117                 }
<a name="l01118"></a>01118                 <span class="keywordflow">if</span> (reportRank || rank==qureg.<a class="code" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413" title="Number of chunks the state vector is broken up into -- the number of MPI processes...">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);
<a name="l01119"></a>01119             }
<a name="l01120"></a>01120             <a class="code" href="QuEST_8h.html#a8d31fe2d1ad4d01e2a1f5f6b8bc15b77" title="Guarantees that all code up to the given point has been executed on all nodes (if...">syncQuESTEnv</a>(env);
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122     } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);
<a name="l01123"></a>01123 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a65b9087ca37c096caa5c6e8586b67946"></a><!-- doxytag: member="QuEST_internal.h::statevec_rotateAroundAxis" ref="a65b9087ca37c096caa5c6e8586b67946" args="(Qureg qureg, const int rotQubit, qreal angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateAroundAxis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00262">262</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00450">rotateAroundAxis()</a>, <a class="el" href="QuEST__common_8c_source.html#l00244">statevec_rotateX()</a>, <a class="el" href="QuEST__common_8c_source.html#l00250">statevec_rotateY()</a>, and <a class="el" href="QuEST__common_8c_source.html#l00256">statevec_rotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00262"></a>00262                                                                                          {
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00265"></a>00265     <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);
<a name="l00266"></a>00266     <a class="code" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a>(qureg, rotQubit, alpha, beta);
<a name="l00267"></a>00267 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af9839c40de8df0cecc72a0258a20d979"></a><!-- doxytag: member="QuEST_internal.h::statevec_rotateAroundAxisConj" ref="af9839c40de8df0cecc72a0258a20d979" args="(Qureg qureg, const int rotQubit, qreal angle, Vector axis)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateAroundAxisConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structVector.html">Vector</a>&nbsp;</td>
          <td class="paramname"> <em>axis</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00269">269</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00064">getComplexPairFromRotation()</a>, <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00795">statevec_compactUnitary()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00450">rotateAroundAxis()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00269"></a>00269                                                                                              {
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> alpha, beta;
<a name="l00272"></a>00272     <a class="code" href="QuEST__common_8c.html#a71b3ae4402c1c5039d3086ca0e47a522">getComplexPairFromRotation</a>(angle, axis, &amp;alpha, &amp;beta);
<a name="l00273"></a>00273     alpha.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1; 
<a name="l00274"></a>00274     beta.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> *= -1;
<a name="l00275"></a>00275     <a class="code" href="QuEST__internal_8h.html#a94ee4df9faba286ad7a5bc829ef5174d">statevec_compactUnitary</a>(qureg, rotQubit, alpha, beta);
<a name="l00276"></a>00276 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca123cc22e13a2cb819ef6c2f455b9e4"></a><!-- doxytag: member="QuEST_internal.h::statevec_rotateX" ref="aca123cc22e13a2cb819ef6c2f455b9e4" args="(Qureg qureg, const int rotQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateX </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00244">244</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00171">rotateX()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00244"></a>00244                                                                    {
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {1, 0, 0};
<a name="l00247"></a>00247     <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);
<a name="l00248"></a>00248 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a62c8c00dc4adf74b982ad8a9049170"></a><!-- doxytag: member="QuEST_internal.h::statevec_rotateY" ref="a4a62c8c00dc4adf74b982ad8a9049170" args="(Qureg qureg, const int rotQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00250">250</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00182">rotateY()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00250"></a>00250                                                                    {
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 1, 0};
<a name="l00253"></a>00253     <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);
<a name="l00254"></a>00254 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab96ee09e32e297629a481c3ba6d7eaf7"></a><!-- doxytag: member="QuEST_internal.h::statevec_rotateZ" ref="ab96ee09e32e297629a481c3ba6d7eaf7" args="(Qureg qureg, const int rotQubit, qreal angle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_rotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>rotQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal&nbsp;</td>
          <td class="paramname"> <em>angle</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00256">256</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST__common_8c_source.html#l00262">statevec_rotateAroundAxis()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00193">rotateZ()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00256"></a>00256                                                                    {
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <a class="code" href="structVector.html" title="Represents a 3-vector of real numbers.">Vector</a> unitAxis = {0, 0, 1};
<a name="l00259"></a>00259     <a class="code" href="QuEST__common_8c.html#a65b9087ca37c096caa5c6e8586b67946">statevec_rotateAroundAxis</a>(qureg, rotQubit, angle, unitAxis);
<a name="l00260"></a>00260 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa121d55f2ca09c06a96ddcd433c60b0f"></a><!-- doxytag: member="QuEST_internal.h::statevec_setAmps" ref="aa121d55f2ca09c06a96ddcd433c60b0f" args="(Qureg qureg, long long int startInd, qreal *reals, qreal *imags, long long int numAmps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">qreal *&nbsp;</td>
          <td class="paramname"> <em>imags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&nbsp;</td>
          <td class="paramname"> <em>numAmps</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01016">1016</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00105">Qureg::deviceStateVec</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00131">initStateFromAmps()</a>, and <a class="el" href="QuEST_8c_source.html#l00139">setAmps()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01016"></a>01016                                                                                                               {
<a name="l01017"></a>01017     
<a name="l01018"></a>01018     <span class="comment">/* this is actually distributed, since the user&apos;s code runs on every node */</span>
<a name="l01019"></a>01019     
<a name="l01020"></a>01020     <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span>
<a name="l01021"></a>01021     <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span>
<a name="l01022"></a>01022     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01023"></a>01023     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numAmps; <span class="comment">// exclusive</span>
<a name="l01024"></a>01024     
<a name="l01025"></a>01025     <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span>
<a name="l01026"></a>01026     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>*qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a> - startInd;
<a name="l01027"></a>01027     
<a name="l01028"></a>01028     <span class="comment">// restrict these indices to fit into this chunk</span>
<a name="l01029"></a>01029     <span class="keywordflow">if</span> (localStartInd &lt; 0)
<a name="l01030"></a>01030         localStartInd = 0;
<a name="l01031"></a>01031     <span class="keywordflow">if</span> (localEndInd &gt; qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>)
<a name="l01032"></a>01032         localEndInd = qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>;
<a name="l01033"></a>01033     <span class="comment">// they may now be out of order = no iterations</span>
<a name="l01034"></a>01034     
<a name="l01035"></a>01035     <span class="comment">// unpacking OpenMP vars</span>
<a name="l01036"></a>01036     <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;
<a name="l01037"></a>01037     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecRe = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.real;
<a name="l01038"></a>01038     <a class="code" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6" title="A precision-agnostic floating point number, as determined by QuEST_PREC.">qreal</a>* vecIm = qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>.imag;
<a name="l01039"></a>01039     
<a name="l01040"></a>01040 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01041"></a>01041 <span class="preprocessor"></span><span class="preprocessor"># pragma omp parallel \</span>
<a name="l01042"></a>01042 <span class="preprocessor">    default  (none) \</span>
<a name="l01043"></a>01043 <span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, reals,imags, offset) \</span>
<a name="l01044"></a>01044 <span class="preprocessor">    private  (index) </span>
<a name="l01045"></a>01045 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01046"></a>01046 <span class="preprocessor"></span>    {
<a name="l01047"></a>01047 <span class="preprocessor"># ifdef _OPENMP</span>
<a name="l01048"></a>01048 <span class="preprocessor"></span><span class="preprocessor"># pragma omp for schedule (static)</span>
<a name="l01049"></a>01049 <span class="preprocessor"></span><span class="preprocessor"># endif</span>
<a name="l01050"></a>01050 <span class="preprocessor"></span>        <span class="comment">// iterate these local inds - this might involve no iterations</span>
<a name="l01051"></a>01051         <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {
<a name="l01052"></a>01052             vecRe[index] = reals[index + offset];
<a name="l01053"></a>01053             vecIm[index] = imags[index + offset];
<a name="l01054"></a>01054         }
<a name="l01055"></a>01055     }
<a name="l01056"></a>01056 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aea5b9ea10791217a793a8040c36e4efc"></a><!-- doxytag: member="QuEST_internal.h::statevec_sGate" ref="aea5b9ea10791217a793a8040c36e4efc" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_sGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00216">216</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00341">sGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00216"></a>00216                                                         {
<a name="l00217"></a>00217     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00218"></a>00218     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = 0;
<a name="l00219"></a>00219     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = 1;
<a name="l00220"></a>00220     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00221"></a>00221 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a78bfeb90f0c1812e726ec3092056bb52"></a><!-- doxytag: member="QuEST_internal.h::statevec_sGateConj" ref="a78bfeb90f0c1812e726ec3092056bb52" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_sGateConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00230">230</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00341">sGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00230"></a>00230                                                             {
<a name="l00231"></a>00231     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00232"></a>00232     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =  0;
<a name="l00233"></a>00233     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = -1;
<a name="l00234"></a>00234     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00235"></a>00235 } 
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0bd738cb7e7cdea8f1ce1e640d427d4c"></a><!-- doxytag: member="QuEST_internal.h::statevec_tGate" ref="a0bd738cb7e7cdea8f1ce1e640d427d4c" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_tGate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00223">223</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00352">tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00223"></a>00223                                                         {
<a name="l00224"></a>00224     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00225"></a>00225     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = 1/sqrt(2);
<a name="l00226"></a>00226     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = 1/sqrt(2);
<a name="l00227"></a>00227     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00228"></a>00228 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3ce1b05fee70d930791513fec378d229"></a><!-- doxytag: member="QuEST_internal.h::statevec_tGateConj" ref="a3ce1b05fee70d930791513fec378d229" args="(Qureg qureg, const int targetQubit)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_tGateConj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__common_8c_source.html#l00237">237</a> of file <a class="el" href="QuEST__common_8c_source.html">QuEST_common.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00060">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00059">Complex::real</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l02514">statevec_phaseShiftByTerm()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00352">tGate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00237"></a>00237                                                             {
<a name="l00238"></a>00238     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> term; 
<a name="l00239"></a>00239     term.<a class="code" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> =  1/sqrt(2);
<a name="l00240"></a>00240     term.<a class="code" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = -1/sqrt(2);
<a name="l00241"></a>00241     <a class="code" href="QuEST__internal_8h.html#a8972669148af60d7e1c09687f69673d4">statevec_phaseShiftByTerm</a>(qureg, targetQubit, term);
<a name="l00242"></a>00242 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4bea7ed7967083cbabd8a8e5acdd48c0"></a><!-- doxytag: member="QuEST_internal.h::statevec_unitary" ref="a4bea7ed7967083cbabd8a8e5acdd48c0" args="(Qureg qureg, const int targetQubit, ComplexMatrix2 u)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&nbsp;</td>
          <td class="paramname"> <em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&nbsp;</td>
          <td class="paramname"> <em>u</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00832">832</a> of file <a class="el" href="QuEST__cpu__distributed_8c_source.html">QuEST_cpu_distributed.c</a>.</p>

<p>References <a class="el" href="QuEST_8h_source.html#l00095">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00237">chunkIsUpper()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">exchangeStateVectors()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00313">getChunkPairId()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00293">getRotAngleFromUnitaryMatrix()</a>, <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00366">halfMatrixBlockFitsInChunk()</a>, <a class="el" href="QuEST_8h_source.html#l00091">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00102">Qureg::pairStateVec</a>, <a class="el" href="QuEST__precision_8h.html#a7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00100">Qureg::stateVec</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01603">statevec_unitaryDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l01477">statevec_unitaryLocal()</a>.</p>

<p>Referenced by <a class="el" href="QuEST_8c_source.html#l00240">unitary()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00833"></a>00833 {
<a name="l00834"></a>00834     <span class="comment">// flag to require memory exchange. 1: an entire block fits on one rank, 0: at most half a block fits on one rank</span>
<a name="l00835"></a>00835     <span class="keywordtype">int</span> useLocalDataOnly = <a class="code" href="QuEST__cpu__distributed_8c.html#a4d043bb0cee54a5f94faf3ffc34a6790" title="return whether the current qubit rotation will use blocks that fit within a single...">halfMatrixBlockFitsInChunk</a>(qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00836"></a>00836     <a class="code" href="structComplex.html" title="Represents one complex number.">Complex</a> rot1, rot2;
<a name="l00837"></a>00837 
<a name="l00838"></a>00838     <span class="comment">// rank&apos;s chunk is in upper half of block </span>
<a name="l00839"></a>00839     <span class="keywordtype">int</span> rankIsUpper;
<a name="l00840"></a>00840     <span class="keywordtype">int</span> pairRank; <span class="comment">// rank of corresponding chunk</span>
<a name="l00841"></a>00841 
<a name="l00842"></a>00842     <span class="keywordflow">if</span> (useLocalDataOnly){
<a name="l00843"></a>00843         <span class="comment">// all values required to update state vector lie in this rank</span>
<a name="l00844"></a>00844         <a class="code" href="QuEST__cpu_8c.html#a9f62ff38deae8ef012024d416d749c00">statevec_unitaryLocal</a>(qureg, targetQubit, u);
<a name="l00845"></a>00845     } <span class="keywordflow">else</span> {
<a name="l00846"></a>00846         <span class="comment">// need to get corresponding chunk of state vector from other rank</span>
<a name="l00847"></a>00847         rankIsUpper = <a class="code" href="QuEST__cpu__distributed_8c.html#a0552889d6f57d9e0ed8b209bf426482d" title="Returns whether a given chunk in position chunkId is in the upper or lower half of...">chunkIsUpper</a>(qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00848"></a>00848         <a class="code" href="QuEST__cpu__distributed_8c.html#a5c9b2f129bdffaaba9857f6eddecbb17" title="Get rotation values for a given chunk given a unitary matrix.">getRotAngleFromUnitaryMatrix</a>(rankIsUpper, &amp;rot1, &amp;rot2, u);
<a name="l00849"></a>00849         pairRank = <a class="code" href="QuEST__cpu__distributed_8c.html#a7dba097f23f5d48dfdc9f3250444e2e4" title="get position of corresponding chunk, holding values required to update values in...">getChunkPairId</a>(rankIsUpper, qureg.<a class="code" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0" title="The position of the chunk of the state vector held by this process in the full state...">chunkId</a>, qureg.<a class="code" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97" title="Number of probability amplitudes held in stateVec by this process In the non-MPI...">numAmpsPerChunk</a>, targetQubit);
<a name="l00850"></a>00850         <span class="comment">// get corresponding values from my pair</span>
<a name="l00851"></a>00851         <a class="code" href="QuEST__cpu__distributed_8c.html#ae01c3eb75fd32de1a7e1dbc7a33a21e3">exchangeStateVectors</a>(qureg, pairRank);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <span class="comment">// this rank&apos;s values are either in the upper of lower half of the block. </span>
<a name="l00854"></a>00854         <span class="comment">// send values to compactUnitaryDistributed in the correct order</span>
<a name="l00855"></a>00855         <span class="keywordflow">if</span> (rankIsUpper){
<a name="l00856"></a>00856             <a class="code" href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea" title="Apply a unitary operation to a single qubit given a subset of the state vector with...">statevec_unitaryDistributed</a>(qureg,targetQubit,rot1,rot2,
<a name="l00857"></a>00857                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//upper</span>
<a name="l00858"></a>00858                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//lower</span>
<a name="l00859"></a>00859                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00860"></a>00860         } <span class="keywordflow">else</span> {
<a name="l00861"></a>00861             <a class="code" href="QuEST__cpu_8c.html#a62c5d85e323f2c3eea2b7fa6d8c193ea" title="Apply a unitary operation to a single qubit given a subset of the state vector with...">statevec_unitaryDistributed</a>(qureg,targetQubit,rot1,rot2,
<a name="l00862"></a>00862                     qureg.<a class="code" href="structQureg.html#aba97773694870ef35e378c036f486bb7" title="Temporary storage for a chunk of the state vector received from another process in...">pairStateVec</a>, <span class="comment">//upper</span>
<a name="l00863"></a>00863                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>, <span class="comment">//lower</span>
<a name="l00864"></a>00864                     qureg.<a class="code" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe" title="Computational state amplitudes - a subset thereof in the MPI version.">stateVec</a>); <span class="comment">//output</span>
<a name="l00865"></a>00865         }
<a name="l00866"></a>00866     }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868 
<a name="l00869"></a>00869 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 11 Jan 2019 for Quantum Exact Simulation Toolkit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
